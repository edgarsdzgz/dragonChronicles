name: 'Setup Node + pnpm'
description: 'Setup Node.js and pnpm consistently across all jobs'
runs:
  using: composite
  steps:
    - name: Setup Node
      uses: actions/setup-node@v4
      with:
        node-version: 20.x
        cache: pnpm

    - name: Setup pnpm
      uses: pnpm/action-setup@v4
      with:
        version: 9.15.9

    - name: Print tool versions
      shell: bash
      run: |
        node -v
        pnpm -v

    - name: Configure pnpm fetch retries
      shell: bash
      run: |
        pnpm config set fetch-retries 5
        pnpm config set fetch-retry-factor 2
        pnpm config set fetch-retry-maxtimeout 60000