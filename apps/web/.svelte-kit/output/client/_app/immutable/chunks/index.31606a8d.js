var Ji=Object.defineProperty;var Xi=(e,t,i)=>t in e?Ji(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var gt=(e,t,i)=>(Xi(e,typeof t!="symbol"?t+"":t,i),i);import{c as wo,g as Qi}from"./_commonjsHelpers.725317a4.js";function xt(e){if(e==null)return 4;switch(typeof e){case"string":return 2+e.length;case"number":return 8;case"boolean":return 4;case"object":return Array.isArray(e)?2+e.reduce((a,l)=>a+xt(l),0):2+Object.keys(e).reduce((a,l)=>{const m=e[l];return a+l.length+3+xt(m)},0);default:return 8}}function Hi(e){return e.map(t=>JSON.stringify(t)).join(`
`)+`
`}function eu(){return{log(e){const t=`[${e.src}${e.mode?`/${e.mode}`:""}]`;(console[e.lvl]??console.log)(t,e.msg,e.data??"")}}}const nu=new Set(["fps","draws","enemies","proj","arcana","gold","dragonName","profileId","land","ward"]);function tu(e){const t={t:e.t,lvl:e.lvl,src:e.src,msg:e.msg};if(e.mode!==void 0&&(t.mode=e.mode),e.profileId!==void 0&&(t.profileId=e.profileId),e.data&&typeof e.data=="object"){const i={};for(const[a,l]of Object.entries(e.data))nu.has(a)&&(typeof l=="string"&&a!=="dragonName"||(i[a]=l));t.data=i}return t}class ru{constructor(t){this.buffer=[],this.head=0,this.tail=0,this.size=0,this.capacity=t,this.buffer=new Array(t)}push(t){this.size===this.capacity?(this.buffer[this.head]=t,this.head=(this.head+1)%this.capacity,this.tail=(this.tail+1)%this.capacity):(this.buffer[this.tail]=t,this.tail=(this.tail+1)%this.capacity,this.size++)}shift(){if(this.size===0)return;const t=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.size--,t}get length(){return this.size}get isEmpty(){return this.size===0}get isFull(){return this.size===this.capacity}toArray(){if(this.size===0)return[];const t=[];let i=this.head;for(let a=0;a<this.size;a++){const l=this.buffer[i];l!==void 0&&t.push(l),i=(i+1)%this.capacity}return t}clear(){this.head=0,this.tail=0,this.size=0}toArrayLimited(t){if(this.size===0||t<=0)return[];const i=[];let a=this.head;const l=Math.min(t,this.size);for(let m=0;m<l;m++){const p=this.buffer[a];p!==void 0&&i.push(p),a=(a+1)%this.capacity}return i}forEach(t){if(this.size===0)return;let i=this.head;for(let a=0;a<this.size;a++){const l=this.buffer[i];l!==void 0&&t(l,a),i=(i+1)%this.capacity}}map(t){if(this.size===0)return[];const i=[];let a=this.head;for(let l=0;l<this.size;l++){const m=this.buffer[a];m!==void 0&&i.push(t(m,l)),a=(a+1)%this.capacity}return i}}function Il(e={}){const t=e.maxBytes??2097152,i=e.maxEntries??1e4,a=new ru(i);let l=0;const m=eu(),p=e.dexie??null;function O(){for(;l>t&&a.length>0;){const Y=a.shift();Y&&(l-=xt(Y))}}function Z(Y){const ee=tu(Y),Oe=xt(ee);a.push(ee),l+=Oe,O(),D&&m.log(ee),p?.enqueue(ee)}let D=!!e.devConsole;async function W(){const Y=a.toArray(),ee=Hi(Y);return new Blob([ee],{type:"application/x-ndjson"})}async function L(){a.clear(),l=0,await p?.clear()}function Q(Y){D=Y}return{log:Z,exportNDJSON:W,clear:L,enableConsole:Q}}var Mo={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(wo,function(){var i=function(n,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var s in u)Object.prototype.hasOwnProperty.call(u,s)&&(o[s]=u[s])})(n,r)},a=function(){return(a=Object.assign||function(n){for(var r,o=1,u=arguments.length;o<u;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s]);return n}).apply(this,arguments)};function l(n,r,o){if(o||arguments.length===2)for(var u,s=0,c=r.length;s<c;s++)!u&&s in r||((u=u||Array.prototype.slice.call(r,0,s))[s]=r[s]);return n.concat(u||Array.prototype.slice.call(r))}var m=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:wo,p=Object.keys,O=Array.isArray;function Z(n,r){return typeof r!="object"||p(r).forEach(function(o){n[o]=r[o]}),n}typeof Promise>"u"||m.Promise||(m.Promise=Promise);var D=Object.getPrototypeOf,W={}.hasOwnProperty;function L(n,r){return W.call(n,r)}function Q(n,r){typeof r=="function"&&(r=r(D(n))),(typeof Reflect>"u"?p:Reflect.ownKeys)(r).forEach(function(o){ee(n,o,r[o])})}var Y=Object.defineProperty;function ee(n,r,o,u){Y(n,r,Z(o&&L(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function Oe(n){return{from:function(r){return n.prototype=Object.create(r.prototype),ee(n.prototype,"constructor",n),{extend:Q.bind(null,n.prototype)}}}}var Mn=Object.getOwnPropertyDescriptor,Zt=[].slice;function an(n,r,o){return Zt.call(n,r,o)}function xe(n,r){return r(n)}function pe(n){if(!n)throw new Error("Assertion Failed")}function Ce(n){m.setImmediate?setImmediate(n):setTimeout(n,0)}function Ze(n,r){if(typeof r=="string"&&L(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var o=[],u=0,s=r.length;u<s;++u){var c=Ze(n,r[u]);o.push(c)}return o}var f=r.indexOf(".");if(f!==-1){var h=n[r.substr(0,f)];return h==null?void 0:Ze(h,r.substr(f+1))}}function we(n,r,o){if(n&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){pe(typeof o!="string"&&"length"in o);for(var u=0,s=r.length;u<s;++u)we(n,r[u],o[u])}else{var c,f,h=r.indexOf(".");h!==-1?(c=r.substr(0,h),(f=r.substr(h+1))===""?o===void 0?O(n)&&!isNaN(parseInt(c))?n.splice(c,1):delete n[c]:n[c]=o:we(h=!(h=n[c])||!L(n,c)?n[c]={}:h,f,o)):o===void 0?O(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=o}}function Cr(n){var r,o={};for(r in n)L(n,r)&&(o[r]=n[r]);return o}var mi=[].concat;function Dr(n){return mi.apply([],n)}var Je="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Dr([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return m[n]}),Rr=new Set(Je.map(function(n){return m[n]})),En=null;function We(n){return En=new WeakMap,n=function r(o){if(!o||typeof o!="object")return o;var u=En.get(o);if(u)return u;if(O(o)){u=[],En.set(o,u);for(var s=0,c=o.length;s<c;++s)u.push(r(o[s]))}else if(Rr.has(o.constructor))u=o;else{var f,h=D(o);for(f in u=h===Object.prototype?{}:Object.create(h),En.set(o,u),o)L(o,f)&&(u[f]=r(o[f]))}return u}(n),En=null,n}var vi={}.toString;function $t(n){return vi.call(n).slice(8,-1)}var Tt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",yi=typeof Tt=="symbol"?function(n){var r;return n!=null&&(r=n[Tt])&&r.apply(n)}:function(){return null};function Ye(n,r){return r=n.indexOf(r),0<=r&&n.splice(r,1),0<=r}var sn={};function $e(n){var r,o,u,s;if(arguments.length===1){if(O(n))return n.slice();if(this===sn&&typeof n=="string")return[n];if(s=yi(n)){for(o=[];!(u=s.next()).done;)o.push(u.value);return o}if(n==null)return[n];if(typeof(r=n.length)!="number")return[n];for(o=new Array(r);r--;)o[r]=n[r];return o}for(r=arguments.length,o=new Array(r);r--;)o[r]=arguments[r];return o}var jt=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Sn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ze=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Sn),gi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function cn(n,r){this.name=n,this.message=r}function Kr(n,r){return n+". Errors: "+Object.keys(r).map(function(o){return r[o].toString()}).filter(function(o,u,s){return s.indexOf(o)===u}).join(`
`)}function Un(n,r,o,u){this.failures=r,this.failedKeys=u,this.successCount=o,this.message=Kr(n,r)}function ln(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(o){return r[o]}),this.failuresByPos=r,this.message=Kr(n,this.failures)}Oe(cn).from(Error).extend({toString:function(){return this.name+": "+this.message}}),Oe(Un).from(cn),Oe(ln).from(cn);var Ct=ze.reduce(function(n,r){return n[r]=r+"Error",n},{}),bi=cn,q=ze.reduce(function(n,r){var o=r+"Error";function u(s,c){this.name=o,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=gi[r]||o,this.inner=null)}return Oe(u).from(bi),n[r]=u,n},{});q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError;var Nr=Sn.reduce(function(n,r){return n[r+"Error"]=q[r],n},{}),Ln=ze.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=q[r]),n},{});function H(){}function On(n){return n}function _i(n,r){return n==null||n===On?r:function(o){return r(n(o))}}function Ge(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function wi(n,r){return n===H?r:function(){var o=n.apply(this,arguments);o!==void 0&&(arguments[0]=o);var u=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var c=r.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?Ge(u,this.onsuccess):u),s&&(this.onerror=this.onerror?Ge(s,this.onerror):s),c!==void 0?c:o}}function ki(n,r){return n===H?r:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Ge(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Ge(u,this.onerror):u)}}function xi(n,r){return n===H?r:function(o){var u=n.apply(this,arguments);Z(o,u);var s=this.onsuccess,c=this.onerror;return this.onsuccess=null,this.onerror=null,o=r.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?Ge(s,this.onsuccess):s),c&&(this.onerror=this.onerror?Ge(c,this.onerror):c),u===void 0?o===void 0?void 0:o:Z(u,o)}}function zi(n,r){return n===H?r:function(){return r.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function Dt(n,r){return n===H?r:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return o.then(function(){return r.apply(u,c)})}return r.apply(this,arguments)}}Ln.ModifyError=Un,Ln.DexieError=cn,Ln.BulkError=ln;var Pe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Fr(n){Pe=n}var Pn={},Br=100,Je=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,D(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,D(r),n]}(),Sn=Je[0],ze=Je[1],Je=Je[2],ze=ze&&ze.then,Xe=Sn&&Sn.constructor,Rt=!!Je,In=function(n,r){An.push([n,r]),Vn&&(queueMicrotask(Oi),Vn=!1)},Kt=!0,Vn=!0,Qe=[],Wn=[],Nt=On,De={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:H,pgp:!1,env:{},finalize:H},F=De,An=[],He=0,Yn=[];function K(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=F;if(typeof n!="function"){if(n!==Pn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Bt(this,this._value))}this._state=null,this._value=null,++r.ref,function o(u,s){try{s(function(c){if(u._state===null){if(c===u)throw new TypeError("A promise cannot be resolved with itself.");var f=u._lib&&fn();c&&typeof c.then=="function"?o(u,function(h,v){c instanceof K?c._then(h,v):c.then(h,v)}):(u._state=!0,u._value=c,Mr(u)),f&&hn()}},Bt.bind(null,u))}catch(c){Bt(u,c)}}(this,n)}var Ft={get:function(){var n=F,r=Qn;function o(u,s){var c=this,f=!n.global&&(n!==F||r!==Qn),h=f&&!Ke(),v=new K(function(g,_){qt(c,new qr(Lr(u,n,f,h),Lr(s,n,f,h),g,_,n))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return o.prototype=Pn,o},set:function(n){ee(this,"then",n&&n.prototype===Pn?Ft:{get:function(){return n},set:Ft.set})}};function qr(n,r,o,u,s){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=o,this.reject=u,this.psd=s}function Bt(n,r){var o,u;Wn.push(r),n._state===null&&(o=n._lib&&fn(),r=Nt(r),n._state=!1,n._value=r,u=n,Qe.some(function(s){return s._value===u._value})||Qe.push(u),Mr(n),o&&hn())}function Mr(n){var r=n._listeners;n._listeners=[];for(var o=0,u=r.length;o<u;++o)qt(n,r[o]);var s=n._PSD;--s.ref||s.finalize(),He===0&&(++He,In(function(){--He==0&&Mt()},[]))}function qt(n,r){if(n._state!==null){var o=n._state?r.onFulfilled:r.onRejected;if(o===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++He,In(Ei,[o,n,r])}else n._listeners.push(r)}function Ei(n,r,o){try{var u,s=r._value;!r._state&&Wn.length&&(Wn=[]),u=Pe&&r._consoleTask?r._consoleTask.run(function(){return n(s)}):n(s),r._state||Wn.indexOf(s)!==-1||function(c){for(var f=Qe.length;f;)if(Qe[--f]._value===c._value)return Qe.splice(f,1)}(r),o.resolve(u)}catch(c){o.reject(c)}finally{--He==0&&Mt(),--o.psd.ref||o.psd.finalize()}}function Oi(){en(De,function(){fn()&&hn()})}function fn(){var n=Kt;return Vn=Kt=!1,n}function hn(){var n,r,o;do for(;0<An.length;)for(n=An,An=[],o=n.length,r=0;r<o;++r){var u=n[r];u[0].apply(null,u[1])}while(0<An.length);Vn=Kt=!0}function Mt(){var n=Qe;Qe=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var r=Yn.slice(0),o=r.length;o;)r[--o]()}function Gn(n){return new K(Pn,!1,n)}function re(n,r){var o=F;return function(){var u=fn(),s=F;try{return Ne(o,!0),n.apply(this,arguments)}catch(c){r&&r(c)}finally{Ne(s,!1),u&&hn()}}}Q(K.prototype,{then:Ft,_then:function(n,r){qt(this,new qr(null,null,n,r,F))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=n,o=arguments[1];return typeof r=="function"?this.then(null,function(u){return(u instanceof r?o:Gn)(u)}):this.then(null,function(u){return(u&&u.name===r?o:Gn)(u)})},finally:function(n){return this.then(function(r){return K.resolve(n()).then(function(){return r})},function(r){return K.resolve(n()).then(function(){return Gn(r)})})},timeout:function(n,r){var o=this;return n<1/0?new K(function(u,s){var c=setTimeout(function(){return s(new q.Timeout(r))},n);o.then(u,s).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ee(K.prototype,Symbol.toStringTag,"Dexie.Promise"),De.env=Ur(),Q(K,{all:function(){var n=$e.apply(null,arguments).map(Hn);return new K(function(r,o){n.length===0&&r([]);var u=n.length;n.forEach(function(s,c){return K.resolve(s).then(function(f){n[c]=f,--u||r(n)},o)})})},resolve:function(n){return n instanceof K?n:n&&typeof n.then=="function"?new K(function(r,o){n.then(r,o)}):new K(Pn,!0,n)},reject:Gn,race:function(){var n=$e.apply(null,arguments).map(Hn);return new K(function(r,o){n.map(function(u){return K.resolve(u).then(r,o)})})},PSD:{get:function(){return F},set:function(n){return F=n}},totalEchoes:{get:function(){return Qn}},newPSD:Re,usePSD:en,scheduler:{get:function(){return In},set:function(n){In=n}},rejectionMapper:{get:function(){return Nt},set:function(n){Nt=n}},follow:function(n,r){return new K(function(o,u){return Re(function(s,c){var f=F;f.unhandleds=[],f.onunhandled=c,f.finalize=Ge(function(){var h,v=this;h=function(){v.unhandleds.length===0?s():c(v.unhandleds[0])},Yn.push(function g(){h(),Yn.splice(Yn.indexOf(g),1)}),++He,In(function(){--He==0&&Mt()},[])},f.finalize),n()},r,o,u)})}}),Xe&&(Xe.allSettled&&ee(K,"allSettled",function(){var n=$e.apply(null,arguments).map(Hn);return new K(function(r){n.length===0&&r([]);var o=n.length,u=new Array(o);n.forEach(function(s,c){return K.resolve(s).then(function(f){return u[c]={status:"fulfilled",value:f}},function(f){return u[c]={status:"rejected",reason:f}}).then(function(){return--o||r(u)})})})}),Xe.any&&typeof AggregateError<"u"&&ee(K,"any",function(){var n=$e.apply(null,arguments).map(Hn);return new K(function(r,o){n.length===0&&o(new AggregateError([]));var u=n.length,s=new Array(u);n.forEach(function(c,f){return K.resolve(c).then(function(h){return r(h)},function(h){s[f]=h,--u||o(new AggregateError(s))})})})}),Xe.withResolvers&&(K.withResolvers=Xe.withResolvers));var he={awaits:0,echoes:0,id:0},Pi=0,Jn=[],Xn=0,Qn=0,Si=0;function Re(n,r,o,u){var s=F,c=Object.create(s);return c.parent=s,c.ref=0,c.global=!1,c.id=++Si,De.env,c.env=Rt?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},r&&Z(c,r),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()},u=en(c,n,o,u),c.ref===0&&c.finalize(),u}function dn(){return he.id||(he.id=++Pi),++he.awaits,he.echoes+=Br,he.id}function Ke(){return!!he.awaits&&(--he.awaits==0&&(he.id=0),he.echoes=he.awaits*Br,!0)}function Hn(n){return he.echoes&&n&&n.constructor===Xe?(dn(),n.then(function(r){return Ke(),r},function(r){return Ke(),le(r)})):n}function Ii(){var n=Jn[Jn.length-1];Jn.pop(),Ne(n,!1)}function Ne(n,r){var o,u=F;(r?!he.echoes||Xn++&&n===F:!Xn||--Xn&&n===F)||queueMicrotask(r?function(s){++Qn,he.echoes&&--he.echoes!=0||(he.echoes=he.awaits=he.id=0),Jn.push(F),Ne(s,!0)}.bind(null,n):Ii),n!==F&&(F=n,u===De&&(De.env=Ur()),Rt&&(o=De.env.Promise,r=n.env,(u.global||n.global)&&(Object.defineProperty(m,"Promise",r.PromiseProp),o.all=r.all,o.race=r.race,o.resolve=r.resolve,o.reject=r.reject,r.allSettled&&(o.allSettled=r.allSettled),r.any&&(o.any=r.any))))}function Ur(){var n=m.Promise;return Rt?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(m,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function en(n,r,o,u,s){var c=F;try{return Ne(n,!0),r(o,u,s)}finally{Ne(c,!1)}}function Lr(n,r,o,u){return typeof n!="function"?n:function(){var s=F;o&&dn(),Ne(r,!0);try{return n.apply(this,arguments)}finally{Ne(s,!1),u&&queueMicrotask(Ke)}}}function Ut(n){Promise===Xe&&he.echoes===0?Xn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+ze).indexOf("[native code]")===-1&&(dn=Ke=H);var le=K.reject,nn=String.fromCharCode(65535),Te="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Vr="String expected.",pn=[],et="__dbnames",Lt="readonly",Vt="readwrite";function tn(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var Wr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function nt(n){return typeof n!="string"||/\./.test(n)?function(r){return r}:function(r){return r[n]===void 0&&n in r&&delete(r=We(r))[n],r}}function Yr(){throw q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function G(n,r){try{var o=Gr(n),u=Gr(r);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return r<n?1:n<r?-1:0;case"binary":return function(s,c){for(var f=s.length,h=c.length,v=f<h?f:h,g=0;g<v;++g)if(s[g]!==c[g])return s[g]<c[g]?-1:1;return f===h?0:f<h?-1:1}(Jr(n),Jr(r));case"Array":return function(s,c){for(var f=s.length,h=c.length,v=f<h?f:h,g=0;g<v;++g){var _=G(s[g],c[g]);if(_!==0)return _}return f===h?0:f<h?-1:1}(n,r)}}catch{}return NaN}function Gr(n){var r=typeof n;return r!="object"?r:ArrayBuffer.isView(n)?"binary":(n=$t(n),n==="ArrayBuffer"?"binary":n)}function Jr(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function tt(n,r,o){var u=n.schema.yProps;return u?(r&&0<o.numFailures&&(r=r.filter(function(s,c){return!o.failures[c]})),Promise.all(u.map(function(s){return s=s.updatesTable,r?n.db.table(s).where("k").anyOf(r).delete():n.db.table(s).clear()})).then(function(){return o})):o}var Xr=(te.prototype._trans=function(n,r,o){var u=this._tx||F.trans,s=this.name,c=Pe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function f(g,_,d){if(!d.schema[s])throw new q.NotFound("Table "+s+" not part of transaction");return r(d.idbtrans,d)}var h=fn();try{var v=u&&u.db._novip===this.db._novip?u===F.trans?u._promise(n,f,o):Re(function(){return u._promise(n,f,o)},{trans:u,transless:F.transless||F}):function g(_,d,x,y){if(_.idbdb&&(_._state.openComplete||F.letThrough||_._vip)){var b=_._createTransaction(d,x,_._dbSchema);try{b.create(),_._state.PR1398_maxLoop=3}catch(k){return k.name===Ct.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return g(_,d,x,y)})):le(k)}return b._promise(d,function(k,w){return Re(function(){return F.trans=b,y(k,w,b)})}).then(function(k){if(d==="readwrite")try{b.idbtrans.commit()}catch{}return d==="readonly"?k:b._completion.then(function(){return k})})}if(_._state.openComplete)return le(new q.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return le(new q.DatabaseClosed);_.open().catch(H)}return _._state.dbReadyPromise.then(function(){return g(_,d,x,y)})}(this.db,n,[this.name],f);return c&&(v._consoleTask=c,v=v.catch(function(g){return console.trace(g),le(g)})),v}finally{h&&hn()}},te.prototype.get=function(n,r){var o=this;return n&&n.constructor===Object?this.where(n).first(r):n==null?le(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return o.core.get({trans:u,key:n}).then(function(s){return o.hook.reading.fire(s)})}).then(r)},te.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(O(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var r=p(n);if(r.length===1)return this.where(r[0]).equals(n[r[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(h){if(h.compound&&r.every(function(g){return 0<=h.keyPath.indexOf(g)})){for(var v=0;v<r.length;++v)if(r.indexOf(h.keyPath[v])===-1)return!1;return!0}return!1}).sort(function(h,v){return h.keyPath.length-v.keyPath.length})[0];if(o&&this.db._maxKey!==nn){var c=o.keyPath.slice(0,r.length);return this.where(c).equals(c.map(function(v){return n[v]}))}!o&&Pe&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var u=this.schema.idxByName;function s(h,v){return G(h,v)===0}var f=r.reduce(function(d,v){var g=d[0],_=d[1],d=u[v],x=n[v];return[g||d,g||!d?tn(_,d&&d.multi?function(y){return y=Ze(y,v),O(y)&&y.some(function(b){return s(x,b)})}:function(y){return s(x,Ze(y,v))}):_]},[null,null]),c=f[0],f=f[1];return c?this.where(c.name).equals(n[c.keyPath]).filter(f):o?this.filter(f):this.where(r).equals("")},te.prototype.filter=function(n){return this.toCollection().and(n)},te.prototype.count=function(n){return this.toCollection().count(n)},te.prototype.offset=function(n){return this.toCollection().offset(n)},te.prototype.limit=function(n){return this.toCollection().limit(n)},te.prototype.each=function(n){return this.toCollection().each(n)},te.prototype.toArray=function(n){return this.toCollection().toArray(n)},te.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},te.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,O(n)?"[".concat(n.join("+"),"]"):n))},te.prototype.reverse=function(){return this.toCollection().reverse()},te.prototype.mapToClass=function(n){var r,o=this.db,u=this.name;function s(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof Yr&&(function(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function _(){this.constructor=v}i(v,g),v.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}(s,r=n),Object.defineProperty(s.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),s.prototype.table=function(){return u},n=s);for(var c=new Set,f=n.prototype;f;f=D(f))Object.getOwnPropertyNames(f).forEach(function(v){return c.add(v)});function h(v){if(!v)return v;var g,_=Object.create(n.prototype);for(g in v)if(!c.has(g))try{_[g]=v[g]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},te.prototype.defineClass=function(){return this.mapToClass(function(n){Z(this,n)})},te.prototype.add=function(n,r){var o=this,u=this.schema.primKey,s=u.auto,c=u.keyPath,f=n;return c&&s&&(f=nt(c)(n)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"add",keys:r!=null?[r]:null,values:[f]})}).then(function(h){return h.numFailures?K.reject(h.failures[0]):h.lastResult}).then(function(h){if(c)try{we(n,c,h)}catch{}return h})},te.prototype.update=function(n,r){return typeof n!="object"||O(n)?this.where(":id").equals(n).modify(r):(n=Ze(n,this.schema.primKey.keyPath),n===void 0?le(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r))},te.prototype.put=function(n,r){var o=this,u=this.schema.primKey,s=u.auto,c=u.keyPath,f=n;return c&&s&&(f=nt(c)(n)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"put",values:[f],keys:r!=null?[r]:null})}).then(function(h){return h.numFailures?K.reject(h.failures[0]):h.lastResult}).then(function(h){if(c)try{we(n,c,h)}catch{}return h})},te.prototype.delete=function(n){var r=this;return this._trans("readwrite",function(o){return r.core.mutate({trans:o,type:"delete",keys:[n]}).then(function(u){return tt(r,[n],u)}).then(function(u){return u.numFailures?K.reject(u.failures[0]):void 0})})},te.prototype.clear=function(){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"deleteRange",range:Wr}).then(function(o){return tt(n,null,o)})}).then(function(r){return r.numFailures?K.reject(r.failures[0]):void 0})},te.prototype.bulkGet=function(n){var r=this;return this._trans("readonly",function(o){return r.core.getMany({keys:n,trans:o}).then(function(u){return u.map(function(s){return r.hook.reading.fire(s)})})})},te.prototype.bulkAdd=function(n,r,o){var u=this,s=Array.isArray(r)?r:void 0,c=(o=o||(s?void 0:r))?o.allKeys:void 0;return this._trans("readwrite",function(f){var g=u.schema.primKey,h=g.auto,g=g.keyPath;if(g&&s)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=n.length,g=g&&h?n.map(nt(g)):n;return u.core.mutate({trans:f,type:"add",keys:s,values:g,wantResults:c}).then(function(b){var d=b.numFailures,x=b.results,y=b.lastResult,b=b.failures;if(d===0)return c?x:y;throw new ln("".concat(u.name,".bulkAdd(): ").concat(d," of ").concat(v," operations failed"),b)})})},te.prototype.bulkPut=function(n,r,o){var u=this,s=Array.isArray(r)?r:void 0,c=(o=o||(s?void 0:r))?o.allKeys:void 0;return this._trans("readwrite",function(f){var g=u.schema.primKey,h=g.auto,g=g.keyPath;if(g&&s)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=n.length,g=g&&h?n.map(nt(g)):n;return u.core.mutate({trans:f,type:"put",keys:s,values:g,wantResults:c}).then(function(b){var d=b.numFailures,x=b.results,y=b.lastResult,b=b.failures;if(d===0)return c?x:y;throw new ln("".concat(u.name,".bulkPut(): ").concat(d," of ").concat(v," operations failed"),b)})})},te.prototype.bulkUpdate=function(n){var r=this,o=this.core,u=n.map(function(f){return f.key}),s=n.map(function(f){return f.changes}),c=[];return this._trans("readwrite",function(f){return o.getMany({trans:f,keys:u,cache:"clone"}).then(function(h){var v=[],g=[];n.forEach(function(d,x){var y=d.key,b=d.changes,k=h[x];if(k){for(var w=0,z=Object.keys(b);w<z.length;w++){var E=z[w],P=b[E];if(E===r.schema.primKey.keyPath){if(G(P,y)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else we(k,E,P)}c.push(x),v.push(y),g.push(k)}});var _=v.length;return o.mutate({trans:f,type:"put",keys:v,values:g,updates:{keys:u,changeSpecs:s}}).then(function(d){var x=d.numFailures,y=d.failures;if(x===0)return _;for(var b=0,k=Object.keys(y);b<k.length;b++){var w,z=k[b],E=c[Number(z)];E!=null&&(w=y[z],delete y[z],y[E]=w)}throw new ln("".concat(r.name,".bulkUpdate(): ").concat(x," of ").concat(_," operations failed"),y)})})})},te.prototype.bulkDelete=function(n){var r=this,o=n.length;return this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"delete",keys:n}).then(function(s){return tt(r,n,s)})}).then(function(f){var s=f.numFailures,c=f.lastResult,f=f.failures;if(s===0)return c;throw new ln("".concat(r.name,".bulkDelete(): ").concat(s," of ").concat(o," operations failed"),f)})},te);function te(){}function Zn(n){function r(f,h){if(h){for(var v=arguments.length,g=new Array(v-1);--v;)g[v-1]=arguments[v];return o[f].subscribe.apply(null,g),n}if(typeof f=="string")return o[f]}var o={};r.addEventType=c;for(var u=1,s=arguments.length;u<s;++u)c(arguments[u]);return r;function c(f,h,v){if(typeof f!="object"){var g;h=h||zi;var _={subscribers:[],fire:v=v||H,subscribe:function(d){_.subscribers.indexOf(d)===-1&&(_.subscribers.push(d),_.fire=h(_.fire,d))},unsubscribe:function(d){_.subscribers=_.subscribers.filter(function(x){return x!==d}),_.fire=_.subscribers.reduce(h,v)}};return o[f]=r[f]=_}p(g=f).forEach(function(d){var x=g[d];if(O(x))c(d,g[d][0],g[d][1]);else{if(x!=="asap")throw new q.InvalidArgument("Invalid event config");var y=c(d,On,function(){for(var b=arguments.length,k=new Array(b);b--;)k[b]=arguments[b];y.subscribers.forEach(function(w){Ce(function(){w.apply(null,k)})})})}})}}function $n(n,r){return Oe(r).from({prototype:n}),r}function mn(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function Wt(n,r){n.filter=tn(n.filter,r)}function Yt(n,r,o){var u=n.replayFilter;n.replayFilter=u?function(){return tn(u(),r())}:r,n.justLimit=o&&!u}function rt(n,r){if(n.isPrimKey)return r.primaryKey;var o=r.getIndexByKeyPath(n.index);if(!o)throw new q.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return o}function Qr(n,r,o){var u=rt(n,r.schema);return r.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function ot(n,r,o,u){var s=n.replayFilter?tn(n.filter,n.replayFilter()):n.filter;if(n.or){var c={},f=function(h,v,g){var _,d;s&&!s(v,g,function(x){return v.stop(x)},function(x){return v.fail(x)})||((d=""+(_=v.primaryKey))=="[object ArrayBuffer]"&&(d=""+new Uint8Array(_)),L(c,d)||(c[d]=!0,r(h,v,g)))};return Promise.all([n.or._iterate(f,o),Hr(Qr(n,u,o),n.algorithm,f,!n.keysOnly&&n.valueMapper)])}return Hr(Qr(n,u,o),tn(n.algorithm,s),r,!n.keysOnly&&n.valueMapper)}function Hr(n,r,o,u){var s=re(u?function(c,f,h){return o(u(c),f,h)}:o);return n.then(function(c){if(c)return c.start(function(){var f=function(){return c.continue()};r&&!r(c,function(h){return f=h},function(h){c.stop(h),f=H},function(h){c.fail(h),f=H})||s(c.value,c,function(h){return f=h}),f()})})}var Tn=(eo.prototype.execute=function(n){var r=this["@@propmod"];if(r.add!==void 0){var o=r.add;if(O(o))return l(l([],O(n)?n:[],!0),o,!0).sort();if(typeof o=="number")return(Number(n)||0)+o;if(typeof o=="bigint")try{return BigInt(n)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(r.remove!==void 0){var u=r.remove;if(O(u))return O(n)?n.filter(function(s){return!u.includes(s)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return o=(o=r.replacePrefix)===null||o===void 0?void 0:o[0],o&&typeof n=="string"&&n.startsWith(o)?r.replacePrefix[1]+n.substring(o.length):n},eo);function eo(n){this["@@propmod"]=n}var Ai=(X.prototype._read=function(n,r){var o=this._ctx;return o.error?o.table._trans(null,le.bind(null,o.error)):o.table._trans("readonly",n).then(r)},X.prototype._write=function(n){var r=this._ctx;return r.error?r.table._trans(null,le.bind(null,r.error)):r.table._trans("readwrite",n,"locked")},X.prototype._addAlgorithm=function(n){var r=this._ctx;r.algorithm=tn(r.algorithm,n)},X.prototype._iterate=function(n,r){return ot(this._ctx,n,r,this._ctx.table.core)},X.prototype.clone=function(n){var r=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return n&&Z(o,n),r._ctx=o,r},X.prototype.raw=function(){return this._ctx.valueMapper=null,this},X.prototype.each=function(n){var r=this._ctx;return this._read(function(o){return ot(r,n,o,r.table.core)})},X.prototype.count=function(n){var r=this;return this._read(function(o){var u=r._ctx,s=u.table.core;if(mn(u,!0))return s.count({trans:o,query:{index:rt(u,s.schema),range:u.range}}).then(function(f){return Math.min(f,u.limit)});var c=0;return ot(u,function(){return++c,!1},o,s).then(function(){return c})}).then(n)},X.prototype.sortBy=function(n,r){var o=n.split(".").reverse(),u=o[0],s=o.length-1;function c(v,g){return g?c(v[o[g]],g-1):v[u]}var f=this._ctx.dir==="next"?1:-1;function h(v,g){return G(c(v,s),c(g,s))*f}return this.toArray(function(v){return v.sort(h)}).then(r)},X.prototype.toArray=function(n){var r=this;return this._read(function(o){var u=r._ctx;if(u.dir==="next"&&mn(u,!0)&&0<u.limit){var s=u.valueMapper,c=rt(u,u.table.core.schema);return u.table.core.query({trans:o,limit:u.limit,values:!0,query:{index:c,range:u.range}}).then(function(h){return h=h.result,s?h.map(s):h})}var f=[];return ot(u,function(h){return f.push(h)},o,u.table.core).then(function(){return f})},n)},X.prototype.offset=function(n){var r=this._ctx;return n<=0||(r.offset+=n,mn(r)?Yt(r,function(){var o=n;return function(u,s){return o===0||(o===1?--o:s(function(){u.advance(o),o=0}),!1)}}):Yt(r,function(){var o=n;return function(){return--o<0}})),this},X.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Yt(this._ctx,function(){var r=n;return function(o,u,s){return--r<=0&&u(s),0<=r}},!0),this},X.prototype.until=function(n,r){return Wt(this._ctx,function(o,u,s){return!n(o.value)||(u(s),r)}),this},X.prototype.first=function(n){return this.limit(1).toArray(function(r){return r[0]}).then(n)},X.prototype.last=function(n){return this.reverse().first(n)},X.prototype.filter=function(n){var r;return Wt(this._ctx,function(o){return n(o.value)}),(r=this._ctx).isMatch=tn(r.isMatch,n),this},X.prototype.and=function(n){return this.filter(n)},X.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},X.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},X.prototype.desc=function(){return this.reverse()},X.prototype.eachKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(o,u){n(u.key,u)})},X.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},X.prototype.eachPrimaryKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(o,u){n(u.primaryKey,u)})},X.prototype.keys=function(n){var r=this._ctx;r.keysOnly=!r.isMatch;var o=[];return this.each(function(u,s){o.push(s.key)}).then(function(){return o}).then(n)},X.prototype.primaryKeys=function(n){var r=this._ctx;if(r.dir==="next"&&mn(r,!0)&&0<r.limit)return this._read(function(u){var s=rt(r,r.table.core.schema);return r.table.core.query({trans:u,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(function(u){return u.result}).then(n);r.keysOnly=!r.isMatch;var o=[];return this.each(function(u,s){o.push(s.primaryKey)}).then(function(){return o}).then(n)},X.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},X.prototype.firstKey=function(n){return this.limit(1).keys(function(r){return r[0]}).then(n)},X.prototype.lastKey=function(n){return this.reverse().firstKey(n)},X.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var r={};return Wt(this._ctx,function(s){var u=s.primaryKey.toString(),s=L(r,u);return r[u]=!0,!s}),this},X.prototype.modify=function(n){var r=this,o=this._ctx;return this._write(function(u){var s,c,f;f=typeof n=="function"?n:(s=p(n),c=s.length,function(z){for(var E=!1,P=0;P<c;++P){var S=s[P],A=n[S],j=Ze(z,S);A instanceof Tn?(we(z,S,A.execute(j)),E=!0):j!==A&&(we(z,S,A),E=!0)}return E});var h=o.table.core,d=h.schema.primaryKey,v=d.outbound,g=d.extractKey,_=200,d=r.db._options.modifyChunkSize;d&&(_=typeof d=="object"?d[h.name]||d["*"]||200:d);function x(z,S){var P=S.failures,S=S.numFailures;b+=z-S;for(var A=0,j=p(P);A<j.length;A++){var $=j[A];y.push(P[$])}}var y=[],b=0,k=[],w=n===no;return r.clone().primaryKeys().then(function(z){function E(S){var A=Math.min(_,z.length-S),j=z.slice(S,S+A);return(w?Promise.resolve([]):h.getMany({trans:u,keys:j,cache:"immutable"})).then(function($){var T=[],R=[],C=v?[]:null,N=w?j:[];if(!w)for(var V=0;V<A;++V){var J=$[V],U={value:We(J),primKey:z[S+V]};f.call(U,U.value,U)!==!1&&(U.value==null?N.push(z[S+V]):v||G(g(J),g(U.value))===0?(R.push(U.value),v&&C.push(z[S+V])):(N.push(z[S+V]),T.push(U.value)))}return Promise.resolve(0<T.length&&h.mutate({trans:u,type:"add",values:T}).then(function(se){for(var M in se.failures)N.splice(parseInt(M),1);x(T.length,se)})).then(function(){return(0<R.length||P&&typeof n=="object")&&h.mutate({trans:u,type:"put",keys:C,values:R,criteria:P,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<S}).then(function(se){return x(R.length,se)})}).then(function(){return(0<N.length||P&&w)&&h.mutate({trans:u,type:"delete",keys:N,criteria:P,isAdditionalChunk:0<S}).then(function(se){return tt(o.table,N,se)}).then(function(se){return x(N.length,se)})}).then(function(){return z.length>S+A&&E(S+_)})})}var P=mn(o)&&o.limit===1/0&&(typeof n!="function"||w)&&{index:o.index,range:o.range};return E(0).then(function(){if(0<y.length)throw new Un("Error modifying one or more objects",y,b,k);return z.length})})})},X.prototype.delete=function(){var n=this._ctx,r=n.range;return!mn(n)||n.table.schema.yProps||!n.isPrimKey&&r.type!==3?this.modify(no):this._write(function(o){var u=n.table.core.schema.primaryKey,s=r;return n.table.core.count({trans:o,query:{index:u,range:s}}).then(function(c){return n.table.core.mutate({trans:o,type:"deleteRange",range:s}).then(function(v){var h=v.failures,v=v.numFailures;if(v)throw new Un("Could not delete some values",Object.keys(h).map(function(g){return h[g]}),c-v);return c-v})})})},X);function X(){}var no=function(n,r){return r.value=null};function Zi(n,r){return n<r?-1:n===r?0:1}function $i(n,r){return r<n?-1:n===r?0:1}function ke(n,r,o){return n=n instanceof ro?new n.Collection(n):n,n._ctx.error=new(o||TypeError)(r),n}function vn(n){return new n.Collection(n,function(){return to("")}).limit(0)}function it(n,r,o,u){var s,c,f,h,v,g,_,d=o.length;if(!o.every(function(b){return typeof b=="string"}))return ke(n,Vr);function x(b){s=b==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},c=b==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},f=b==="next"?Zi:$i;var k=o.map(function(w){return{lower:c(w),upper:s(w)}}).sort(function(w,z){return f(w.lower,z.lower)});h=k.map(function(w){return w.upper}),v=k.map(function(w){return w.lower}),_=(g=b)==="next"?"":u}x("next"),n=new n.Collection(n,function(){return Fe(h[0],v[d-1]+u)}),n._ondirectionchange=function(b){x(b)};var y=0;return n._addAlgorithm(function(b,k,w){var z=b.key;if(typeof z!="string")return!1;var E=c(z);if(r(E,v,y))return!0;for(var P=null,S=y;S<d;++S){var A=function(j,$,T,R,C,N){for(var V=Math.min(j.length,R.length),J=-1,U=0;U<V;++U){var se=$[U];if(se!==R[U])return C(j[U],T[U])<0?j.substr(0,U)+T[U]+T.substr(U+1):C(j[U],R[U])<0?j.substr(0,U)+R[U]+T.substr(U+1):0<=J?j.substr(0,J)+$[J]+T.substr(J+1):null;C(j[U],se)<0&&(J=U)}return V<R.length&&N==="next"?j+T.substr(j.length):V<j.length&&N==="prev"?j.substr(0,T.length):J<0?null:j.substr(0,J)+R[J]+T.substr(J+1)}(z,E,h[S],v[S],f,g);A===null&&P===null?y=S+1:(P===null||0<f(P,A))&&(P=A)}return k(P!==null?function(){b.continue(P+_)}:w),!1}),n}function Fe(n,r,o,u){return{type:2,lower:n,upper:r,lowerOpen:o,upperOpen:u}}function to(n){return{type:1,lower:n,upper:n}}var ro=(Object.defineProperty(de.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),de.prototype.between=function(n,r,o,u){o=o!==!1,u=u===!0;try{return 0<this._cmp(n,r)||this._cmp(n,r)===0&&(o||u)&&(!o||!u)?vn(this):new this.Collection(this,function(){return Fe(n,r,!o,!u)})}catch{return ke(this,Te)}},de.prototype.equals=function(n){return n==null?ke(this,Te):new this.Collection(this,function(){return to(n)})},de.prototype.above=function(n){return n==null?ke(this,Te):new this.Collection(this,function(){return Fe(n,void 0,!0)})},de.prototype.aboveOrEqual=function(n){return n==null?ke(this,Te):new this.Collection(this,function(){return Fe(n,void 0,!1)})},de.prototype.below=function(n){return n==null?ke(this,Te):new this.Collection(this,function(){return Fe(void 0,n,!1,!0)})},de.prototype.belowOrEqual=function(n){return n==null?ke(this,Te):new this.Collection(this,function(){return Fe(void 0,n)})},de.prototype.startsWith=function(n){return typeof n!="string"?ke(this,Vr):this.between(n,n+nn,!0,!0)},de.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):it(this,function(r,o){return r.indexOf(o[0])===0},[n],nn)},de.prototype.equalsIgnoreCase=function(n){return it(this,function(r,o){return r===o[0]},[n],"")},de.prototype.anyOfIgnoreCase=function(){var n=$e.apply(sn,arguments);return n.length===0?vn(this):it(this,function(r,o){return o.indexOf(r)!==-1},n,"")},de.prototype.startsWithAnyOfIgnoreCase=function(){var n=$e.apply(sn,arguments);return n.length===0?vn(this):it(this,function(r,o){return o.some(function(u){return r.indexOf(u)===0})},n,nn)},de.prototype.anyOf=function(){var n=this,r=$e.apply(sn,arguments),o=this._cmp;try{r.sort(o)}catch{return ke(this,Te)}if(r.length===0)return vn(this);var u=new this.Collection(this,function(){return Fe(r[0],r[r.length-1])});u._ondirectionchange=function(c){o=c==="next"?n._ascending:n._descending,r.sort(o)};var s=0;return u._addAlgorithm(function(c,f,h){for(var v=c.key;0<o(v,r[s]);)if(++s===r.length)return f(h),!1;return o(v,r[s])===0||(f(function(){c.continue(r[s])}),!1)}),u},de.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},de.prototype.noneOf=function(){var n=$e.apply(sn,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return ke(this,Te)}var r=n.reduce(function(o,u){return o?o.concat([[o[o.length-1][1],u]]):[[-1/0,u]]},null);return r.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},de.prototype.inAnyRange=function(z,r){var o=this,u=this._cmp,s=this._ascending,c=this._descending,f=this._min,h=this._max;if(z.length===0)return vn(this);if(!z.every(function(E){return E[0]!==void 0&&E[1]!==void 0&&s(E[0],E[1])<=0}))return ke(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var v=!r||r.includeLowers!==!1,g=r&&r.includeUppers===!0,_,d=s;function x(E,P){return d(E[0],P[0])}try{(_=z.reduce(function(E,P){for(var S=0,A=E.length;S<A;++S){var j=E[S];if(u(P[0],j[1])<0&&0<u(P[1],j[0])){j[0]=f(j[0],P[0]),j[1]=h(j[1],P[1]);break}}return S===A&&E.push(P),E},[])).sort(x)}catch{return ke(this,Te)}var y=0,b=g?function(E){return 0<s(E,_[y][1])}:function(E){return 0<=s(E,_[y][1])},k=v?function(E){return 0<c(E,_[y][0])}:function(E){return 0<=c(E,_[y][0])},w=b,z=new this.Collection(this,function(){return Fe(_[0][0],_[_.length-1][1],!v,!g)});return z._ondirectionchange=function(E){d=E==="next"?(w=b,s):(w=k,c),_.sort(x)},z._addAlgorithm(function(E,P,S){for(var A,j=E.key;w(j);)if(++y===_.length)return P(S),!1;return!b(A=j)&&!k(A)||(o._cmp(j,_[y][1])===0||o._cmp(j,_[y][0])===0||P(function(){d===s?E.continue(_[y][0]):E.continue(_[y][1])}),!1)}),z},de.prototype.startsWithAnyOf=function(){var n=$e.apply(sn,arguments);return n.every(function(r){return typeof r=="string"})?n.length===0?vn(this):this.inAnyRange(n.map(function(r){return[r,r+nn]})):ke(this,"startsWithAnyOf() only works with strings")},de);function de(){}function Se(n){return re(function(r){return jn(r),n(r.target.error),!1})}function jn(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var Cn="storagemutated",Gt="x-storagemutated-1",Be=Zn(null,Cn),Ti=(Ie.prototype._lock=function(){return pe(!F.global),++this._reculock,this._reculock!==1||F.global||(F.lockOwnerFor=this),this},Ie.prototype._unlock=function(){if(pe(!F.global),--this._reculock==0)for(F.global||(F.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{en(n[1],n[0])}catch{}}return this},Ie.prototype._locked=function(){return this._reculock&&F.lockOwnerFor!==this},Ie.prototype.create=function(n){var r=this;if(!this.mode)return this;var o=this.db.idbdb,u=this.db._state.dbOpenError;if(pe(!this.idbtrans),!n&&!o)switch(u&&u.name){case"DatabaseClosedError":throw new q.DatabaseClosed(u);case"MissingAPIError":throw new q.MissingAPI(u.message,u);default:throw new q.OpenFailed(u)}if(!this.active)throw new q.TransactionInactive;return pe(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=re(function(s){jn(s),r._reject(n.error)}),n.onabort=re(function(s){jn(s),r.active&&r._reject(new q.Abort(n.error)),r.active=!1,r.on("abort").fire(s)}),n.oncomplete=re(function(){r.active=!1,r._resolve(),"mutatedParts"in n&&Be.storagemutated.fire(n.mutatedParts)}),this},Ie.prototype._promise=function(n,r,o){var u=this;if(n==="readwrite"&&this.mode!=="readwrite")return le(new q.ReadOnly("Transaction is readonly"));if(!this.active)return le(new q.TransactionInactive);if(this._locked())return new K(function(c,f){u._blockedFuncs.push([function(){u._promise(n,r,o).then(c,f)},F])});if(o)return Re(function(){var c=new K(function(f,h){u._lock();var v=r(f,h,u);v&&v.then&&v.then(f,h)});return c.finally(function(){return u._unlock()}),c._lib=!0,c});var s=new K(function(c,f){var h=r(c,f,u);h&&h.then&&h.then(c,f)});return s._lib=!0,s},Ie.prototype._root=function(){return this.parent?this.parent._root():this},Ie.prototype.waitFor=function(n){var r,o=this._root(),u=K.resolve(n);o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return u}):(o._waitingFor=u,o._waitingQueue=[],r=o.idbtrans.objectStore(o.storeNames[0]),function c(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(r.get(-1/0).onsuccess=c)}());var s=o._waitingFor;return new K(function(c,f){u.then(function(h){return o._waitingQueue.push(re(c.bind(null,h)))},function(h){return o._waitingQueue.push(re(f.bind(null,h)))}).finally(function(){o._waitingFor===s&&(o._waitingFor=null)})})},Ie.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},Ie.prototype.table=function(n){var r=this._memoizedTables||(this._memoizedTables={});if(L(r,n))return r[n];var o=this.schema[n];if(!o)throw new q.NotFound("Table "+n+" not part of transaction");return o=new this.db.Table(n,o,this),o.core=this.db.core.table(n),r[n]=o},Ie);function Ie(){}function Jt(n,r,o,u,s,c,f,h){return{name:n,keyPath:r,unique:o,multi:u,auto:s,compound:c,src:(o&&!f?"&":"")+(u?"*":"")+(s?"++":"")+oo(r),type:h}}function oo(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Xt(n,r,o){return{name:n,primKey:r,indexes:o,mappedClass:null,idxByName:(u=function(s){return[s.name,s]},o.reduce(function(s,c,f){return f=u(c,f),f&&(s[f[0]]=f[1]),s},{}))};var u}var Dn=function(n){try{return n.only([[]]),Dn=function(){return[[]]},[[]]}catch{return Dn=function(){return nn},nn}};function Qt(n){return n==null?function(){}:typeof n=="string"?(r=n).split(".").length===1?function(o){return o[r]}:function(o){return Ze(o,r)}:function(o){return Ze(o,n)};var r}function io(n){return[].slice.call(n)}var ji=0;function Rn(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Ci(n,r,v){function u(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=w.lower,b=w.upper,k=w.lowerOpen,w=w.upperOpen;return y===void 0?b===void 0?null:r.upperBound(b,!!w):b===void 0?r.lowerBound(y,!!k):r.bound(y,b,!!k,!!w)}function s(x){var y,b=x.name;return{name:b,schema:x,mutate:function(k){var w=k.trans,z=k.type,E=k.keys,P=k.values,S=k.range;return new Promise(function(A,j){A=re(A);var $=w.objectStore(b),T=$.keyPath==null,R=z==="put"||z==="add";if(!R&&z!=="delete"&&z!=="deleteRange")throw new Error("Invalid operation type: "+z);var C,N=(E||P||{length:1}).length;if(E&&P&&E.length!==P.length)throw new Error("Given keys array must have same length as given values array.");if(N===0)return A({numFailures:0,failures:{},results:[],lastResult:void 0});function V(ge){++se,jn(ge)}var J=[],U=[],se=0;if(z==="deleteRange"){if(S.type===4)return A({numFailures:se,failures:U,results:[],lastResult:void 0});S.type===3?J.push(C=$.clear()):J.push(C=$.delete(u(S)))}else{var T=R?T?[P,E]:[P,null]:[E,null],M=T[0],ve=T[1];if(R)for(var ye=0;ye<N;++ye)J.push(C=ve&&ve[ye]!==void 0?$[z](M[ye],ve[ye]):$[z](M[ye])),C.onerror=V;else for(ye=0;ye<N;++ye)J.push(C=$[z](M[ye])),C.onerror=V}function yt(ge){ge=ge.target.result,J.forEach(function(un,vr){return un.error!=null&&(U[vr]=un.error)}),A({numFailures:se,failures:U,results:z==="delete"?E:J.map(function(un){return un.result}),lastResult:ge})}C.onerror=function(ge){V(ge),yt(ge)},C.onsuccess=yt})},getMany:function(k){var w=k.trans,z=k.keys;return new Promise(function(E,P){E=re(E);for(var S,A=w.objectStore(b),j=z.length,$=new Array(j),T=0,R=0,C=function(J){J=J.target,$[J._pos]=J.result,++R===T&&E($)},N=Se(P),V=0;V<j;++V)z[V]!=null&&((S=A.get(z[V]))._pos=V,S.onsuccess=C,S.onerror=N,++T);T===0&&E($)})},get:function(k){var w=k.trans,z=k.key;return new Promise(function(E,P){E=re(E);var S=w.objectStore(b).get(z);S.onsuccess=function(A){return E(A.target.result)},S.onerror=Se(P)})},query:(y=g,function(k){return new Promise(function(w,z){w=re(w);var E,P,S,T=k.trans,A=k.values,j=k.limit,C=k.query,$=j===1/0?void 0:j,R=C.index,C=C.range,T=T.objectStore(b),R=R.isPrimaryKey?T:T.index(R.name),C=u(C);if(j===0)return w({result:[]});y?(($=A?R.getAll(C,$):R.getAllKeys(C,$)).onsuccess=function(N){return w({result:N.target.result})},$.onerror=Se(z)):(E=0,P=!A&&"openKeyCursor"in R?R.openKeyCursor(C):R.openCursor(C),S=[],P.onsuccess=function(N){var V=P.result;return V?(S.push(A?V.value:V.primaryKey),++E===j?w({result:S}):void V.continue()):w({result:S})},P.onerror=Se(z))})}),openCursor:function(k){var w=k.trans,z=k.values,E=k.query,P=k.reverse,S=k.unique;return new Promise(function(A,j){A=re(A);var R=E.index,$=E.range,T=w.objectStore(b),T=R.isPrimaryKey?T:T.index(R.name),R=P?S?"prevunique":"prev":S?"nextunique":"next",C=!z&&"openKeyCursor"in T?T.openKeyCursor(u($),R):T.openCursor(u($),R);C.onerror=Se(j),C.onsuccess=re(function(N){var V,J,U,se,M=C.result;M?(M.___id=++ji,M.done=!1,V=M.continue.bind(M),J=(J=M.continuePrimaryKey)&&J.bind(M),U=M.advance.bind(M),se=function(){throw new Error("Cursor not stopped")},M.trans=w,M.stop=M.continue=M.continuePrimaryKey=M.advance=function(){throw new Error("Cursor not started")},M.fail=re(j),M.next=function(){var ve=this,ye=1;return this.start(function(){return ye--?ve.continue():ve.stop()}).then(function(){return ve})},M.start=function(ve){function ye(){if(C.result)try{ve()}catch(ge){M.fail(ge)}else M.done=!0,M.start=function(){throw new Error("Cursor behind last entry")},M.stop()}var yt=new Promise(function(ge,un){ge=re(ge),C.onerror=Se(un),M.fail=un,M.stop=function(vr){M.stop=M.continue=M.continuePrimaryKey=M.advance=se,ge(vr)}});return C.onsuccess=re(function(ge){C.onsuccess=ye,ye()}),M.continue=V,M.continuePrimaryKey=J,M.advance=U,ye(),yt},A(M)):A(null)},j)})},count:function(k){var w=k.query,z=k.trans,E=w.index,P=w.range;return new Promise(function(S,A){var j=z.objectStore(b),$=E.isPrimaryKey?j:j.index(E.name),j=u(P),$=j?$.count(j):$.count();$.onsuccess=re(function(T){return S(T.target.result)}),$.onerror=Se(A)})}}}var c,f,h,_=(f=v,h=io((c=n).objectStoreNames),{schema:{name:c.name,tables:h.map(function(x){return f.objectStore(x)}).map(function(x){var y=x.keyPath,w=x.autoIncrement,b=O(y),k={},w={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:b,keyPath:y,autoIncrement:w,unique:!0,extractKey:Qt(y)},indexes:io(x.indexNames).map(function(z){return x.index(z)}).map(function(S){var E=S.name,P=S.unique,A=S.multiEntry,S=S.keyPath,A={name:E,compound:O(S),keyPath:S,unique:P,multiEntry:A,extractKey:Qt(S)};return k[Rn(S)]=A}),getIndexByKeyPath:function(z){return k[Rn(z)]}};return k[":id"]=w.primaryKey,y!=null&&(k[Rn(y)]=w.primaryKey),w})},hasGetAll:0<h.length&&"getAll"in f.objectStore(h[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=_.schema,g=_.hasGetAll,_=v.tables.map(s),d={};return _.forEach(function(x){return d[x.name]=x}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(x){if(!d[x])throw new Error("Table '".concat(x,"' not found"));return d[x]},MIN_KEY:-1/0,MAX_KEY:Dn(r),schema:v}}function Di(n,r,o,u){var s=o.IDBKeyRange;return o.indexedDB,{dbcore:(u=Ci(r,s,u),n.dbcore.reduce(function(c,f){return f=f.create,a(a({},c),f(c))},u))}}function ut(n,u){var o=u.db,u=Di(n._middlewares,o,n._deps,u);n.core=u.dbcore,n.tables.forEach(function(s){var c=s.name;n.core.schema.tables.some(function(f){return f.name===c})&&(s.core=n.core.table(c),n[c]instanceof n.Table&&(n[c].core=s.core))})}function at(n,r,o,u){o.forEach(function(s){var c=u[s];r.forEach(function(f){var h=function v(g,_){return Mn(g,_)||(g=D(g))&&v(g,_)}(f,s);(!h||"value"in h&&h.value===void 0)&&(f===n.Transaction.prototype||f instanceof n.Transaction?ee(f,s,{get:function(){return this.table(s)},set:function(v){Y(this,s,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):f[s]=new n.Table(s,c))})})}function Ht(n,r){r.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function Ri(n,r){return n._cfg.version-r._cfg.version}function Ki(n,r,o,u){var s=n._dbSchema;o.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Xt("$meta",ao("")[0],[]),n._storeNames.push("$meta"));var c=n._createTransaction("readwrite",n._storeNames,s);c.create(o),c._completion.catch(u);var f=c._reject.bind(c),h=F.transless||F;Re(function(){return F.trans=c,F.transless=h,r!==0?(ut(n,o),g=r,((v=c).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(_){return _??g}):K.resolve(g)).then(function(_){return x=_,y=c,b=o,k=[],_=(d=n)._versions,w=d._dbSchema=ct(0,d.idbdb,b),(_=_.filter(function(z){return z._cfg.version>=x})).length!==0?(_.forEach(function(z){k.push(function(){var E=w,P=z._cfg.dbschema;lt(d,E,b),lt(d,P,b),w=d._dbSchema=P;var S=er(E,P);S.add.forEach(function(R){nr(b,R[0],R[1].primKey,R[1].indexes)}),S.change.forEach(function(R){if(R.recreate)throw new q.Upgrade("Not yet support for changing primary key");var C=b.objectStore(R.name);R.add.forEach(function(N){return st(C,N)}),R.change.forEach(function(N){C.deleteIndex(N.name),st(C,N)}),R.del.forEach(function(N){return C.deleteIndex(N)})});var A=z._cfg.contentUpgrade;if(A&&z._cfg.version>x){ut(d,b),y._memoizedTables={};var j=Cr(P);S.del.forEach(function(R){j[R]=E[R]}),Ht(d,[d.Transaction.prototype]),at(d,[d.Transaction.prototype],p(j),j),y.schema=j;var $,T=jt(A);return T&&dn(),S=K.follow(function(){var R;($=A(y))&&T&&(R=Ke.bind(null,null),$.then(R,R))}),$&&typeof $.then=="function"?K.resolve($):S.then(function(){return $})}}),k.push(function(E){var P,S,A=z._cfg.dbschema;P=A,S=E,[].slice.call(S.db.objectStoreNames).forEach(function(j){return P[j]==null&&S.db.deleteObjectStore(j)}),Ht(d,[d.Transaction.prototype]),at(d,[d.Transaction.prototype],d._storeNames,d._dbSchema),y.schema=d._dbSchema}),k.push(function(E){d.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(d.idbdb.version/10)===z._cfg.version?(d.idbdb.deleteObjectStore("$meta"),delete d._dbSchema.$meta,d._storeNames=d._storeNames.filter(function(P){return P!=="$meta"})):E.objectStore("$meta").put(z._cfg.version,"version"))})}),function z(){return k.length?K.resolve(k.shift()(y.idbtrans)).then(z):K.resolve()}().then(function(){uo(w,b)})):K.resolve();var d,x,y,b,k,w}).catch(f)):(p(s).forEach(function(_){nr(o,_,s[_].primKey,s[_].indexes)}),ut(n,o),void K.follow(function(){return n.on.populate.fire(c)}).catch(f));var v,g})}function Ni(n,r){uo(n._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var o=ct(0,n.idbdb,r);lt(n,n._dbSchema,r);for(var u=0,s=er(o,n._dbSchema).change;u<s.length;u++){var c=function(f){if(f.change.length||f.recreate)return console.warn("Unable to patch indexes of table ".concat(f.name," because it has changes on the type of index or primary key.")),{value:void 0};var h=r.objectStore(f.name);f.add.forEach(function(v){Pe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(f.name,".").concat(v.src)),st(h,v)})}(s[u]);if(typeof c=="object")return c.value}}function er(n,r){var o,u={del:[],add:[],change:[]};for(o in n)r[o]||u.del.push(o);for(o in r){var s=n[o],c=r[o];if(s){var f={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)f.recreate=!0,u.change.push(f);else{var h=s.idxByName,v=c.idxByName,g=void 0;for(g in h)v[g]||f.del.push(g);for(g in v){var _=h[g],d=v[g];_?_.src!==d.src&&f.change.push(d):f.add.push(d)}(0<f.del.length||0<f.add.length||0<f.change.length)&&u.change.push(f)}}else u.add.push([o,c])}return u}function nr(n,r,o,u){var s=n.db.createObjectStore(r,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});return u.forEach(function(c){return st(s,c)}),s}function uo(n,r){p(n).forEach(function(o){r.db.objectStoreNames.contains(o)||(Pe&&console.debug("Dexie: Creating missing table",o),nr(r,o,n[o].primKey,n[o].indexes))})}function st(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function ct(n,r,o){var u={};return an(r.objectStoreNames,0).forEach(function(s){for(var c=o.objectStore(s),f=Jt(oo(g=c.keyPath),g||"",!0,!1,!!c.autoIncrement,g&&typeof g!="string",!0),h=[],v=0;v<c.indexNames.length;++v){var _=c.index(c.indexNames[v]),g=_.keyPath,_=Jt(_.name,g,!!_.unique,!!_.multiEntry,!1,g&&typeof g!="string",!1);h.push(_)}u[s]=Xt(s,f,h)}),u}function lt(n,r,o){for(var u=o.db.objectStoreNames,s=0;s<u.length;++s){var c=u[s],f=o.objectStore(c);n._hasGetAll="getAll"in f;for(var h=0;h<f.indexNames.length;++h){var v=f.indexNames[h],g=f.index(v).keyPath,_=typeof g=="string"?g:"["+an(g).join("+")+"]";!r[c]||(g=r[c].idxByName[_])&&(g.name=v,delete r[c].idxByName[_],r[c].idxByName[v]=g)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&m.WorkerGlobalScope&&m instanceof m.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ao(n){return n.split(",").map(function(r,o){var c=r.split(":"),u=(s=c[1])===null||s===void 0?void 0:s.trim(),s=(r=c[0].trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return Jt(s,c||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),O(c),o===0,u)})}var Fi=(yn.prototype._createTableSchema=Xt,yn.prototype._parseIndexSyntax=ao,yn.prototype._parseStoresSpec=function(n,r){var o=this;p(n).forEach(function(u){if(n[u]!==null){var s=o._parseIndexSyntax(n[u]),c=s.shift();if(!c)throw new q.Schema("Invalid schema for table "+u+": "+n[u]);if(c.unique=!0,c.multi)throw new q.Schema("Primary key cannot be multiEntry*");s.forEach(function(f){if(f.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),s=o._createTableSchema(u,c,s),r[u]=s}})},yn.prototype.stores=function(o){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?Z(this._cfg.storesSource,o):o;var o=r._versions,u={},s={};return o.forEach(function(c){Z(u,c._cfg.storesSource),s=c._cfg.dbschema={},c._parseStoresSpec(u,s)}),r._dbSchema=s,Ht(r,[r._allTables,r,r.Transaction.prototype]),at(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],p(s),s),r._storeNames=p(s),this},yn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=Dt(this._cfg.contentUpgrade||H,n),this},yn);function yn(){}function tr(n,r){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new je(et,{addons:[],indexedDB:n,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function rr(n){return n&&typeof n.databases=="function"}function or(n){return Re(function(){return F.letThrough=!0,n()})}function ir(n){return!("from"in n)}var me=function(n,r){if(!this){var o=new me;return n&&"d"in n&&Z(o,n),o}Z(this,arguments.length?{d:1,from:n,to:1<arguments.length?r:n}:{d:0})};function Kn(n,r,o){var u=G(r,o);if(!isNaN(u)){if(0<u)throw RangeError();if(ir(n))return Z(n,{from:r,to:o,d:1});var s=n.l,u=n.r;if(G(o,n.from)<0)return s?Kn(s,r,o):n.l={from:r,to:o,d:1,l:null,r:null},co(n);if(0<G(r,n.to))return u?Kn(u,r,o):n.r={from:r,to:o,d:1,l:null,r:null},co(n);G(r,n.from)<0&&(n.from=r,n.l=null,n.d=u?u.d+1:1),0<G(o,n.to)&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1),o=!n.r,s&&!n.l&&Nn(n,s),u&&o&&Nn(n,u)}}function Nn(n,r){ir(r)||function o(u,v){var c=v.from,f=v.to,h=v.l,v=v.r;Kn(u,c,f),h&&o(u,h),v&&o(u,v)}(n,r)}function so(n,r){var o=ft(r),u=o.next();if(u.done)return!1;for(var s=u.value,c=ft(n),f=c.next(s.from),h=f.value;!u.done&&!f.done;){if(G(h.from,s.to)<=0&&0<=G(h.to,s.from))return!0;G(s.from,h.from)<0?s=(u=o.next(h.from)).value:h=(f=c.next(s.from)).value}return!1}function ft(n){var r=ir(n)?null:{s:0,n};return{next:function(o){for(var u=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,u)for(;r.n.l&&G(o,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!u||G(o,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function co(n){var r,o,u=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((o=n.l)===null||o===void 0?void 0:o.d)||0),s=1<u?"r":u<-1?"l":"";s&&(r=s=="r"?"l":"r",o=a({},n),u=n[s],n.from=u.from,n.to=u.to,n[s]=u[s],o[s]=u[r],(n[r]=o).d=lo(o)),n.d=lo(n)}function lo(o){var r=o.r,o=o.l;return(r?o?Math.max(r.d,o.d):r.d:o?o.d:0)+1}function ht(n,r){return p(r).forEach(function(o){n[o]?Nn(n[o],r[o]):n[o]=function u(s){var c,f,h={};for(c in s)L(s,c)&&(f=s[c],h[c]=!f||typeof f!="object"||Rr.has(f.constructor)?f:u(f));return h}(r[o])}),n}function ur(n,r){return n.all||r.all||Object.keys(n).some(function(o){return r[o]&&so(r[o],n[o])})}Q(me.prototype,((ze={add:function(n){return Nn(this,n),this},addKey:function(n){return Kn(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(o){return Kn(r,o,o)}),this},hasKey:function(n){var r=ft(this).next(n).value;return r&&G(r.from,n)<=0&&0<=G(r.to,n)}})[Tt]=function(){return ft(this)},ze));var rn={},ar={},sr=!1;function dt(n){ht(ar,n),sr||(sr=!0,setTimeout(function(){sr=!1,cr(ar,!(ar={}))},0))}function cr(n,r){r===void 0&&(r=!1);var o=new Set;if(n.all)for(var u=0,s=Object.values(rn);u<s.length;u++)fo(f=s[u],n,o,r);else for(var c in n){var f,h=/^idb\:\/\/(.*)\/(.*)\//.exec(c);h&&(c=h[1],h=h[2],(f=rn["idb://".concat(c,"/").concat(h)])&&fo(f,n,o,r))}o.forEach(function(v){return v()})}function fo(n,r,o,u){for(var s=[],c=0,f=Object.entries(n.queries.query);c<f.length;c++){for(var h=f[c],v=h[0],g=[],_=0,d=h[1];_<d.length;_++){var x=d[_];ur(r,x.obsSet)?x.subscribers.forEach(function(w){return o.add(w)}):u&&g.push(x)}u&&s.push([v,g])}if(u)for(var y=0,b=s;y<b.length;y++){var k=b[y],v=k[0],g=k[1];n.queries.query[v]=g}}function Bi(n){var r=n._state,o=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?le(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var u=r.openCanceller,s=Math.round(10*n.verno),c=!1;function f(){if(r.openCanceller!==u)throw new q.DatabaseClosed("db.open() was cancelled")}function h(){return new K(function(x,y){if(f(),!o)throw new q.MissingAPI;var b=n.name,k=r.autoSchema||!s?o.open(b):o.open(b,s);if(!k)throw new q.MissingAPI;k.onerror=Se(y),k.onblocked=re(n._fireOnBlocked),k.onupgradeneeded=re(function(w){var z;_=k.transaction,r.autoSchema&&!n._options.allowEmptyDB?(k.onerror=jn,_.abort(),k.result.close(),(z=o.deleteDatabase(b)).onsuccess=z.onerror=re(function(){y(new q.NoSuchDatabase("Database ".concat(b," doesnt exist")))})):(_.onerror=Se(y),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,d=w<1,n.idbdb=k.result,c&&Ni(n,_),Ki(n,w/10,_,y))},y),k.onsuccess=re(function(){_=null;var w,z,E,P,S,A=n.idbdb=k.result,j=an(A.objectStoreNames);if(0<j.length)try{var $=A.transaction((P=j).length===1?P[0]:P,"readonly");if(r.autoSchema)z=A,E=$,(w=n).verno=z.version/10,E=w._dbSchema=ct(0,z,E),w._storeNames=an(z.objectStoreNames,0),at(w,[w._allTables],p(E),E);else if(lt(n,n._dbSchema,$),((S=er(ct(0,(S=n).idbdb,$),S._dbSchema)).add.length||S.change.some(function(T){return T.add.length||T.change.length}))&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),A.close(),s=A.version+1,c=!0,x(h());ut(n,$)}catch{}pn.push(n),A.onversionchange=re(function(T){r.vcFired=!0,n.on("versionchange").fire(T)}),A.onclose=re(function(T){n.on("close").fire(T)}),d&&(S=n._deps,$=b,A=S.indexedDB,S=S.IDBKeyRange,rr(A)||$===et||tr(A,S).put({name:$}).catch(H)),x()},y)}).catch(function(x){switch(x?.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),h();break;case"VersionError":if(0<s)return s=0,h()}return K.reject(x)})}var v,g=r.dbReadyResolve,_=null,d=!1;return K.race([u,(typeof navigator>"u"?K.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(x){function y(){return indexedDB.databases().finally(x)}v=setInterval(y,100),y()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(h)]).then(function(){return f(),r.onReadyBeingFired=[],K.resolve(or(function(){return n.on.ready.fire(n.vip)})).then(function x(){if(0<r.onReadyBeingFired.length){var y=r.onReadyBeingFired.reduce(Dt,H);return r.onReadyBeingFired=[],K.resolve(or(function(){return y(n.vip)})).then(x)}})}).finally(function(){r.openCanceller===u&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(x){r.dbOpenError=x;try{_&&_.abort()}catch{}return u===r.openCanceller&&n._close(),le(x)}).finally(function(){r.openComplete=!0,g()}).then(function(){var x;return d&&(x={},n.tables.forEach(function(y){y.schema.indexes.forEach(function(b){b.name&&(x["idb://".concat(n.name,"/").concat(y.name,"/").concat(b.name)]=new me(-1/0,[[[]]]))}),x["idb://".concat(n.name,"/").concat(y.name,"/")]=x["idb://".concat(n.name,"/").concat(y.name,"/:dels")]=new me(-1/0,[[[]]])}),Be(Cn).fire(x),cr(x,!0)),n})}function lr(n){function r(c){return n.next(c)}var o=s(r),u=s(function(c){return n.throw(c)});function s(c){return function(v){var h=c(v),v=h.value;return h.done?v:v&&typeof v.then=="function"?v.then(o,u):O(v)?Promise.all(v).then(o,u):o(v)}}return s(r)()}function pt(n,r,o){for(var u=O(n)?n.slice():[n],s=0;s<o;++s)u.push(r);return u}var qi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(r){var o=n.table(r),u=o.schema,s={},c=[];function f(d,x,y){var b=Rn(d),k=s[b]=s[b]||[],w=d==null?0:typeof d=="string"?1:d.length,z=0<x,z=a(a({},y),{name:z?"".concat(b,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:z,keyTail:x,keyLength:w,extractKey:Qt(d),unique:!z&&y.unique});return k.push(z),z.isPrimaryKey||c.push(z),1<w&&f(w===2?d[0]:d.slice(0,w-1),x+1,y),k.sort(function(E,P){return E.keyTail-P.keyTail}),z}r=f(u.primaryKey.keyPath,0,u.primaryKey),s[":id"]=[r];for(var h=0,v=u.indexes;h<v.length;h++){var g=v[h];f(g.keyPath,0,g)}function _(d){var x,y=d.query.index;return y.isVirtual?a(a({},d),{query:{index:y.lowLevelIndex,range:(x=d.query.range,y=y.keyTail,{type:x.type===1?2:x.type,lower:pt(x.lower,x.lowerOpen?n.MAX_KEY:n.MIN_KEY,y),lowerOpen:!0,upper:pt(x.upper,x.upperOpen?n.MIN_KEY:n.MAX_KEY,y),upperOpen:!0})}}):d}return a(a({},o),{schema:a(a({},u),{primaryKey:r,indexes:c,getIndexByKeyPath:function(d){return(d=s[Rn(d)])&&d[0]}}),count:function(d){return o.count(_(d))},query:function(d){return o.query(_(d))},openCursor:function(d){var x=d.query.index,y=x.keyTail,b=x.isVirtual,k=x.keyLength;return b?o.openCursor(_(d)).then(function(z){return z&&w(z)}):o.openCursor(d);function w(z){return Object.create(z,{continue:{value:function(E){E!=null?z.continue(pt(E,d.reverse?n.MAX_KEY:n.MIN_KEY,y)):d.unique?z.continue(z.key.slice(0,k).concat(d.reverse?n.MIN_KEY:n.MAX_KEY,y)):z.continue()}},continuePrimaryKey:{value:function(E,P){z.continuePrimaryKey(pt(E,n.MAX_KEY,y),P)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var E=z.key;return k===1?E[0]:E.slice(0,k)}},value:{get:function(){return z.value}}})}}})}})}};function fr(n,r,o,u){return o=o||{},u=u||"",p(n).forEach(function(s){var c,f,h;L(r,s)?(c=n[s],f=r[s],typeof c=="object"&&typeof f=="object"&&c&&f?(h=$t(c))!==$t(f)?o[u+s]=r[s]:h==="Object"?fr(c,f,o,u+s+"."):c!==f&&(o[u+s]=r[s]):c!==f&&(o[u+s]=r[s])):o[u+s]=void 0}),p(r).forEach(function(s){L(n,s)||(o[u+s]=r[s])}),o}function hr(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var Mi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(r){var o=n.table(r),u=o.schema.primaryKey;return a(a({},o),{mutate:function(s){var c=F.trans,f=c.table(r).hook,h=f.deleting,v=f.creating,g=f.updating;switch(s.type){case"add":if(v.fire===H)break;return c._promise("readwrite",function(){return _(s)},!0);case"put":if(v.fire===H&&g.fire===H)break;return c._promise("readwrite",function(){return _(s)},!0);case"delete":if(h.fire===H)break;return c._promise("readwrite",function(){return _(s)},!0);case"deleteRange":if(h.fire===H)break;return c._promise("readwrite",function(){return function d(x,y,b){return o.query({trans:x,values:!1,query:{index:u,range:y},limit:b}).then(function(k){var w=k.result;return _({type:"delete",keys:w,trans:x}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):w.length<b?{failures:[],numFailures:0,lastResult:void 0}:d(x,a(a({},y),{lower:w[w.length-1],lowerOpen:!0}),b)})})}(s.trans,s.range,1e4)},!0)}return o.mutate(s);function _(d){var x,y,b,k=F.trans,w=d.keys||hr(u,d);if(!w)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?a(a({},d),{keys:w}):a({},d)).type!=="delete"&&(d.values=l([],d.values,!0)),d.keys&&(d.keys=l([],d.keys,!0)),x=o,b=w,((y=d).type==="add"?Promise.resolve([]):x.getMany({trans:y.trans,keys:b,cache:"immutable"})).then(function(z){var E=w.map(function(P,S){var A,j,$,T=z[S],R={onerror:null,onsuccess:null};return d.type==="delete"?h.fire.call(R,P,T,k):d.type==="add"||T===void 0?(A=v.fire.call(R,P,d.values[S],k),P==null&&A!=null&&(d.keys[S]=P=A,u.outbound||we(d.values[S],u.keyPath,P))):(A=fr(T,d.values[S]),(j=g.fire.call(R,A,P,T,k))&&($=d.values[S],Object.keys(j).forEach(function(C){L($,C)?$[C]=j[C]:we($,C,j[C])}))),R});return o.mutate(d).then(function(P){for(var S=P.failures,A=P.results,j=P.numFailures,P=P.lastResult,$=0;$<w.length;++$){var T=(A||w)[$],R=E[$];T==null?R.onerror&&R.onerror(S[$]):R.onsuccess&&R.onsuccess(d.type==="put"&&z[$]?d.values[$]:T)}return{failures:S,results:A,numFailures:j,lastResult:P}}).catch(function(P){return E.forEach(function(S){return S.onerror&&S.onerror(P)}),Promise.reject(P)})})}}})}})}};function ho(n,r,o){try{if(!r||r.keys.length<n.length)return null;for(var u=[],s=0,c=0;s<r.keys.length&&c<n.length;++s)G(r.keys[s],n[c])===0&&(u.push(o?We(r.values[s]):r.values[s]),++c);return u.length===n.length?u:null}catch{return null}}var Ui={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var o=n.table(r);return a(a({},o),{getMany:function(u){if(!u.cache)return o.getMany(u);var s=ho(u.keys,u.trans._cache,u.cache==="clone");return s?K.resolve(s):o.getMany(u).then(function(c){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?We(c):c},c})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function po(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function mo(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Li={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,o=new me(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,s,c){if(F.subscr&&s!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(F.querier));return n.transaction(u,s,c)},table:function(u){var s=n.table(u),c=s.schema,f=c.primaryKey,d=c.indexes,h=f.extractKey,v=f.outbound,g=f.autoIncrement&&d.filter(function(y){return y.compound&&y.keyPath.includes(f.keyPath)}),_=a(a({},s),{mutate:function(y){function b(C){return C="idb://".concat(r,"/").concat(u,"/").concat(C),P[C]||(P[C]=new me)}var k,w,z,E=y.trans,P=y.mutatedParts||(y.mutatedParts={}),S=b(""),A=b(":dels"),j=y.type,R=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[hr(f,y).filter(function(C){return C}),y.values]:[],$=R[0],T=R[1],R=y.trans._cache;return O($)?(S.addKeys($),(R=j==="delete"||$.length===T.length?ho($,R):null)||A.addKeys($),(R||T)&&(k=b,w=R,z=T,c.indexes.forEach(function(C){var N=k(C.name||"");function V(U){return U!=null?C.extractKey(U):null}function J(U){return C.multiEntry&&O(U)?U.forEach(function(se){return N.addKey(se)}):N.addKey(U)}(w||z).forEach(function(U,ve){var M=w&&V(w[ve]),ve=z&&V(z[ve]);G(M,ve)!==0&&(M!=null&&J(M),ve!=null&&J(ve))})}))):$?(T={from:(T=$.lower)!==null&&T!==void 0?T:n.MIN_KEY,to:(T=$.upper)!==null&&T!==void 0?T:n.MAX_KEY},A.add(T),S.add(T)):(S.add(o),A.add(o),c.indexes.forEach(function(C){return b(C.name).add(o)})),s.mutate(y).then(function(C){return!$||y.type!=="add"&&y.type!=="put"||(S.addKeys(C.results),g&&g.forEach(function(N){for(var V=y.values.map(function(M){return N.extractKey(M)}),J=N.keyPath.findIndex(function(M){return M===f.keyPath}),U=0,se=C.results.length;U<se;++U)V[U][J]=C.results[U];b(N.name).addKeys(V)})),E.mutatedParts=ht(E.mutatedParts||{},P),C})}}),d=function(b){var k=b.query,b=k.index,k=k.range;return[b,new me((b=k.lower)!==null&&b!==void 0?b:n.MIN_KEY,(k=k.upper)!==null&&k!==void 0?k:n.MAX_KEY)]},x={get:function(y){return[f,new me(y.key)]},getMany:function(y){return[f,new me().addKeys(y.keys)]},count:d,query:d,openCursor:d};return p(x).forEach(function(y){_[y]=function(b){var k=F.subscr,w=!!k,z=po(F,s)&&mo(y,b)?b.obsSet={}:k;if(w){var E=function(T){return T="idb://".concat(r,"/").concat(u,"/").concat(T),z[T]||(z[T]=new me)},P=E(""),S=E(":dels"),k=x[y](b),w=k[0],k=k[1];if((y==="query"&&w.isPrimaryKey&&!b.values?S:E(w.name||"")).add(k),!w.isPrimaryKey){if(y!=="count"){var A=y==="query"&&v&&b.values&&s.query(a(a({},b),{values:!1}));return s[y].apply(this,arguments).then(function(T){if(y==="query"){if(v&&b.values)return A.then(function(V){return V=V.result,P.addKeys(V),T});var R=b.values?T.result.map(h):T.result;(b.values?P:S).addKeys(R)}else if(y==="openCursor"){var C=T,N=b.values;return C&&Object.create(C,{key:{get:function(){return S.addKey(C.primaryKey),C.key}},primaryKey:{get:function(){var V=C.primaryKey;return S.addKey(V),V}},value:{get:function(){return N&&P.addKey(C.primaryKey),C.value}}})}return T})}S.add(o)}}return s[y].apply(this,arguments)}}),_}})}};function vo(n,r,o){if(o.numFailures===0)return r;if(r.type==="deleteRange")return null;var u=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return o.numFailures===u?null:(r=a({},r),O(r.keys)&&(r.keys=r.keys.filter(function(s,c){return!(c in o.failures)})),"values"in r&&O(r.values)&&(r.values=r.values.filter(function(s,c){return!(c in o.failures)})),r)}function dr(n,r){return o=n,((u=r).lower===void 0||(u.lowerOpen?0<G(o,u.lower):0<=G(o,u.lower)))&&(n=n,(r=r).upper===void 0||(r.upperOpen?G(n,r.upper)<0:G(n,r.upper)<=0));var o,u}function yo(n,r,x,u,s,c){if(!x||x.length===0)return n;var f=r.query.index,h=f.multiEntry,v=r.query.range,g=u.schema.primaryKey.extractKey,_=f.extractKey,d=(f.lowLevelIndex||f).extractKey,x=x.reduce(function(y,b){var k=y,w=[];if(b.type==="add"||b.type==="put")for(var z=new me,E=b.values.length-1;0<=E;--E){var P,S=b.values[E],A=g(S);z.hasKey(A)||(P=_(S),(h&&O(P)?P.some(function(C){return dr(C,v)}):dr(P,v))&&(z.addKey(A),w.push(S)))}switch(b.type){case"add":var j=new me().addKeys(r.values?y.map(function(N){return g(N)}):y),k=y.concat(r.values?w.filter(function(N){return N=g(N),!j.hasKey(N)&&(j.addKey(N),!0)}):w.map(function(N){return g(N)}).filter(function(N){return!j.hasKey(N)&&(j.addKey(N),!0)}));break;case"put":var $=new me().addKeys(b.values.map(function(N){return g(N)}));k=y.filter(function(N){return!$.hasKey(r.values?g(N):N)}).concat(r.values?w:w.map(function(N){return g(N)}));break;case"delete":var T=new me().addKeys(b.keys);k=y.filter(function(N){return!T.hasKey(r.values?g(N):N)});break;case"deleteRange":var R=b.range;k=y.filter(function(N){return!dr(g(N),R)})}return k},n);return x===n?n:(x.sort(function(y,b){return G(d(y),d(b))||G(g(y),g(b))}),r.limit&&r.limit<1/0&&(x.length>r.limit?x.length=r.limit:n.length===r.limit&&x.length<r.limit&&(s.dirty=!0)),c?Object.freeze(x):x)}function go(n,r){return G(n.lower,r.lower)===0&&G(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function Vi(n,r){return function(o,u,s,c){if(o===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((u=G(o,u))===0){if(s&&c)return 0;if(s)return 1;if(c)return-1}return u}(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&0<=function(o,u,s,c){if(o===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((u=G(o,u))===0){if(s&&c)return 0;if(s)return-1;if(c)return 1}return u}(n.upper,r.upper,n.upperOpen,r.upperOpen)}function Wi(n,r,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){var s,c;n.subscribers.delete(o),n.subscribers.size===0&&(s=n,c=r,setTimeout(function(){s.subscribers.size===0&&Ye(c,s)},3e3))})}var Yi={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name;return a(a({},n),{transaction:function(o,u,s){var c,f,h=n.transaction(o,u,s);return u==="readwrite"&&(f=(c=new AbortController).signal,s=function(v){return function(){if(c.abort(),u==="readwrite"){for(var g=new Set,_=0,d=o;_<d.length;_++){var x=d[_],y=rn["idb://".concat(r,"/").concat(x)];if(y){var b=n.table(x),k=y.optimisticOps.filter(function(N){return N.trans===h});if(h._explicit&&v&&h.mutatedParts)for(var w=0,z=Object.values(y.queries.query);w<z.length;w++)for(var E=0,P=(j=z[w]).slice();E<P.length;E++)ur(($=P[E]).obsSet,h.mutatedParts)&&(Ye(j,$),$.subscribers.forEach(function(N){return g.add(N)}));else if(0<k.length){y.optimisticOps=y.optimisticOps.filter(function(N){return N.trans!==h});for(var S=0,A=Object.values(y.queries.query);S<A.length;S++)for(var j,$,T,R=0,C=(j=A[S]).slice();R<C.length;R++)($=C[R]).res!=null&&h.mutatedParts&&(v&&!$.dirty?(T=Object.isFrozen($.res),T=yo($.res,$.req,k,b,$,T),$.dirty?(Ye(j,$),$.subscribers.forEach(function(N){return g.add(N)})):T!==$.res&&($.res=T,$.promise=K.resolve({result:T}))):($.dirty&&Ye(j,$),$.subscribers.forEach(function(N){return g.add(N)})))}}}g.forEach(function(N){return N()})}}},h.addEventListener("abort",s(!1),{signal:f}),h.addEventListener("error",s(!1),{signal:f}),h.addEventListener("complete",s(!0),{signal:f})),h},table:function(o){var u=n.table(o),s=u.schema.primaryKey;return a(a({},u),{mutate:function(c){var f=F.trans;if(s.outbound||f.db._options.cache==="disabled"||f.explicit||f.idbtrans.mode!=="readwrite")return u.mutate(c);var h=rn["idb://".concat(r,"/").concat(o)];return h?(f=u.mutate(c),c.type!=="add"&&c.type!=="put"||!(50<=c.values.length||hr(s,c).some(function(v){return v==null}))?(h.optimisticOps.push(c),c.mutatedParts&&dt(c.mutatedParts),f.then(function(v){0<v.numFailures&&(Ye(h.optimisticOps,c),(v=vo(0,c,v))&&h.optimisticOps.push(v),c.mutatedParts&&dt(c.mutatedParts))}),f.catch(function(){Ye(h.optimisticOps,c),c.mutatedParts&&dt(c.mutatedParts)})):f.then(function(v){var g=vo(0,a(a({},c),{values:c.values.map(function(_,d){var x;return v.failures[d]?_:(_=(x=s.keyPath)!==null&&x!==void 0&&x.includes(".")?We(_):a({},_),we(_,s.keyPath,v.results[d]),_)})}),v);h.optimisticOps.push(g),queueMicrotask(function(){return c.mutatedParts&&dt(c.mutatedParts)})}),f):u.mutate(c)},query:function(c){if(!po(F,u)||!mo("query",c))return u.query(c);var f=((g=F.trans)===null||g===void 0?void 0:g.db._options.cache)==="immutable",d=F,h=d.requery,v=d.signal,g=function(b,k,w,z){var E=rn["idb://".concat(b,"/").concat(k)];if(!E)return[];if(!(k=E.queries[w]))return[null,!1,E,null];var P=k[(z.query?z.query.index.name:null)||""];if(!P)return[null,!1,E,null];switch(w){case"query":var S=P.find(function(A){return A.req.limit===z.limit&&A.req.values===z.values&&go(A.req.query.range,z.query.range)});return S?[S,!0,E,P]:[P.find(function(A){return("limit"in A.req?A.req.limit:1/0)>=z.limit&&(!z.values||A.req.values)&&Vi(A.req.query.range,z.query.range)}),!1,E,P];case"count":return S=P.find(function(A){return go(A.req.query.range,z.query.range)}),[S,!!S,E,P]}}(r,o,"query",c),_=g[0],d=g[1],x=g[2],y=g[3];return _&&d?_.obsSet=c.obsSet:(d=u.query(c).then(function(b){var k=b.result;if(_&&(_.res=k),f){for(var w=0,z=k.length;w<z;++w)Object.freeze(k[w]);Object.freeze(k)}else b.result=We(k);return b}).catch(function(b){return y&&_&&Ye(y,_),Promise.reject(b)}),_={obsSet:c.obsSet,promise:d,subscribers:new Set,type:"query",req:c,dirty:!1},y?y.push(_):(y=[_],(x=x||(rn["idb://".concat(r,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[c.query.index.name||""]=y)),Wi(_,y,h,v),_.promise.then(function(b){return{result:yo(b.result,c,x?.optimisticOps,u,_,f)}})}})}})}};function mt(n,r){return new Proxy(n,{get:function(o,u,s){return u==="db"?r:Reflect.get(o,u,s)}})}var je=(fe.prototype.version=function(n){if(isNaN(n)||n<.1)throw new q.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var r=this._versions,o=r.filter(function(u){return u._cfg.version===n})[0];return o||(o=new this.Version(n),r.push(o),r.sort(Ri),o.stores({}),this._state.autoSchema=!1,o)},fe.prototype._whenReady=function(n){var r=this;return this.idbdb&&(this._state.openComplete||F.letThrough||this._vip)?n():new K(function(o,u){if(r._state.openComplete)return u(new q.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void u(new q.DatabaseClosed);r.open().catch(H)}r._state.dbReadyPromise.then(o,u)}).then(n)},fe.prototype.use=function(n){var r=n.stack,o=n.create,u=n.level,s=n.name;return s&&this.unuse({stack:r,name:s}),n=this._middlewares[r]||(this._middlewares[r]=[]),n.push({stack:r,create:o,level:u??10,name:s}),n.sort(function(c,f){return c.level-f.level}),this},fe.prototype.unuse=function(n){var r=n.stack,o=n.name,u=n.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(s){return u?s.create!==u:!!o&&s.name!==o})),this},fe.prototype.open=function(){var n=this;return en(De,function(){return Bi(n)})},fe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,r=pn.indexOf(this);if(0<=r&&pn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new K(function(o){n.dbReadyResolve=o}),n.openCanceller=new K(function(o,u){n.cancelOpen=u}))},fe.prototype.close=function(o){var r=(o===void 0?{disableAutoOpen:!0}:o).disableAutoOpen,o=this._state;r?(o.isBeingOpened&&o.cancelOpen(new q.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new q.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},fe.prototype.delete=function(n){var r=this;n===void 0&&(n={disableAutoOpen:!0});var o=0<arguments.length&&typeof arguments[0]!="object",u=this._state;return new K(function(s,c){function f(){r.close(n);var h=r._deps.indexedDB.deleteDatabase(r.name);h.onsuccess=re(function(){var v,g,_;v=r._deps,g=r.name,_=v.indexedDB,v=v.IDBKeyRange,rr(_)||g===et||tr(_,v).delete(g).catch(H),s()}),h.onerror=Se(c),h.onblocked=r._fireOnBlocked}if(o)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(f):f()})},fe.prototype.backendDB=function(){return this.idbdb},fe.prototype.isOpen=function(){return this.idbdb!==null},fe.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},fe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},fe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(fe.prototype,"tables",{get:function(){var n=this;return p(this._allTables).map(function(r){return n._allTables[r]})},enumerable:!1,configurable:!0}),fe.prototype.transaction=function(){var n=function(r,o,u){var s=arguments.length;if(s<2)throw new q.InvalidArgument("Too few arguments");for(var c=new Array(s-1);--s;)c[s-1]=arguments[s];return u=c.pop(),[r,Dr(c),u]}.apply(this,arguments);return this._transaction.apply(this,n)},fe.prototype._transaction=function(n,r,o){var u=this,s=F.trans;s&&s.db===this&&n.indexOf("!")===-1||(s=null);var c,f,h=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(f=r.map(function(g){if(g=g instanceof u.Table?g.name:g,typeof g!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return g}),n=="r"||n===Lt)c=Lt;else{if(n!="rw"&&n!=Vt)throw new q.InvalidArgument("Invalid transaction mode: "+n);c=Vt}if(s){if(s.mode===Lt&&c===Vt){if(!h)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&f.forEach(function(g){if(s&&s.storeNames.indexOf(g)===-1){if(!h)throw new q.SubTransaction("Table "+g+" not included in parent transaction.");s=null}}),h&&s&&!s.active&&(s=null)}}catch(g){return s?s._promise(null,function(_,d){d(g)}):le(g)}var v=function g(_,d,x,y,b){return K.resolve().then(function(){var k=F.transless||F,w=_._createTransaction(d,x,_._dbSchema,y);if(w.explicit=!0,k={trans:w,transless:k},y)w.idbtrans=y.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(P){return P.name===Ct.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return g(_,d,x,null,b)})):le(P)}var z,E=jt(b);return E&&dn(),k=K.follow(function(){var P;(z=b.call(w,w))&&(E?(P=Ke.bind(null,null),z.then(P,P)):typeof z.next=="function"&&typeof z.throw=="function"&&(z=lr(z)))},k),(z&&typeof z.then=="function"?K.resolve(z).then(function(P){return w.active?P:le(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):k.then(function(){return z})).then(function(P){return y&&w._resolve(),w._completion.then(function(){return P})}).catch(function(P){return w._reject(P),le(P)})})}.bind(null,this,c,f,s,o);return s?s._promise(c,v,"lock"):F.trans?en(F.transless,function(){return u._whenReady(v)}):this._whenReady(v)},fe.prototype.table=function(n){if(!L(this._allTables,n))throw new q.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},fe);function fe(n,r){var o=this;this._middlewares={},this.verno=0;var u=fe.dependencies;this._options=r=a({addons:fe.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},u=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,c,f,h,v,g={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:H,dbReadyPromise:null,cancelOpen:H,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};g.dbReadyPromise=new K(function(d){g.dbReadyResolve=d}),g.openCanceller=new K(function(d,x){g.cancelOpen=x}),this._state=g,this.name=n,this.on=Zn(this,"populate","blocked","versionchange","close",{ready:[Dt,H]}),this.once=function(d,x){var y=function(){for(var b=[],k=0;k<arguments.length;k++)b[k]=arguments[k];o.on(d).unsubscribe(y),x.apply(o,b)};return o.on(d,y)},this.on.ready.subscribe=xe(this.on.ready.subscribe,function(d){return function(x,y){fe.vip(function(){var b,k=o._state;k.openComplete?(k.dbOpenError||K.resolve().then(x),y&&d(x)):k.onReadyBeingFired?(k.onReadyBeingFired.push(x),y&&d(x)):(d(x),b=o,y||d(function w(){b.on.ready.unsubscribe(x),b.on.ready.unsubscribe(w)}))})}}),this.Collection=(s=this,$n(Ai.prototype,function(z,w){this.db=s;var y=Wr,b=null;if(w)try{y=w()}catch(E){b=E}var k=z._ctx,w=k.table,z=w.hook.reading.fire;this._ctx={table:w,index:k.index,isPrimKey:!k.index||w.schema.primKey.keyPath&&k.index===w.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:b,or:k.or,valueMapper:z!==On?z:null}})),this.Table=(c=this,$n(Xr.prototype,function(d,x,y){this.db=c,this._tx=y,this.name=d,this.schema=x,this.hook=c._allTables[d]?c._allTables[d].hook:Zn(null,{creating:[wi,H],reading:[_i,On],updating:[xi,H],deleting:[ki,H]})})),this.Transaction=(f=this,$n(Ti.prototype,function(d,x,y,b,k){var w=this;d!=="readonly"&&x.forEach(function(z){z=(z=y[z])===null||z===void 0?void 0:z.yProps,z&&(x=x.concat(z.map(function(E){return E.updatesTable})))}),this.db=f,this.mode=d,this.storeNames=x,this.schema=y,this.chromeTransactionDurability=b,this.idbtrans=null,this.on=Zn(this,"complete","error","abort"),this.parent=k||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(z,E){w._resolve=z,w._reject=E}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(z){var E=w.active;return w.active=!1,w.on.error.fire(z),w.parent?w.parent._reject(z):E&&w.idbtrans&&w.idbtrans.abort(),le(z)})})),this.Version=(h=this,$n(Fi.prototype,function(d){this.db=h,this._cfg={version:d,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,$n(ro.prototype,function(d,x,y){if(this.db=v,this._ctx={table:d,index:x===":id"?null:x,or:y},this._cmp=this._ascending=G,this._descending=function(b,k){return G(k,b)},this._max=function(b,k){return 0<G(b,k)?b:k},this._min=function(b,k){return G(b,k)<0?b:k},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})),this.on("versionchange",function(d){0<d.newVersion?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(d){!d.newVersion||d.newVersion<d.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(d.oldVersion/10))}),this._maxKey=Dn(r.IDBKeyRange),this._createTransaction=function(d,x,y,b){return new o.Transaction(d,x,y,o._options.chromeTransactionDurability,b)},this._fireOnBlocked=function(d){o.on("blocked").fire(d),pn.filter(function(x){return x.name===o.name&&x!==o&&!x._state.vcFired}).map(function(x){return x.on("versionchange").fire(d)})},this.use(Ui),this.use(Yi),this.use(Li),this.use(qi),this.use(Mi);var _=new Proxy(this,{get:function(d,x,y){if(x==="_vip")return!0;if(x==="table")return function(k){return mt(o.table(k),_)};var b=Reflect.get(d,x,y);return b instanceof Xr?mt(b,_):x==="tables"?b.map(function(k){return mt(k,_)}):x==="_createTransaction"?function(){return mt(b.apply(this,arguments),_)}:b}});this.vip=_,u.forEach(function(d){return d(o)})}var vt,ze=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Gi=(pr.prototype.subscribe=function(n,r,o){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:r,complete:o})},pr.prototype[ze]=function(){return this},pr);function pr(n){this._subscribe=n}try{vt={indexedDB:m.indexedDB||m.mozIndexedDB||m.webkitIndexedDB||m.msIndexedDB,IDBKeyRange:m.IDBKeyRange||m.webkitIDBKeyRange}}catch{vt={indexedDB:null,IDBKeyRange:null}}function bo(n){var r,o=!1,u=new Gi(function(s){var c=jt(n),f,h=!1,v={},g={},_={get closed(){return h},unsubscribe:function(){h||(h=!0,f&&f.abort(),d&&Be.storagemutated.unsubscribe(y))}};s.start&&s.start(_);var d=!1,x=function(){return Ut(b)},y=function(k){ht(v,k),ur(g,v)&&x()},b=function(){var k,w,z;!h&&vt.indexedDB&&(v={},k={},f&&f.abort(),f=new AbortController,z=function(E){var P=fn();try{c&&dn();var S=Re(n,E);return S=c?S.finally(Ke):S}finally{P&&hn()}}(w={subscr:k,signal:f.signal,requery:x,querier:n,trans:null}),Promise.resolve(z).then(function(E){o=!0,r=E,h||w.signal.aborted||(v={},function(P){for(var S in P)if(L(P,S))return;return 1}(g=k)||d||(Be(Cn,y),d=!0),Ut(function(){return!h&&s.next&&s.next(E)}))},function(E){o=!1,["DatabaseClosedError","AbortError"].includes(E?.name)||h||Ut(function(){h||s.error&&s.error(E)})}))};return setTimeout(x,0),_});return u.hasValue=function(){return o},u.getValue=function(){return r},u}var on=je;function mr(n){var r=qe;try{qe=!0,Be.storagemutated.fire(n),cr(n,!0)}finally{qe=r}}Q(on,a(a({},Ln),{delete:function(n){return new on(n,{addons:[]}).delete()},exists:function(n){return new on(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return r=on.dependencies,o=r.indexedDB,r=r.IDBKeyRange,(rr(o)?Promise.resolve(o.databases()).then(function(u){return u.map(function(s){return s.name}).filter(function(s){return s!==et})}):tr(o,r).toCollection().primaryKeys()).then(n)}catch{return le(new q.MissingAPI)}var r,o},defineClass:function(){return function(n){Z(this,n)}},ignoreTransaction:function(n){return F.trans?en(F.transless,n):n()},vip:or,async:function(n){return function(){try{var r=lr(n.apply(this,arguments));return r&&typeof r.then=="function"?r:K.resolve(r)}catch(o){return le(o)}}},spawn:function(n,r,o){try{var u=lr(n.apply(o,r||[]));return u&&typeof u.then=="function"?u:K.resolve(u)}catch(s){return le(s)}},currentTransaction:{get:function(){return F.trans||null}},waitFor:function(n,r){return r=K.resolve(typeof n=="function"?on.ignoreTransaction(n):n).timeout(r||6e4),F.trans?F.trans.waitFor(r):r},Promise:K,debug:{get:function(){return Pe},set:function(n){Fr(n)}},derive:Oe,extend:Z,props:Q,override:xe,Events:Zn,on:Be,liveQuery:bo,extendObservabilitySet:ht,getByKeyPath:Ze,setByKeyPath:we,delByKeyPath:function(n,r){typeof r=="string"?we(n,r,void 0):"length"in r&&[].map.call(r,function(o){we(n,o,void 0)})},shallowClone:Cr,deepClone:We,getObjectDiff:fr,cmp:G,asap:Ce,minKey:-1/0,addons:[],connections:pn,errnames:Ct,dependencies:vt,cache:rn,semVer:"4.2.0",version:"4.2.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,o){return n+r/Math.pow(10,2*o)})})),on.maxKey=Dn(on.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Be(Cn,function(n){qe||(n=new CustomEvent(Gt,{detail:n}),qe=!0,dispatchEvent(n),qe=!1)}),addEventListener(Gt,function(n){n=n.detail,qe||mr(n)}));var gn,qe=!1,_o=function(){};return typeof BroadcastChannel<"u"&&((_o=function(){(gn=new BroadcastChannel(Gt)).onmessage=function(n){return n.data&&mr(n.data)}})(),typeof gn.unref=="function"&&gn.unref(),Be(Cn,function(n){qe||gn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!je.disableBfCache&&n.persisted){Pe&&console.debug("Dexie: handling persisted pagehide"),gn?.close();for(var r=0,o=pn;r<o.length;r++)o[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!je.disableBfCache&&n.persisted&&(Pe&&console.debug("Dexie: handling persisted pageshow"),_o(),mr({all:new me(-1/0,[[]])}))})),K.rejectionMapper=function(n,r){return!n||n instanceof cn||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Nr[n.name]?n:(r=new Nr[n.name](r||n.message,n),"stack"in n&&ee(r,"stack",{get:function(){return this.inner.stack}}),r)},Fr(Pe),a(je,Object.freeze({__proto__:null,Dexie:je,liveQuery:bo,Entity:Yr,cmp:G,PropModification:Tn,replacePrefix:function(n,r){return new Tn({replacePrefix:[n,r]})},add:function(n){return new Tn({add:n})},remove:function(n){return new Tn({remove:n})},default:je,RangeSet:me,mergeRanges:Nn,rangesOverlap:so}),{default:je}),je})})(Mo);var ou=Mo.exports;const br=Qi(ou),ko=Symbol.for("Dexie"),_r=globalThis[ko]||(globalThis[ko]=br);if(br.semVer!==_r.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${br.semVer} and ${_r.semVer}`);class iu extends _r{constructor(){super("draconia_v1");gt(this,"saves");gt(this,"meta");gt(this,"logs");this.version(1).stores({saves:"++id, profileId, version, createdAt",meta:"key",logs:"++id, timestamp, level, source"})}}const Fn=new iu;function I(e,t,i){function a(O,Z){var D;Object.defineProperty(O,"_zod",{value:O._zod??{},enumerable:!1}),(D=O._zod).traits??(D.traits=new Set),O._zod.traits.add(e),t(O,Z);for(const W in p.prototype)W in O||Object.defineProperty(O,W,{value:p.prototype[W].bind(O)});O._zod.constr=p,O._zod.def=Z}const l=i?.Parent??Object;class m extends l{}Object.defineProperty(m,"name",{value:e});function p(O){var Z;const D=i?.Parent?new m:this;a(D,O),(Z=D._zod).deferred??(Z.deferred=[]);for(const W of D._zod.deferred)W();return D}return Object.defineProperty(p,"init",{value:a}),Object.defineProperty(p,Symbol.hasInstance,{value:O=>i?.Parent&&O instanceof i.Parent?!0:O?._zod?.traits?.has(e)}),Object.defineProperty(p,"name",{value:e}),p}class wn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Uo extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const wr={};function Me(e){return e&&Object.assign(wr,e),wr}function uu(e){const t=Object.values(e).filter(a=>typeof a=="number");return Object.entries(e).filter(([a,l])=>t.indexOf(+a)===-1).map(([a,l])=>l)}function kr(e,t){return typeof t=="bigint"?t.toString():t}function Pr(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Sr(e){return e==null}function Ir(e){const t=e.startsWith("^")?1:0,i=e.endsWith("$")?e.length-1:e.length;return e.slice(t,i)}function au(e,t){const i=(e.toString().split(".")[1]||"").length,a=t.toString();let l=(a.split(".")[1]||"").length;if(l===0&&/\d?e-\d?/.test(a)){const Z=a.match(/\d?e-(\d?)/);Z?.[1]&&(l=Number.parseInt(Z[1]))}const m=i>l?i:l,p=Number.parseInt(e.toFixed(m).replace(".","")),O=Number.parseInt(t.toFixed(m).replace(".",""));return p%O/10**m}const xo=Symbol("evaluating");function ne(e,t,i){let a;Object.defineProperty(e,t,{get(){if(a!==xo)return a===void 0&&(a=xo,a=i()),a},set(l){Object.defineProperty(e,t,{value:l})},configurable:!0})}function su(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function Le(e,t,i){Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!0,configurable:!0})}function zn(...e){const t={};for(const i of e){const a=Object.getOwnPropertyDescriptors(i);Object.assign(t,a)}return Object.defineProperties({},t)}function zo(e){return JSON.stringify(e)}const Lo="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function zt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const cu=Pr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function kn(e){if(zt(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const i=t.prototype;return!(zt(i)===!1||Object.prototype.hasOwnProperty.call(i,"isPrototypeOf")===!1)}function Vo(e){return kn(e)?{...e}:e}const lu=new Set(["string","number","symbol"]);function xn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ve(e,t,i){const a=new e._zod.constr(t??e._zod.def);return(!t||i?.parent)&&(a._zod.parent=e),a}function B(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function fu(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const hu={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function du(e,t){const i=e._zod.def,a=zn(e._zod.def,{get shape(){const l={};for(const m in t){if(!(m in i.shape))throw new Error(`Unrecognized key: "${m}"`);t[m]&&(l[m]=i.shape[m])}return Le(this,"shape",l),l},checks:[]});return Ve(e,a)}function pu(e,t){const i=e._zod.def,a=zn(e._zod.def,{get shape(){const l={...e._zod.def.shape};for(const m in t){if(!(m in i.shape))throw new Error(`Unrecognized key: "${m}"`);t[m]&&delete l[m]}return Le(this,"shape",l),l},checks:[]});return Ve(e,a)}function mu(e,t){if(!kn(t))throw new Error("Invalid input to extend: expected a plain object");const i=e._zod.def.checks;if(i&&i.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const l=zn(e._zod.def,{get shape(){const m={...e._zod.def.shape,...t};return Le(this,"shape",m),m},checks:[]});return Ve(e,l)}function vu(e,t){if(!kn(t))throw new Error("Invalid input to safeExtend: expected a plain object");const i={...e._zod.def,get shape(){const a={...e._zod.def.shape,...t};return Le(this,"shape",a),a},checks:e._zod.def.checks};return Ve(e,i)}function yu(e,t){const i=zn(e._zod.def,{get shape(){const a={...e._zod.def.shape,...t._zod.def.shape};return Le(this,"shape",a),a},get catchall(){return t._zod.def.catchall},checks:[]});return Ve(e,i)}function gu(e,t,i){const a=zn(t._zod.def,{get shape(){const l=t._zod.def.shape,m={...l};if(i)for(const p in i){if(!(p in l))throw new Error(`Unrecognized key: "${p}"`);i[p]&&(m[p]=e?new e({type:"optional",innerType:l[p]}):l[p])}else for(const p in l)m[p]=e?new e({type:"optional",innerType:l[p]}):l[p];return Le(this,"shape",m),m},checks:[]});return Ve(t,a)}function bu(e,t,i){const a=zn(t._zod.def,{get shape(){const l=t._zod.def.shape,m={...l};if(i)for(const p in i){if(!(p in m))throw new Error(`Unrecognized key: "${p}"`);i[p]&&(m[p]=new e({type:"nonoptional",innerType:l[p]}))}else for(const p in l)m[p]=new e({type:"nonoptional",innerType:l[p]});return Le(this,"shape",m),m},checks:[]});return Ve(t,a)}function bn(e,t=0){if(e.aborted===!0)return!0;for(let i=t;i<e.issues.length;i++)if(e.issues[i]?.continue!==!0)return!0;return!1}function _n(e,t){return t.map(i=>{var a;return(a=i).path??(a.path=[]),i.path.unshift(e),i})}function bt(e){return typeof e=="string"?e:e?.message}function Ue(e,t,i){const a={...e,path:e.path??[]};if(!e.message){const l=bt(e.inst?._zod.def?.error?.(e))??bt(t?.error?.(e))??bt(i.customError?.(e))??bt(i.localeError?.(e))??"Invalid input";a.message=l}return delete a.inst,delete a.continue,t?.reportInput||delete a.input,a}function Ar(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Bn(...e){const[t,i,a]=e;return typeof t=="string"?{message:t,code:"custom",input:i,inst:a}:{...t}}const Wo=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,kr,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Yo=I("$ZodError",Wo),Go=I("$ZodError",Wo,{Parent:Error});function _u(e,t=i=>i.message){const i={},a=[];for(const l of e.issues)l.path.length>0?(i[l.path[0]]=i[l.path[0]]||[],i[l.path[0]].push(t(l))):a.push(t(l));return{formErrors:a,fieldErrors:i}}function wu(e,t){const i=t||function(m){return m.message},a={_errors:[]},l=m=>{for(const p of m.issues)if(p.code==="invalid_union"&&p.errors.length)p.errors.map(O=>l({issues:O}));else if(p.code==="invalid_key")l({issues:p.issues});else if(p.code==="invalid_element")l({issues:p.issues});else if(p.path.length===0)a._errors.push(i(p));else{let O=a,Z=0;for(;Z<p.path.length;){const D=p.path[Z];Z===p.path.length-1?(O[D]=O[D]||{_errors:[]},O[D]._errors.push(i(p))):O[D]=O[D]||{_errors:[]},O=O[D],Z++}}};return l(e),a}const Zr=e=>(t,i,a,l)=>{const m=a?Object.assign(a,{async:!1}):{async:!1},p=t._zod.run({value:i,issues:[]},m);if(p instanceof Promise)throw new wn;if(p.issues.length){const O=new(l?.Err??e)(p.issues.map(Z=>Ue(Z,m,Me())));throw Lo(O,l?.callee),O}return p.value},$r=e=>async(t,i,a,l)=>{const m=a?Object.assign(a,{async:!0}):{async:!0};let p=t._zod.run({value:i,issues:[]},m);if(p instanceof Promise&&(p=await p),p.issues.length){const O=new(l?.Err??e)(p.issues.map(Z=>Ue(Z,m,Me())));throw Lo(O,l?.callee),O}return p.value},Pt=e=>(t,i,a)=>{const l=a?{...a,async:!1}:{async:!1},m=t._zod.run({value:i,issues:[]},l);if(m instanceof Promise)throw new wn;return m.issues.length?{success:!1,error:new(e??Yo)(m.issues.map(p=>Ue(p,l,Me())))}:{success:!0,data:m.value}},ku=Pt(Go),St=e=>async(t,i,a)=>{const l=a?Object.assign(a,{async:!0}):{async:!0};let m=t._zod.run({value:i,issues:[]},l);return m instanceof Promise&&(m=await m),m.issues.length?{success:!1,error:new e(m.issues.map(p=>Ue(p,l,Me())))}:{success:!0,data:m.value}},xu=St(Go),zu=e=>(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return Zr(e)(t,i,l)},Eu=e=>(t,i,a)=>Zr(e)(t,i,a),Ou=e=>async(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return $r(e)(t,i,l)},Pu=e=>async(t,i,a)=>$r(e)(t,i,a),Su=e=>(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return Pt(e)(t,i,l)},Iu=e=>(t,i,a)=>Pt(e)(t,i,a),Au=e=>async(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return St(e)(t,i,l)},Zu=e=>async(t,i,a)=>St(e)(t,i,a),$u=/^[cC][^\s-]{8,}$/,Tu=/^[0-9a-z]+$/,ju=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Cu=/^[0-9a-vA-V]{20}$/,Du=/^[A-Za-z0-9]{27}$/,Ru=/^[a-zA-Z0-9_-]{21}$/,Ku=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Nu=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Eo=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Fu=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Bu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function qu(){return new RegExp(Bu,"u")}const Mu=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Uu=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Lu=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Vu=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Wu=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Jo=/^[A-Za-z0-9_-]*$/,Yu=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Gu=/^\+(?:[0-9]){6,14}[0-9]$/,Xo="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Ju=new RegExp(`^${Xo}$`);function Qo(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Xu(e){return new RegExp(`^${Qo(e)}$`)}function Qu(e){const t=Qo({precision:e.precision}),i=["Z"];e.local&&i.push(""),e.offset&&i.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const a=`${t}(?:${i.join("|")})`;return new RegExp(`^${Xo}T(?:${a})$`)}const Hu=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},ea=/^\d+$/,na=/^-?\d+(?:\.\d+)?/i,ta=/true|false/i,ra=/^[^A-Z]*$/,oa=/^[^a-z]*$/,be=I("$ZodCheck",(e,t)=>{var i;e._zod??(e._zod={}),e._zod.def=t,(i=e._zod).onattach??(i.onattach=[])}),Ho={number:"number",bigint:"bigint",object:"date"},ei=I("$ZodCheckLessThan",(e,t)=>{be.init(e,t);const i=Ho[typeof t.value];e._zod.onattach.push(a=>{const l=a._zod.bag,m=(t.inclusive?l.maximum:l.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<m&&(t.inclusive?l.maximum=t.value:l.exclusiveMaximum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value<=t.value:a.value<t.value)||a.issues.push({origin:i,code:"too_big",maximum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ni=I("$ZodCheckGreaterThan",(e,t)=>{be.init(e,t);const i=Ho[typeof t.value];e._zod.onattach.push(a=>{const l=a._zod.bag,m=(t.inclusive?l.minimum:l.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>m&&(t.inclusive?l.minimum=t.value:l.exclusiveMinimum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value>=t.value:a.value>t.value)||a.issues.push({origin:i,code:"too_small",minimum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),ia=I("$ZodCheckMultipleOf",(e,t)=>{be.init(e,t),e._zod.onattach.push(i=>{var a;(a=i._zod.bag).multipleOf??(a.multipleOf=t.value)}),e._zod.check=i=>{if(typeof i.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof i.value=="bigint"?i.value%t.value===BigInt(0):au(i.value,t.value)===0)||i.issues.push({origin:typeof i.value,code:"not_multiple_of",divisor:t.value,input:i.value,inst:e,continue:!t.abort})}}),ua=I("$ZodCheckNumberFormat",(e,t)=>{be.init(e,t),t.format=t.format||"float64";const i=t.format?.includes("int"),a=i?"int":"number",[l,m]=hu[t.format];e._zod.onattach.push(p=>{const O=p._zod.bag;O.format=t.format,O.minimum=l,O.maximum=m,i&&(O.pattern=ea)}),e._zod.check=p=>{const O=p.value;if(i){if(!Number.isInteger(O)){p.issues.push({expected:a,format:t.format,code:"invalid_type",continue:!1,input:O,inst:e});return}if(!Number.isSafeInteger(O)){O>0?p.issues.push({input:O,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort}):p.issues.push({input:O,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort});return}}O<l&&p.issues.push({origin:"number",input:O,code:"too_small",minimum:l,inclusive:!0,inst:e,continue:!t.abort}),O>m&&p.issues.push({origin:"number",input:O,code:"too_big",maximum:m,inst:e})}}),aa=I("$ZodCheckMaxLength",(e,t)=>{var i;be.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Sr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<l&&(a._zod.bag.maximum=t.maximum)}),e._zod.check=a=>{const l=a.value;if(l.length<=t.maximum)return;const p=Ar(l);a.issues.push({origin:p,code:"too_big",maximum:t.maximum,inclusive:!0,input:l,inst:e,continue:!t.abort})}}),sa=I("$ZodCheckMinLength",(e,t)=>{var i;be.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Sr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>l&&(a._zod.bag.minimum=t.minimum)}),e._zod.check=a=>{const l=a.value;if(l.length>=t.minimum)return;const p=Ar(l);a.issues.push({origin:p,code:"too_small",minimum:t.minimum,inclusive:!0,input:l,inst:e,continue:!t.abort})}}),ca=I("$ZodCheckLengthEquals",(e,t)=>{var i;be.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Sr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag;l.minimum=t.length,l.maximum=t.length,l.length=t.length}),e._zod.check=a=>{const l=a.value,m=l.length;if(m===t.length)return;const p=Ar(l),O=m>t.length;a.issues.push({origin:p,...O?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:a.value,inst:e,continue:!t.abort})}}),It=I("$ZodCheckStringFormat",(e,t)=>{var i,a;be.init(e,t),e._zod.onattach.push(l=>{const m=l._zod.bag;m.format=t.format,t.pattern&&(m.patterns??(m.patterns=new Set),m.patterns.add(t.pattern))}),t.pattern?(i=e._zod).check??(i.check=l=>{t.pattern.lastIndex=0,!t.pattern.test(l.value)&&l.issues.push({origin:"string",code:"invalid_format",format:t.format,input:l.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(a=e._zod).check??(a.check=()=>{})}),la=I("$ZodCheckRegex",(e,t)=>{It.init(e,t),e._zod.check=i=>{t.pattern.lastIndex=0,!t.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:"regex",input:i.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),fa=I("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=ra),It.init(e,t)}),ha=I("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=oa),It.init(e,t)}),da=I("$ZodCheckIncludes",(e,t)=>{be.init(e,t);const i=xn(t.includes),a=new RegExp(typeof t.position=="number"?`^.{${t.position}}${i}`:i);t.pattern=a,e._zod.onattach.push(l=>{const m=l._zod.bag;m.patterns??(m.patterns=new Set),m.patterns.add(a)}),e._zod.check=l=>{l.value.includes(t.includes,t.position)||l.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:l.value,inst:e,continue:!t.abort})}}),pa=I("$ZodCheckStartsWith",(e,t)=>{be.init(e,t);const i=new RegExp(`^${xn(t.prefix)}.*`);t.pattern??(t.pattern=i),e._zod.onattach.push(a=>{const l=a._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(i)}),e._zod.check=a=>{a.value.startsWith(t.prefix)||a.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:a.value,inst:e,continue:!t.abort})}}),ma=I("$ZodCheckEndsWith",(e,t)=>{be.init(e,t);const i=new RegExp(`.*${xn(t.suffix)}$`);t.pattern??(t.pattern=i),e._zod.onattach.push(a=>{const l=a._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(i)}),e._zod.check=a=>{a.value.endsWith(t.suffix)||a.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:a.value,inst:e,continue:!t.abort})}}),va=I("$ZodCheckOverwrite",(e,t)=>{be.init(e,t),e._zod.check=i=>{i.value=t.tx(i.value)}});class ya{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const a=t.split(`
`).filter(p=>p),l=Math.min(...a.map(p=>p.length-p.trimStart().length)),m=a.map(p=>p.slice(l)).map(p=>" ".repeat(this.indent*2)+p);for(const p of m)this.content.push(p)}compile(){const t=Function,i=this?.args,l=[...(this?.content??[""]).map(m=>`  ${m}`)];return new t(...i,l.join(`
`))}}const ga={major:4,minor:1,patch:5},ue=I("$ZodType",(e,t)=>{var i;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=ga;const a=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&a.unshift(e);for(const l of a)for(const m of l._zod.onattach)m(e);if(a.length===0)(i=e._zod).deferred??(i.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const l=(p,O,Z)=>{let D=bn(p),W;for(const L of O){if(L._zod.def.when){if(!L._zod.def.when(p))continue}else if(D)continue;const Q=p.issues.length,Y=L._zod.check(p);if(Y instanceof Promise&&Z?.async===!1)throw new wn;if(W||Y instanceof Promise)W=(W??Promise.resolve()).then(async()=>{await Y,p.issues.length!==Q&&(D||(D=bn(p,Q)))});else{if(p.issues.length===Q)continue;D||(D=bn(p,Q))}}return W?W.then(()=>p):p},m=(p,O,Z)=>{if(bn(p))return p.aborted=!0,p;const D=l(O,a,Z);if(D instanceof Promise){if(Z.async===!1)throw new wn;return D.then(W=>e._zod.parse(W,Z))}return e._zod.parse(D,Z)};e._zod.run=(p,O)=>{if(O.skipChecks)return e._zod.parse(p,O);if(O.direction==="backward"){const D=e._zod.parse({value:p.value,issues:[]},{...O,skipChecks:!0});return D instanceof Promise?D.then(W=>m(W,p,O)):m(D,p,O)}const Z=e._zod.parse(p,O);if(Z instanceof Promise){if(O.async===!1)throw new wn;return Z.then(D=>l(D,a,O))}return l(Z,a,O)}}e["~standard"]={validate:l=>{try{const m=ku(e,l);return m.success?{value:m.data}:{issues:m.error?.issues}}catch{return xu(e,l).then(p=>p.success?{value:p.data}:{issues:p.error?.issues})}},vendor:"zod",version:1}}),Tr=I("$ZodString",(e,t)=>{ue.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??Hu(e._zod.bag),e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=String(i.value)}catch{}return typeof i.value=="string"||i.issues.push({expected:"string",code:"invalid_type",input:i.value,inst:e}),i}}),oe=I("$ZodStringFormat",(e,t)=>{It.init(e,t),Tr.init(e,t)}),ba=I("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=Nu),oe.init(e,t)}),_a=I("$ZodUUID",(e,t)=>{if(t.version){const a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(a===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Eo(a))}else t.pattern??(t.pattern=Eo());oe.init(e,t)}),wa=I("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=Fu),oe.init(e,t)}),ka=I("$ZodURL",(e,t)=>{oe.init(e,t),e._zod.check=i=>{try{const a=i.value.trim(),l=new URL(a);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(l.hostname)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Yu.source,input:i.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(l.protocol.endsWith(":")?l.protocol.slice(0,-1):l.protocol)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:i.value,inst:e,continue:!t.abort})),t.normalize?i.value=l.href:i.value=a;return}catch{i.issues.push({code:"invalid_format",format:"url",input:i.value,inst:e,continue:!t.abort})}}}),xa=I("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=qu()),oe.init(e,t)}),za=I("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=Ru),oe.init(e,t)}),Ea=I("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=$u),oe.init(e,t)}),Oa=I("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=Tu),oe.init(e,t)}),Pa=I("$ZodULID",(e,t)=>{t.pattern??(t.pattern=ju),oe.init(e,t)}),Sa=I("$ZodXID",(e,t)=>{t.pattern??(t.pattern=Cu),oe.init(e,t)}),Ia=I("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=Du),oe.init(e,t)}),Aa=I("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Qu(t)),oe.init(e,t)}),Za=I("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Ju),oe.init(e,t)}),$a=I("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Xu(t)),oe.init(e,t)}),Ta=I("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=Ku),oe.init(e,t)}),ja=I("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=Mu),oe.init(e,t),e._zod.onattach.push(i=>{const a=i._zod.bag;a.format="ipv4"})}),Ca=I("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=Uu),oe.init(e,t),e._zod.onattach.push(i=>{const a=i._zod.bag;a.format="ipv6"}),e._zod.check=i=>{try{new URL(`http://[${i.value}]`)}catch{i.issues.push({code:"invalid_format",format:"ipv6",input:i.value,inst:e,continue:!t.abort})}}}),Da=I("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=Lu),oe.init(e,t)}),Ra=I("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=Vu),oe.init(e,t),e._zod.check=i=>{const[a,l]=i.value.split("/");try{if(!l)throw new Error;const m=Number(l);if(`${m}`!==l)throw new Error;if(m<0||m>128)throw new Error;new URL(`http://[${a}]`)}catch{i.issues.push({code:"invalid_format",format:"cidrv6",input:i.value,inst:e,continue:!t.abort})}}});function ti(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const Ka=I("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Wu),oe.init(e,t),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64"}),e._zod.check=i=>{ti(i.value)||i.issues.push({code:"invalid_format",format:"base64",input:i.value,inst:e,continue:!t.abort})}});function Na(e){if(!Jo.test(e))return!1;const t=e.replace(/[-_]/g,a=>a==="-"?"+":"/"),i=t.padEnd(Math.ceil(t.length/4)*4,"=");return ti(i)}const Fa=I("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=Jo),oe.init(e,t),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64url"}),e._zod.check=i=>{Na(i.value)||i.issues.push({code:"invalid_format",format:"base64url",input:i.value,inst:e,continue:!t.abort})}}),Ba=I("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Gu),oe.init(e,t)});function qa(e,t=null){try{const i=e.split(".");if(i.length!==3)return!1;const[a]=i;if(!a)return!1;const l=JSON.parse(atob(a));return!("typ"in l&&l?.typ!=="JWT"||!l.alg||t&&(!("alg"in l)||l.alg!==t))}catch{return!1}}const Ma=I("$ZodJWT",(e,t)=>{oe.init(e,t),e._zod.check=i=>{qa(i.value,t.alg)||i.issues.push({code:"invalid_format",format:"jwt",input:i.value,inst:e,continue:!t.abort})}}),ri=I("$ZodNumber",(e,t)=>{ue.init(e,t),e._zod.pattern=e._zod.bag.pattern??na,e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=Number(i.value)}catch{}const l=i.value;if(typeof l=="number"&&!Number.isNaN(l)&&Number.isFinite(l))return i;const m=typeof l=="number"?Number.isNaN(l)?"NaN":Number.isFinite(l)?void 0:"Infinity":void 0;return i.issues.push({expected:"number",code:"invalid_type",input:l,inst:e,...m?{received:m}:{}}),i}}),Ua=I("$ZodNumber",(e,t)=>{ua.init(e,t),ri.init(e,t)}),La=I("$ZodBoolean",(e,t)=>{ue.init(e,t),e._zod.pattern=ta,e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=!!i.value}catch{}const l=i.value;return typeof l=="boolean"||i.issues.push({expected:"boolean",code:"invalid_type",input:l,inst:e}),i}}),Va=I("$ZodUnknown",(e,t)=>{ue.init(e,t),e._zod.parse=i=>i}),Wa=I("$ZodNever",(e,t)=>{ue.init(e,t),e._zod.parse=(i,a)=>(i.issues.push({expected:"never",code:"invalid_type",input:i.value,inst:e}),i)});function Oo(e,t,i){e.issues.length&&t.issues.push(..._n(i,e.issues)),t.value[i]=e.value}const Ya=I("$ZodArray",(e,t)=>{ue.init(e,t),e._zod.parse=(i,a)=>{const l=i.value;if(!Array.isArray(l))return i.issues.push({expected:"array",code:"invalid_type",input:l,inst:e}),i;i.value=Array(l.length);const m=[];for(let p=0;p<l.length;p++){const O=l[p],Z=t.element._zod.run({value:O,issues:[]},a);Z instanceof Promise?m.push(Z.then(D=>Oo(D,i,p))):Oo(Z,i,p)}return m.length?Promise.all(m).then(()=>i):i}});function Et(e,t,i,a){e.issues.length&&t.issues.push(..._n(i,e.issues)),e.value===void 0?i in a&&(t.value[i]=void 0):t.value[i]=e.value}function oi(e){const t=Object.keys(e.shape);for(const a of t)if(!e.shape[a]._zod.traits.has("$ZodType"))throw new Error(`Invalid element at key "${a}": expected a Zod schema`);const i=fu(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(i)}}function ii(e,t,i,a,l,m){const p=[],O=l.keySet,Z=l.catchall._zod,D=Z.def.type;for(const W of Object.keys(t)){if(O.has(W))continue;if(D==="never"){p.push(W);continue}const L=Z.run({value:t[W],issues:[]},a);L instanceof Promise?e.push(L.then(Q=>Et(Q,i,W,t))):Et(L,i,W,t)}return p.length&&i.issues.push({code:"unrecognized_keys",keys:p,input:t,inst:m}),e.length?Promise.all(e).then(()=>i):i}const Ga=I("$ZodObject",(e,t)=>{ue.init(e,t);const i=Pr(()=>oi(t));ne(e._zod,"propValues",()=>{const p=t.shape,O={};for(const Z in p){const D=p[Z]._zod;if(D.values){O[Z]??(O[Z]=new Set);for(const W of D.values)O[Z].add(W)}}return O});const a=zt,l=t.catchall;let m;e._zod.parse=(p,O)=>{m??(m=i.value);const Z=p.value;if(!a(Z))return p.issues.push({expected:"object",code:"invalid_type",input:Z,inst:e}),p;p.value={};const D=[],W=m.shape;for(const L of m.keys){const Y=W[L]._zod.run({value:Z[L],issues:[]},O);Y instanceof Promise?D.push(Y.then(ee=>Et(ee,p,L,Z))):Et(Y,p,L,Z)}return l?ii(D,Z,p,O,i.value,e):D.length?Promise.all(D).then(()=>p):p}}),Ja=I("$ZodObjectJIT",(e,t)=>{Ga.init(e,t);const i=e._zod.parse,a=Pr(()=>oi(t)),l=Q=>{const Y=new ya(["shape","payload","ctx"]),ee=a.value,Oe=xe=>{const pe=zo(xe);return`shape[${pe}]._zod.run({ value: input[${pe}], issues: [] }, ctx)`};Y.write("const input = payload.value;");const Mn=Object.create(null);let Zt=0;for(const xe of ee.keys)Mn[xe]=`key_${Zt++}`;Y.write("const newResult = {}");for(const xe of ee.keys){const pe=Mn[xe],Ce=zo(xe);Y.write(`const ${pe} = ${Oe(xe)};`),Y.write(`
        if (${pe}.issues.length) {
          payload.issues = payload.issues.concat(${pe}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Ce}, ...iss.path] : [${Ce}]
          })));
        }
        
        if (${pe}.value === undefined) {
          if (${Ce} in input) {
            newResult[${Ce}] = undefined;
          }
        } else {
          newResult[${Ce}] = ${pe}.value;
        }
      `)}Y.write("payload.value = newResult;"),Y.write("return payload;");const an=Y.compile();return(xe,pe)=>an(Q,xe,pe)};let m;const p=zt,O=!wr.jitless,D=O&&cu.value,W=t.catchall;let L;e._zod.parse=(Q,Y)=>{L??(L=a.value);const ee=Q.value;return p(ee)?O&&D&&Y?.async===!1&&Y.jitless!==!0?(m||(m=l(t.shape)),Q=m(Q,Y),W?ii([],ee,Q,Y,L,e):Q):i(Q,Y):(Q.issues.push({expected:"object",code:"invalid_type",input:ee,inst:e}),Q)}});function Po(e,t,i,a){for(const m of e)if(m.issues.length===0)return t.value=m.value,t;const l=e.filter(m=>!bn(m));return l.length===1?(t.value=l[0].value,l[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:i,errors:e.map(m=>m.issues.map(p=>Ue(p,a,Me())))}),t)}const Xa=I("$ZodUnion",(e,t)=>{ue.init(e,t),ne(e._zod,"optin",()=>t.options.some(l=>l._zod.optin==="optional")?"optional":void 0),ne(e._zod,"optout",()=>t.options.some(l=>l._zod.optout==="optional")?"optional":void 0),ne(e._zod,"values",()=>{if(t.options.every(l=>l._zod.values))return new Set(t.options.flatMap(l=>Array.from(l._zod.values)))}),ne(e._zod,"pattern",()=>{if(t.options.every(l=>l._zod.pattern)){const l=t.options.map(m=>m._zod.pattern);return new RegExp(`^(${l.map(m=>Ir(m.source)).join("|")})$`)}});const i=t.options.length===1,a=t.options[0]._zod.run;e._zod.parse=(l,m)=>{if(i)return a(l,m);let p=!1;const O=[];for(const Z of t.options){const D=Z._zod.run({value:l.value,issues:[]},m);if(D instanceof Promise)O.push(D),p=!0;else{if(D.issues.length===0)return D;O.push(D)}}return p?Promise.all(O).then(Z=>Po(Z,l,e,m)):Po(O,l,e,m)}}),Qa=I("$ZodIntersection",(e,t)=>{ue.init(e,t),e._zod.parse=(i,a)=>{const l=i.value,m=t.left._zod.run({value:l,issues:[]},a),p=t.right._zod.run({value:l,issues:[]},a);return m instanceof Promise||p instanceof Promise?Promise.all([m,p]).then(([Z,D])=>So(i,Z,D)):So(i,m,p)}});function xr(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(kn(e)&&kn(t)){const i=Object.keys(t),a=Object.keys(e).filter(m=>i.indexOf(m)!==-1),l={...e,...t};for(const m of a){const p=xr(e[m],t[m]);if(!p.valid)return{valid:!1,mergeErrorPath:[m,...p.mergeErrorPath]};l[m]=p.data}return{valid:!0,data:l}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const i=[];for(let a=0;a<e.length;a++){const l=e[a],m=t[a],p=xr(l,m);if(!p.valid)return{valid:!1,mergeErrorPath:[a,...p.mergeErrorPath]};i.push(p.data)}return{valid:!0,data:i}}return{valid:!1,mergeErrorPath:[]}}function So(e,t,i){if(t.issues.length&&e.issues.push(...t.issues),i.issues.length&&e.issues.push(...i.issues),bn(e))return e;const a=xr(t.value,i.value);if(!a.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}const Ha=I("$ZodRecord",(e,t)=>{ue.init(e,t),e._zod.parse=(i,a)=>{const l=i.value;if(!kn(l))return i.issues.push({expected:"record",code:"invalid_type",input:l,inst:e}),i;const m=[];if(t.keyType._zod.values){const p=t.keyType._zod.values;i.value={};for(const Z of p)if(typeof Z=="string"||typeof Z=="number"||typeof Z=="symbol"){const D=t.valueType._zod.run({value:l[Z],issues:[]},a);D instanceof Promise?m.push(D.then(W=>{W.issues.length&&i.issues.push(..._n(Z,W.issues)),i.value[Z]=W.value})):(D.issues.length&&i.issues.push(..._n(Z,D.issues)),i.value[Z]=D.value)}let O;for(const Z in l)p.has(Z)||(O=O??[],O.push(Z));O&&O.length>0&&i.issues.push({code:"unrecognized_keys",input:l,inst:e,keys:O})}else{i.value={};for(const p of Reflect.ownKeys(l)){if(p==="__proto__")continue;const O=t.keyType._zod.run({value:p,issues:[]},a);if(O instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(O.issues.length){i.issues.push({code:"invalid_key",origin:"record",issues:O.issues.map(D=>Ue(D,a,Me())),input:p,path:[p],inst:e}),i.value[O.value]=O.value;continue}const Z=t.valueType._zod.run({value:l[p],issues:[]},a);Z instanceof Promise?m.push(Z.then(D=>{D.issues.length&&i.issues.push(..._n(p,D.issues)),i.value[O.value]=D.value})):(Z.issues.length&&i.issues.push(..._n(p,Z.issues)),i.value[O.value]=Z.value)}}return m.length?Promise.all(m).then(()=>i):i}}),es=I("$ZodEnum",(e,t)=>{ue.init(e,t);const i=uu(t.entries),a=new Set(i);e._zod.values=a,e._zod.pattern=new RegExp(`^(${i.filter(l=>lu.has(typeof l)).map(l=>typeof l=="string"?xn(l):l.toString()).join("|")})$`),e._zod.parse=(l,m)=>{const p=l.value;return a.has(p)||l.issues.push({code:"invalid_value",values:i,input:p,inst:e}),l}}),ns=I("$ZodLiteral",(e,t)=>{if(ue.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?xn(i):i?xn(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,a)=>{const l=i.value;return e._zod.values.has(l)||i.issues.push({code:"invalid_value",values:t.values,input:l,inst:e}),i}}),ts=I("$ZodTransform",(e,t)=>{ue.init(e,t),e._zod.parse=(i,a)=>{if(a.direction==="backward")throw new Uo(e.constructor.name);const l=t.transform(i.value,i);if(a.async)return(l instanceof Promise?l:Promise.resolve(l)).then(p=>(i.value=p,i));if(l instanceof Promise)throw new wn;return i.value=l,i}});function Io(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const rs=I("$ZodOptional",(e,t)=>{ue.init(e,t),e._zod.optin="optional",e._zod.optout="optional",ne(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),ne(e._zod,"pattern",()=>{const i=t.innerType._zod.pattern;return i?new RegExp(`^(${Ir(i.source)})?$`):void 0}),e._zod.parse=(i,a)=>{if(t.innerType._zod.optin==="optional"){const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Io(m,i.value)):Io(l,i.value)}return i.value===void 0?i:t.innerType._zod.run(i,a)}}),os=I("$ZodNullable",(e,t)=>{ue.init(e,t),ne(e._zod,"optin",()=>t.innerType._zod.optin),ne(e._zod,"optout",()=>t.innerType._zod.optout),ne(e._zod,"pattern",()=>{const i=t.innerType._zod.pattern;return i?new RegExp(`^(${Ir(i.source)}|null)$`):void 0}),ne(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(i,a)=>i.value===null?i:t.innerType._zod.run(i,a)}),is=I("$ZodDefault",(e,t)=>{ue.init(e,t),e._zod.optin="optional",ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);if(i.value===void 0)return i.value=t.defaultValue,i;const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Ao(m,t)):Ao(l,t)}});function Ao(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const us=I("$ZodPrefault",(e,t)=>{ue.init(e,t),e._zod.optin="optional",ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>(a.direction==="backward"||i.value===void 0&&(i.value=t.defaultValue),t.innerType._zod.run(i,a))}),as=I("$ZodNonOptional",(e,t)=>{ue.init(e,t),ne(e._zod,"values",()=>{const i=t.innerType._zod.values;return i?new Set([...i].filter(a=>a!==void 0)):void 0}),e._zod.parse=(i,a)=>{const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Zo(m,e)):Zo(l,e)}});function Zo(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const ss=I("$ZodCatch",(e,t)=>{ue.init(e,t),ne(e._zod,"optin",()=>t.innerType._zod.optin),ne(e._zod,"optout",()=>t.innerType._zod.optout),ne(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>(i.value=m.value,m.issues.length&&(i.value=t.catchValue({...i,error:{issues:m.issues.map(p=>Ue(p,a,Me()))},input:i.value}),i.issues=[]),i)):(i.value=l.value,l.issues.length&&(i.value=t.catchValue({...i,error:{issues:l.issues.map(m=>Ue(m,a,Me()))},input:i.value}),i.issues=[]),i)}}),cs=I("$ZodPipe",(e,t)=>{ue.init(e,t),ne(e._zod,"values",()=>t.in._zod.values),ne(e._zod,"optin",()=>t.in._zod.optin),ne(e._zod,"optout",()=>t.out._zod.optout),ne(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(i,a)=>{if(a.direction==="backward"){const m=t.out._zod.run(i,a);return m instanceof Promise?m.then(p=>_t(p,t.in,a)):_t(m,t.in,a)}const l=t.in._zod.run(i,a);return l instanceof Promise?l.then(m=>_t(m,t.out,a)):_t(l,t.out,a)}});function _t(e,t,i){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},i)}const ls=I("$ZodReadonly",(e,t)=>{ue.init(e,t),ne(e._zod,"propValues",()=>t.innerType._zod.propValues),ne(e._zod,"values",()=>t.innerType._zod.values),ne(e._zod,"optin",()=>t.innerType._zod.optin),ne(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then($o):$o(l)}});function $o(e){return e.value=Object.freeze(e.value),e}const fs=I("$ZodCustom",(e,t)=>{be.init(e,t),ue.init(e,t),e._zod.parse=(i,a)=>i,e._zod.check=i=>{const a=i.value,l=t.fn(a);if(l instanceof Promise)return l.then(m=>To(m,i,a,e));To(l,i,a,e)}});function To(e,t,i,a){if(!e){const l={code:"custom",input:i,inst:a,path:[...a._zod.def.path??[]],continue:!a._zod.def.abort};a._zod.def.params&&(l.params=a._zod.def.params),t.issues.push(Bn(l))}}class hs{constructor(){this._map=new Map,this._idmap=new Map}add(t,...i){const a=i[0];if(this._map.set(t,a),a&&typeof a=="object"&&"id"in a){if(this._idmap.has(a.id))throw new Error(`ID ${a.id} already exists in the registry`);this._idmap.set(a.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const i=this._map.get(t);return i&&typeof i=="object"&&"id"in i&&this._idmap.delete(i.id),this._map.delete(t),this}get(t){const i=t._zod.parent;if(i){const a={...this.get(i)??{}};delete a.id;const l={...a,...this._map.get(t)};return Object.keys(l).length?l:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function ds(){return new hs}const wt=ds();function ps(e,t){return new e({type:"string",...B(t)})}function ms(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...B(t)})}function jo(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...B(t)})}function vs(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...B(t)})}function ys(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...B(t)})}function gs(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...B(t)})}function bs(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...B(t)})}function _s(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...B(t)})}function ws(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...B(t)})}function ks(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...B(t)})}function xs(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...B(t)})}function zs(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...B(t)})}function Es(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...B(t)})}function Os(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...B(t)})}function Ps(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...B(t)})}function Ss(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...B(t)})}function Is(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...B(t)})}function As(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...B(t)})}function Zs(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...B(t)})}function $s(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...B(t)})}function Ts(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...B(t)})}function js(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...B(t)})}function Cs(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...B(t)})}function Ds(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...B(t)})}function Rs(e,t){return new e({type:"string",format:"date",check:"string_format",...B(t)})}function Ks(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...B(t)})}function Ns(e,t){return new e({type:"string",format:"duration",check:"string_format",...B(t)})}function Fs(e,t){return new e({type:"number",checks:[],...B(t)})}function Bs(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...B(t)})}function qs(e,t){return new e({type:"boolean",...B(t)})}function Ms(e){return new e({type:"unknown"})}function Us(e,t){return new e({type:"never",...B(t)})}function Co(e,t){return new ei({check:"less_than",...B(t),value:e,inclusive:!1})}function yr(e,t){return new ei({check:"less_than",...B(t),value:e,inclusive:!0})}function Do(e,t){return new ni({check:"greater_than",...B(t),value:e,inclusive:!1})}function gr(e,t){return new ni({check:"greater_than",...B(t),value:e,inclusive:!0})}function Ro(e,t){return new ia({check:"multiple_of",...B(t),value:e})}function ui(e,t){return new aa({check:"max_length",...B(t),maximum:e})}function Ot(e,t){return new sa({check:"min_length",...B(t),minimum:e})}function ai(e,t){return new ca({check:"length_equals",...B(t),length:e})}function Ls(e,t){return new la({check:"string_format",format:"regex",...B(t),pattern:e})}function Vs(e){return new fa({check:"string_format",format:"lowercase",...B(e)})}function Ws(e){return new ha({check:"string_format",format:"uppercase",...B(e)})}function Ys(e,t){return new da({check:"string_format",format:"includes",...B(t),includes:e})}function Gs(e,t){return new pa({check:"string_format",format:"starts_with",...B(t),prefix:e})}function Js(e,t){return new ma({check:"string_format",format:"ends_with",...B(t),suffix:e})}function qn(e){return new va({check:"overwrite",tx:e})}function Xs(e){return qn(t=>t.normalize(e))}function Qs(){return qn(e=>e.trim())}function Hs(){return qn(e=>e.toLowerCase())}function ec(){return qn(e=>e.toUpperCase())}function nc(e,t,i){return new e({type:"array",element:t,...B(i)})}function tc(e,t,i){return new e({type:"custom",check:"custom",fn:t,...B(i)})}function rc(e){const t=oc(i=>(i.addIssue=a=>{if(typeof a=="string")i.issues.push(Bn(a,i.value,t._zod.def));else{const l=a;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=i.value),l.inst??(l.inst=t),l.continue??(l.continue=!t._zod.def.abort),i.issues.push(Bn(l))}},e(i.value,i)));return t}function oc(e,t){const i=new be({check:"custom",...B(t)});return i._zod.check=e,i}const ic=I("ZodISODateTime",(e,t)=>{Aa.init(e,t),ae.init(e,t)});function uc(e){return Ds(ic,e)}const ac=I("ZodISODate",(e,t)=>{Za.init(e,t),ae.init(e,t)});function sc(e){return Rs(ac,e)}const cc=I("ZodISOTime",(e,t)=>{$a.init(e,t),ae.init(e,t)});function lc(e){return Ks(cc,e)}const fc=I("ZodISODuration",(e,t)=>{Ta.init(e,t),ae.init(e,t)});function hc(e){return Ns(fc,e)}const dc=(e,t)=>{Yo.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:i=>wu(e,i)},flatten:{value:i=>_u(e,i)},addIssue:{value:i=>{e.issues.push(i),e.message=JSON.stringify(e.issues,kr,2)}},addIssues:{value:i=>{e.issues.push(...i),e.message=JSON.stringify(e.issues,kr,2)}},isEmpty:{get(){return e.issues.length===0}}})},Ee=I("ZodError",dc,{Parent:Error}),pc=Zr(Ee),mc=$r(Ee),vc=Pt(Ee),yc=St(Ee),gc=zu(Ee),bc=Eu(Ee),_c=Ou(Ee),wc=Pu(Ee),kc=Su(Ee),xc=Iu(Ee),zc=Au(Ee),Ec=Zu(Ee),ce=I("ZodType",(e,t)=>(ue.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...i)=>e.clone({...t,checks:[...t.checks??[],...i.map(a=>typeof a=="function"?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),e.clone=(i,a)=>Ve(e,i,a),e.brand=()=>e,e.register=(i,a)=>(i.add(e,a),e),e.parse=(i,a)=>pc(e,i,a,{callee:e.parse}),e.safeParse=(i,a)=>vc(e,i,a),e.parseAsync=async(i,a)=>mc(e,i,a,{callee:e.parseAsync}),e.safeParseAsync=async(i,a)=>yc(e,i,a),e.spa=e.safeParseAsync,e.encode=(i,a)=>gc(e,i,a),e.decode=(i,a)=>bc(e,i,a),e.encodeAsync=async(i,a)=>_c(e,i,a),e.decodeAsync=async(i,a)=>wc(e,i,a),e.safeEncode=(i,a)=>kc(e,i,a),e.safeDecode=(i,a)=>xc(e,i,a),e.safeEncodeAsync=async(i,a)=>zc(e,i,a),e.safeDecodeAsync=async(i,a)=>Ec(e,i,a),e.refine=(i,a)=>e.check(bl(i,a)),e.superRefine=i=>e.check(_l(i)),e.overwrite=i=>e.check(qn(i)),e.optional=()=>Fo(e),e.nullable=()=>Bo(e),e.nullish=()=>Fo(Bo(e)),e.nonoptional=i=>hl(e,i),e.array=()=>jr(e),e.or=i=>Hc([e,i]),e.and=i=>nl(e,i),e.transform=i=>qo(e,ul(i)),e.default=i=>cl(e,i),e.prefault=i=>fl(e,i),e.catch=i=>pl(e,i),e.pipe=i=>qo(e,i),e.readonly=()=>yl(e),e.describe=i=>{const a=e.clone();return wt.add(a,{description:i}),a},Object.defineProperty(e,"description",{get(){return wt.get(e)?.description},configurable:!0}),e.meta=(...i)=>{if(i.length===0)return wt.get(e);const a=e.clone();return wt.add(a,i[0]),a},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),si=I("_ZodString",(e,t)=>{Tr.init(e,t),ce.init(e,t);const i=e._zod.bag;e.format=i.format??null,e.minLength=i.minimum??null,e.maxLength=i.maximum??null,e.regex=(...a)=>e.check(Ls(...a)),e.includes=(...a)=>e.check(Ys(...a)),e.startsWith=(...a)=>e.check(Gs(...a)),e.endsWith=(...a)=>e.check(Js(...a)),e.min=(...a)=>e.check(Ot(...a)),e.max=(...a)=>e.check(ui(...a)),e.length=(...a)=>e.check(ai(...a)),e.nonempty=(...a)=>e.check(Ot(1,...a)),e.lowercase=a=>e.check(Vs(a)),e.uppercase=a=>e.check(Ws(a)),e.trim=()=>e.check(Qs()),e.normalize=(...a)=>e.check(Xs(...a)),e.toLowerCase=()=>e.check(Hs()),e.toUpperCase=()=>e.check(ec())}),Oc=I("ZodString",(e,t)=>{Tr.init(e,t),si.init(e,t),e.email=i=>e.check(ms(Pc,i)),e.url=i=>e.check(_s(Sc,i)),e.jwt=i=>e.check(Cs(Mc,i)),e.emoji=i=>e.check(ws(Ic,i)),e.guid=i=>e.check(jo(Ko,i)),e.uuid=i=>e.check(vs(kt,i)),e.uuidv4=i=>e.check(ys(kt,i)),e.uuidv6=i=>e.check(gs(kt,i)),e.uuidv7=i=>e.check(bs(kt,i)),e.nanoid=i=>e.check(ks(Ac,i)),e.guid=i=>e.check(jo(Ko,i)),e.cuid=i=>e.check(xs(Zc,i)),e.cuid2=i=>e.check(zs($c,i)),e.ulid=i=>e.check(Es(Tc,i)),e.base64=i=>e.check($s(Fc,i)),e.base64url=i=>e.check(Ts(Bc,i)),e.xid=i=>e.check(Os(jc,i)),e.ksuid=i=>e.check(Ps(Cc,i)),e.ipv4=i=>e.check(Ss(Dc,i)),e.ipv6=i=>e.check(Is(Rc,i)),e.cidrv4=i=>e.check(As(Kc,i)),e.cidrv6=i=>e.check(Zs(Nc,i)),e.e164=i=>e.check(js(qc,i)),e.datetime=i=>e.check(uc(i)),e.date=i=>e.check(sc(i)),e.time=i=>e.check(lc(i)),e.duration=i=>e.check(hc(i))});function Ae(e){return ps(Oc,e)}const ae=I("ZodStringFormat",(e,t)=>{oe.init(e,t),si.init(e,t)}),Pc=I("ZodEmail",(e,t)=>{wa.init(e,t),ae.init(e,t)}),Ko=I("ZodGUID",(e,t)=>{ba.init(e,t),ae.init(e,t)}),kt=I("ZodUUID",(e,t)=>{_a.init(e,t),ae.init(e,t)}),Sc=I("ZodURL",(e,t)=>{ka.init(e,t),ae.init(e,t)}),Ic=I("ZodEmoji",(e,t)=>{xa.init(e,t),ae.init(e,t)}),Ac=I("ZodNanoID",(e,t)=>{za.init(e,t),ae.init(e,t)}),Zc=I("ZodCUID",(e,t)=>{Ea.init(e,t),ae.init(e,t)}),$c=I("ZodCUID2",(e,t)=>{Oa.init(e,t),ae.init(e,t)}),Tc=I("ZodULID",(e,t)=>{Pa.init(e,t),ae.init(e,t)}),jc=I("ZodXID",(e,t)=>{Sa.init(e,t),ae.init(e,t)}),Cc=I("ZodKSUID",(e,t)=>{Ia.init(e,t),ae.init(e,t)}),Dc=I("ZodIPv4",(e,t)=>{ja.init(e,t),ae.init(e,t)}),Rc=I("ZodIPv6",(e,t)=>{Ca.init(e,t),ae.init(e,t)}),Kc=I("ZodCIDRv4",(e,t)=>{Da.init(e,t),ae.init(e,t)}),Nc=I("ZodCIDRv6",(e,t)=>{Ra.init(e,t),ae.init(e,t)}),Fc=I("ZodBase64",(e,t)=>{Ka.init(e,t),ae.init(e,t)}),Bc=I("ZodBase64URL",(e,t)=>{Fa.init(e,t),ae.init(e,t)}),qc=I("ZodE164",(e,t)=>{Ba.init(e,t),ae.init(e,t)}),Mc=I("ZodJWT",(e,t)=>{Ma.init(e,t),ae.init(e,t)}),ci=I("ZodNumber",(e,t)=>{ri.init(e,t),ce.init(e,t),e.gt=(a,l)=>e.check(Do(a,l)),e.gte=(a,l)=>e.check(gr(a,l)),e.min=(a,l)=>e.check(gr(a,l)),e.lt=(a,l)=>e.check(Co(a,l)),e.lte=(a,l)=>e.check(yr(a,l)),e.max=(a,l)=>e.check(yr(a,l)),e.int=a=>e.check(No(a)),e.safe=a=>e.check(No(a)),e.positive=a=>e.check(Do(0,a)),e.nonnegative=a=>e.check(gr(0,a)),e.negative=a=>e.check(Co(0,a)),e.nonpositive=a=>e.check(yr(0,a)),e.multipleOf=(a,l)=>e.check(Ro(a,l)),e.step=(a,l)=>e.check(Ro(a,l)),e.finite=()=>e;const i=e._zod.bag;e.minValue=Math.max(i.minimum??Number.NEGATIVE_INFINITY,i.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(i.maximum??Number.POSITIVE_INFINITY,i.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(i.format??"").includes("int")||Number.isSafeInteger(i.multipleOf??.5),e.isFinite=!0,e.format=i.format??null});function ie(e){return Fs(ci,e)}const Uc=I("ZodNumberFormat",(e,t)=>{Ua.init(e,t),ci.init(e,t)});function No(e){return Bs(Uc,e)}const Lc=I("ZodBoolean",(e,t)=>{La.init(e,t),ce.init(e,t)});function Vc(e){return qs(Lc,e)}const Wc=I("ZodUnknown",(e,t)=>{Va.init(e,t),ce.init(e,t)});function zr(){return Ms(Wc)}const Yc=I("ZodNever",(e,t)=>{Wa.init(e,t),ce.init(e,t)});function Gc(e){return Us(Yc,e)}const Jc=I("ZodArray",(e,t)=>{Ya.init(e,t),ce.init(e,t),e.element=t.element,e.min=(i,a)=>e.check(Ot(i,a)),e.nonempty=i=>e.check(Ot(1,i)),e.max=(i,a)=>e.check(ui(i,a)),e.length=(i,a)=>e.check(ai(i,a)),e.unwrap=()=>e.element});function jr(e,t){return nc(Jc,e,t)}const Xc=I("ZodObject",(e,t)=>{Ja.init(e,t),ce.init(e,t),ne(e,"shape",()=>t.shape),e.keyof=()=>Or(Object.keys(e._zod.def.shape)),e.catchall=i=>e.clone({...e._zod.def,catchall:i}),e.passthrough=()=>e.clone({...e._zod.def,catchall:zr()}),e.loose=()=>e.clone({...e._zod.def,catchall:zr()}),e.strict=()=>e.clone({...e._zod.def,catchall:Gc()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=i=>mu(e,i),e.safeExtend=i=>vu(e,i),e.merge=i=>yu(e,i),e.pick=i=>du(e,i),e.omit=i=>pu(e,i),e.partial=(...i)=>gu(li,e,i[0]),e.required=(...i)=>bu(fi,e,i[0])});function _e(e,t){const i={type:"object",get shape(){return Le(this,"shape",e?su(e):{}),this.shape},...B(t)};return new Xc(i)}const Qc=I("ZodUnion",(e,t)=>{Xa.init(e,t),ce.init(e,t),e.options=t.options});function Hc(e,t){return new Qc({type:"union",options:e,...B(t)})}const el=I("ZodIntersection",(e,t)=>{Qa.init(e,t),ce.init(e,t)});function nl(e,t){return new el({type:"intersection",left:e,right:t})}const tl=I("ZodRecord",(e,t)=>{Ha.init(e,t),ce.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function rl(e,t,i){return new tl({type:"record",keyType:e,valueType:t,...B(i)})}const Er=I("ZodEnum",(e,t)=>{es.init(e,t),ce.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const i=new Set(Object.keys(t.entries));e.extract=(a,l)=>{const m={};for(const p of a)if(i.has(p))m[p]=t.entries[p];else throw new Error(`Key ${p} not found in enum`);return new Er({...t,checks:[],...B(l),entries:m})},e.exclude=(a,l)=>{const m={...t.entries};for(const p of a)if(i.has(p))delete m[p];else throw new Error(`Key ${p} not found in enum`);return new Er({...t,checks:[],...B(l),entries:m})}});function Or(e,t){const i=Array.isArray(e)?Object.fromEntries(e.map(a=>[a,a])):e;return new Er({type:"enum",entries:i,...B(t)})}const ol=I("ZodLiteral",(e,t)=>{ns.init(e,t),ce.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function At(e,t){return new ol({type:"literal",values:Array.isArray(e)?e:[e],...B(t)})}const il=I("ZodTransform",(e,t)=>{ts.init(e,t),ce.init(e,t),e._zod.parse=(i,a)=>{if(a.direction==="backward")throw new Uo(e.constructor.name);i.addIssue=m=>{if(typeof m=="string")i.issues.push(Bn(m,i.value,t));else{const p=m;p.fatal&&(p.continue=!1),p.code??(p.code="custom"),p.input??(p.input=i.value),p.inst??(p.inst=e),i.issues.push(Bn(p))}};const l=t.transform(i.value,i);return l instanceof Promise?l.then(m=>(i.value=m,i)):(i.value=l,i)}});function ul(e){return new il({type:"transform",transform:e})}const li=I("ZodOptional",(e,t)=>{rs.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Fo(e){return new li({type:"optional",innerType:e})}const al=I("ZodNullable",(e,t)=>{os.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Bo(e){return new al({type:"nullable",innerType:e})}const sl=I("ZodDefault",(e,t)=>{is.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function cl(e,t){return new sl({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():Vo(t)}})}const ll=I("ZodPrefault",(e,t)=>{us.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType});function fl(e,t){return new ll({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():Vo(t)}})}const fi=I("ZodNonOptional",(e,t)=>{as.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType});function hl(e,t){return new fi({type:"nonoptional",innerType:e,...B(t)})}const dl=I("ZodCatch",(e,t)=>{ss.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function pl(e,t){return new dl({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const ml=I("ZodPipe",(e,t)=>{cs.init(e,t),ce.init(e,t),e.in=t.in,e.out=t.out});function qo(e,t){return new ml({type:"pipe",in:e,out:t})}const vl=I("ZodReadonly",(e,t)=>{ls.init(e,t),ce.init(e,t),e.unwrap=()=>e._zod.def.innerType});function yl(e){return new vl({type:"readonly",innerType:e})}const gl=I("ZodCustom",(e,t)=>{fs.init(e,t),ce.init(e,t)});function bl(e,t={}){return tc(gl,e,t)}function _l(e){return rc(e)}const wl=_e({lastSimWallClock:ie().int().min(0),bgCoveredMs:ie().int().min(0)}),kl=_e({land:ie().int().min(0),ward:ie().int().min(0),distanceM:ie().int().min(0)}),xl=_e({arcana:ie().int().min(0),gold:ie().int().min(0)}),zl=_e({firepower:ie().int().min(0),scales:ie().int().min(0),tier:ie().int().min(0)}),El=_e({playtimeS:ie().int().min(0),deaths:ie().int().min(0),totalDistanceM:ie().int().min(0)}),Ol=_e({highestWard:ie().int().min(0),fastestBossS:ie().int().min(0)}),hi=_e({id:Ae().min(1),name:Ae().min(1).max(50),createdAt:ie().int().min(0),lastActive:ie().int().min(0),progress:kl,currencies:xl,enchants:zl,stats:El,leaderboard:Ol,sim:wl}),di=_e({a11yReducedMotion:Vc()}),pi=_e({version:At(1),profiles:jr(hi).min(1).max(6),settings:di});_e({version:At(1),profiles:jr(hi).min(0).max(6),settings:di});_e({id:ie().int().positive().optional(),profileId:Ae().min(1),version:At(1),data:pi,createdAt:ie().int().min(0),checksum:Ae().min(1)});_e({key:Ae().min(1),value:Ae(),updatedAt:ie().int().min(0)});_e({id:ie().int().positive().optional(),timestamp:ie().int().min(0),level:Or(["debug","info","warn","error"]),source:Or(["ui","worker","render","net"]),message:Ae().min(1),data:rl(Ae(),zr()).optional(),profileId:Ae().min(1).optional()});_e({fileVersion:At(1),exportedAt:ie().int().min(0),checksum:Ae().min(1),data:pi});function Al(e=1e3,t=1e4){let i=[],a=null;const l=async()=>{const Z=i;if(i=[],!Z.length)return;const D=Z.map(L=>({timestamp:L.t,level:L.lvl,source:L.src,message:L.msg,data:L.data,profileId:L.profileId}));await Fn.logs.bulkAdd(D);const W=await Fn.logs.count();if(W>t){const L=W-t,Q=await Fn.logs.orderBy("id").limit(L).toArray();await Fn.logs.bulkDelete(Q.map(Y=>Y.id))}};function m(){a||(a=setTimeout(async()=>{a=null;try{await l()}catch{}},e))}function p(Z){i.push(Z),m()}async function O(){i=[],a&&(clearTimeout(a),a=null),await Fn.logs.clear()}return typeof window<"u"&&window.addEventListener("beforeunload",()=>{l()},{once:!0}),{enqueue:p,clear:O}}export{Al as createDexieSink,Il as createLogger};
