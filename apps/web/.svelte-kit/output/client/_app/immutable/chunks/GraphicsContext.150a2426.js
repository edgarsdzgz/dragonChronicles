import{u as St,t as Re,C as W,T as X,I as Vt,D as He,d as lt,M as A,w as kt,R as j,x as Fe,c as E,P as K,e as fe,B as at,y as ze,z as De,A as xe,E as Ge,v as Le}from"./index.29d1603d.js";import{g as Ae}from"./_commonjsHelpers.725317a4.js";import{g as qe}from"./getTextureBatchBindGroup.4dbc2973.js";import{D as Be}from"./DefaultBatcher.d16e8b58.js";function Ut(s,t,e=2){const n=t&&t.length,i=n?t[0]*e:s.length;let r=ye(s,0,i,e,!0);const o=[];if(!r||r.next===r.prev)return o;let a,c,l;if(n&&(r=$e(s,t,r,e)),s.length>80*e){a=s[0],c=s[1];let h=a,d=c;for(let f=e;f<i;f+=e){const u=s[f],x=s[f+1];u<a&&(a=u),x<c&&(c=x),u>h&&(h=u),x>d&&(d=x)}l=Math.max(h-a,d-c),l=l!==0?32767/l:0}return ut(r,o,e,a,c,l,0),o}function ye(s,t,e,n,i){let r;if(i===en(s,t,e,n)>0)for(let o=t;o<e;o+=n)r=Xt(o/n|0,s[o],s[o+1],r);else for(let o=e-n;o>=t;o-=n)r=Xt(o/n|0,s[o],s[o+1],r);return r&&O(r,r.next)&&(ft(r),r=r.next),r}function Y(s,t){if(!s)return s;t||(t=s);let e=s,n;do if(n=!1,!e.steiner&&(O(e,e.next)||D(e.prev,e,e.next)===0)){if(ft(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function ut(s,t,e,n,i,r,o){if(!s)return;!o&&r&&Ye(s,n,i,r);let a=s;for(;s.prev!==s.next;){const c=s.prev,l=s.next;if(r?We(s,n,i,r):Ee(s)){t.push(c.i,s.i,l.i),ft(s),s=l.next,a=l.next;continue}if(s=l,s===a){o?o===1?(s=je(Y(s),t),ut(s,t,e,n,i,r,2)):o===2&&Ne(s,t,e,n,i,r):ut(Y(s),t,e,n,i,r,1);break}}}function Ee(s){const t=s.prev,e=s,n=s.next;if(D(t,e,n)>=0)return!1;const i=t.x,r=e.x,o=n.x,a=t.y,c=e.y,l=n.y,h=Math.min(i,r,o),d=Math.min(a,c,l),f=Math.max(i,r,o),u=Math.max(a,c,l);let x=n.next;for(;x!==t;){if(x.x>=h&&x.x<=f&&x.y>=d&&x.y<=u&&rt(i,a,r,c,o,l,x.x,x.y)&&D(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function We(s,t,e,n){const i=s.prev,r=s,o=s.next;if(D(i,r,o)>=0)return!1;const a=i.x,c=r.x,l=o.x,h=i.y,d=r.y,f=o.y,u=Math.min(a,c,l),x=Math.min(h,d,f),y=Math.max(a,c,l),p=Math.max(h,d,f),b=Rt(u,x,t,e,n),g=Rt(y,p,t,e,n);let M=s.prevZ,m=s.nextZ;for(;M&&M.z>=b&&m&&m.z<=g;){if(M.x>=u&&M.x<=y&&M.y>=x&&M.y<=p&&M!==i&&M!==o&&rt(a,h,c,d,l,f,M.x,M.y)&&D(M.prev,M,M.next)>=0||(M=M.prevZ,m.x>=u&&m.x<=y&&m.y>=x&&m.y<=p&&m!==i&&m!==o&&rt(a,h,c,d,l,f,m.x,m.y)&&D(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;M&&M.z>=b;){if(M.x>=u&&M.x<=y&&M.y>=x&&M.y<=p&&M!==i&&M!==o&&rt(a,h,c,d,l,f,M.x,M.y)&&D(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;m&&m.z<=g;){if(m.x>=u&&m.x<=y&&m.y>=x&&m.y<=p&&m!==i&&m!==o&&rt(a,h,c,d,l,f,m.x,m.y)&&D(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function je(s,t){let e=s;do{const n=e.prev,i=e.next.next;!O(n,i)&&ge(n,e,e.next,i)&&dt(n,i)&&dt(i,n)&&(t.push(n.i,e.i,i.i),ft(e),ft(e.next),e=s=i),e=e.next}while(e!==s);return Y(e)}function Ne(s,t,e,n,i,r){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Oe(o,a)){let c=me(o,a);o=Y(o,o.next),c=Y(c,c.next),ut(o,t,e,n,i,r,0),ut(c,t,e,n,i,r,0);return}a=a.next}o=o.next}while(o!==s)}function $e(s,t,e,n){const i=[];for(let r=0,o=t.length;r<o;r++){const a=t[r]*n,c=r<o-1?t[r+1]*n:s.length,l=ye(s,a,c,n,!1);l===l.next&&(l.steiner=!0),i.push(Ke(l))}i.sort(Ze);for(let r=0;r<i.length;r++)e=Ve(i[r],e);return e}function Ze(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),i=(t.next.y-t.y)/(t.next.x-t.x);e=n-i}return e}function Ve(s,t){const e=Ue(s,t);if(!e)return t;const n=me(e,s);return Y(n,n.next),Y(e,e.next)}function Ue(s,t){let e=t;const n=s.x,i=s.y;let r=-1/0,o;if(O(s,e))return e;do{if(O(s,e.next))return e.next;if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const d=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(d<=n&&d>r&&(r=d,o=e.x<e.next.x?e:e.next,d===n))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,c=o.x,l=o.y;let h=1/0;e=o;do{if(n>=e.x&&e.x>=c&&n!==e.x&&pe(i<l?n:r,i,c,l,i<l?r:n,i,e.x,e.y)){const d=Math.abs(i-e.y)/(n-e.x);dt(e,s)&&(d<h||d===h&&(e.x>o.x||e.x===o.x&&Xe(o,e)))&&(o=e,h=d)}e=e.next}while(e!==a);return o}function Xe(s,t){return D(s.prev,s,t.prev)<0&&D(t.next,s,s.next)<0}function Ye(s,t,e,n){let i=s;do i.z===0&&(i.z=Rt(i.x,i.y,t,e,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,Qe(i)}function Qe(s){let t,e=1;do{let n=s,i;s=null;let r=null;for(t=0;n;){t++;let o=n,a=0;for(let l=0;l<e&&(a++,o=o.nextZ,!!o);l++);let c=e;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,a--):(i=o,o=o.nextZ,c--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;n=o}r.nextZ=null,e*=2}while(t>1);return s}function Rt(s,t,e,n,i){return s=(s-e)*i|0,t=(t-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Ke(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function pe(s,t,e,n,i,r,o,a){return(i-o)*(t-a)>=(s-o)*(r-a)&&(s-o)*(n-a)>=(e-o)*(t-a)&&(e-o)*(r-a)>=(i-o)*(n-a)}function rt(s,t,e,n,i,r,o,a){return!(s===o&&t===a)&&pe(s,t,e,n,i,r,o,a)}function Oe(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Je(s,t)&&(dt(s,t)&&dt(t,s)&&tn(s,t)&&(D(s.prev,s,t.prev)||D(s,t.prev,t))||O(s,t)&&D(s.prev,s,s.next)>0&&D(t.prev,t,t.next)>0)}function D(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function O(s,t){return s.x===t.x&&s.y===t.y}function ge(s,t,e,n){const i=_t(D(s,t,e)),r=_t(D(s,t,n)),o=_t(D(e,n,s)),a=_t(D(e,n,t));return!!(i!==r&&o!==a||i===0&&bt(s,e,t)||r===0&&bt(s,n,t)||o===0&&bt(e,s,n)||a===0&&bt(e,t,n))}function bt(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function _t(s){return s>0?1:s<0?-1:0}function Je(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&ge(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function dt(s,t){return D(s.prev,s,s.next)<0?D(s,t,s.next)>=0&&D(s,s.prev,t)>=0:D(s,t,s.prev)<0||D(s,s.next,t)<0}function tn(s,t){let e=s,n=!1;const i=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&i<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==s);return n}function me(s,t){const e=Ht(s.i,s.x,s.y),n=Ht(t.i,t.x,t.y),i=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=i,i.prev=e,n.next=e,e.prev=n,r.next=n,n.prev=r,n}function Xt(s,t,e,n){const i=Ht(s,t,e);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ft(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Ht(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function en(s,t,e,n){let i=0;for(let r=t,o=e-n;r<e;r+=n)i+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return i}const nn=Ut.default||Ut,Yt=[{offset:0,color:"white"},{offset:1,color:"black"}],Lt=class Ft{constructor(...t){this.uid=St("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=sn(t);e={...e.type==="radial"?Ft.defaultRadialOptions:Ft.defaultLinearOptions,...Re(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:W.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:n,y:i}=this.end,r=n-t,o=i-e;const a=r<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(r<0){const p=t;t=n,n=p,r*=-1}if(o<0){const p=e;e=i,i=p,o*=-1}}const c=this.colorStops.length?this.colorStops:Yt,l=this._textureSize,{canvas:h,context:d}=Kt(l,1),f=a?d.createLinearGradient(this._textureSize,0,0,0):d.createLinearGradient(0,0,this._textureSize,0);Qt(f,c),d.fillStyle=f,d.fillRect(0,0,l,1),this.texture=new X({source:new Vt({resource:h,addressMode:this._wrapMode})});const u=Math.sqrt(r*r+o*o),x=Math.atan2(o,r),y=new A;y.scale(u/l,1),y.rotate(x),y.translate(t,e),this.textureSpace==="local"&&y.scale(l,l),this.transform=y}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:Yt,e=this._textureSize,{canvas:n,context:i}=Kt(e,e),{x:r,y:o}=this.center,{x:a,y:c}=this.outerCenter,l=this.innerRadius,h=this.outerRadius,d=a-h,f=c-h,u=e/(h*2),x=(r-d)*u,y=(o-f)*u,p=i.createRadialGradient(x,y,l*u,(a-d)*u,(c-f)*u,h*u);Qt(p,t),i.fillStyle=t[t.length-1].color,i.fillRect(0,0,e,e),i.fillStyle=p,i.translate(x,y),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-x,-y),i.fillRect(0,0,e,e),this.texture=new X({source:new Vt({resource:n,addressMode:this._wrapMode})});const b=new A;b.scale(1/u,1/u),b.translate(d,f),this.textureSpace==="local"&&b.scale(e,e),this.transform=b}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};Lt.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Lt.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let yt=Lt;function Qt(s,t){for(let e=0;e<t.length;e++){const n=t[e];s.addColorStop(n.offset,n.color)}}function Kt(s,t){const e=He.get().createCanvas(s,t),n=e.getContext("2d");return{canvas:e,context:n}}function sn(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(lt("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??yt.defaultLinearOptions.textureSize}),t}const Ot={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class rn{constructor(t,e){this.uid=St("fillPattern"),this._tick=0,this.transform=new A,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Ot[e].addressModeU,t.source.style.addressModeV=Ot[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var on=hn,Ct={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},an=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function hn(s){var t=[];return s.replace(an,function(e,n,i){var r=n.toLowerCase();for(i=ln(i),r=="m"&&i.length>2&&(t.push([n].concat(i.splice(0,2))),r="l",n=n=="m"?"l":"L");;){if(i.length==Ct[r])return i.unshift(n),t.push(i);if(i.length<Ct[r])throw new Error("malformed path data");t.push([n].concat(i.splice(0,Ct[r])))}}),t}var cn=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function ln(s){var t=s.match(cn);return t?t.map(Number):[]}const un=Ae(on);function dn(s,t){const e=un(s),n=[];let i=null,r=0,o=0;for(let a=0;a<e.length;a++){const c=e[a],l=c[0],h=c;switch(l){case"M":r=h[1],o=h[2],t.moveTo(r,o);break;case"m":r+=h[1],o+=h[2],t.moveTo(r,o);break;case"H":r=h[1],t.lineTo(r,o);break;case"h":r+=h[1],t.lineTo(r,o);break;case"V":o=h[1],t.lineTo(r,o);break;case"v":o+=h[1],t.lineTo(r,o);break;case"L":r=h[1],o=h[2],t.lineTo(r,o);break;case"l":r+=h[1],o+=h[2],t.lineTo(r,o);break;case"C":r=h[5],o=h[6],t.bezierCurveTo(h[1],h[2],h[3],h[4],r,o);break;case"c":t.bezierCurveTo(r+h[1],o+h[2],r+h[3],o+h[4],r+h[5],o+h[6]),r+=h[5],o+=h[6];break;case"S":r=h[3],o=h[4],t.bezierCurveToShort(h[1],h[2],r,o);break;case"s":t.bezierCurveToShort(r+h[1],o+h[2],r+h[3],o+h[4]),r+=h[3],o+=h[4];break;case"Q":r=h[3],o=h[4],t.quadraticCurveTo(h[1],h[2],r,o);break;case"q":t.quadraticCurveTo(r+h[1],o+h[2],r+h[3],o+h[4]),r+=h[3],o+=h[4];break;case"T":r=h[1],o=h[2],t.quadraticCurveToShort(r,o);break;case"t":r+=h[1],o+=h[2],t.quadraticCurveToShort(r,o);break;case"A":r=h[6],o=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,o);break;case"a":r+=h[6],o+=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,o);break;case"Z":case"z":t.closePath(),n.length>0&&(i=n.pop(),i?(r=i.startX,o=i.startY):(r=0,o=0)),i=null;break;default:kt(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&i===null&&(i={startX:r,startY:o},n.push(i))}return t}class At{constructor(t=0,e=0,n=0){this.type="circle",this.x=t,this.y=e,this.radius=n}clone(){return new At(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-t,r=this.y-e;return i*=i,r*=r,i+r<=n}strokeContains(t,e,n,i=.5){if(this.radius===0)return!1;const r=this.x-t,o=this.y-e,a=this.radius,c=(1-i)*n,l=Math.sqrt(r*r+o*o);return l<=a+c&&l>a-(n-c)}getBounds(t){return t||(t=new j),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class qt{constructor(t=0,e=0,n=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=n,this.halfHeight=i}clone(){return new qt(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return n*=n,i*=i,n+i<=1}strokeContains(t,e,n,i=.5){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const a=n*(1-i),c=n-a,l=r-c,h=o-c,d=r+a,f=o+a,u=t-this.x,x=e-this.y,y=u*u/(l*l)+x*x/(h*h),p=u*u/(d*d)+x*x/(f*f);return y>1&&p<=1}getBounds(t){return t||(t=new j),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function fn(s,t,e,n,i,r){const o=s-e,a=t-n,c=i-e,l=r-n,h=o*c+a*l,d=c*c+l*l;let f=-1;d!==0&&(f=h/d);let u,x;f<0?(u=e,x=n):f>1?(u=i,x=r):(u=e+f*c,x=n+f*l);const y=s-u,p=t-x;return y*y+p*p}let xn,yn;class ht{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let i=0,r=e.length;i<r;i++)n.push(e[i].x,e[i].y);e=n}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,n=e.length;for(let i=0;i<n;i+=2){const r=e[i],o=e[i+1],a=e[(i+2)%n],c=e[(i+3)%n];t+=(a-r)*(c+o)}return t<0}containsPolygon(t){const e=this.getBounds(xn),n=t.getBounds(yn);if(!e.containsRect(n))return!1;const i=t.points;for(let r=0;r<i.length;r+=2){const o=i[r],a=i[r+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new ht(t);return e.closePath=this.closePath,e}contains(t,e){let n=!1;const i=this.points.length/2;for(let r=0,o=i-1;r<i;o=r++){const a=this.points[r*2],c=this.points[r*2+1],l=this.points[o*2],h=this.points[o*2+1];c>e!=h>e&&t<(l-a)*((e-c)/(h-c))+a&&(n=!n)}return n}strokeContains(t,e,n,i=.5){const r=n*n,o=r*(1-i),a=r-o,{points:c}=this,l=c.length-(this.closePath?0:2);for(let h=0;h<l;h+=2){const d=c[h],f=c[h+1],u=c[(h+2)%c.length],x=c[(h+3)%c.length],y=fn(t,e,d,f,u,x),p=Math.sign((u-d)*(e-f)-(x-f)*(t-d));if(y<=(p<0?a:o))return!0}return!1}getBounds(t){t||(t=new j);const e=this.points;let n=1/0,i=-1/0,r=1/0,o=-1/0;for(let a=0,c=e.length;a<c;a+=2){const l=e[a],h=e[a+1];n=l<n?l:n,i=l>i?l:i,r=h<r?h:r,o=h>o?h:o}return t.x=n,t.width=i-n,t.y=r,t.height=o-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return lt("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return lt("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Pt=(s,t,e,n,i,r,o)=>{const a=s-e,c=t-n,l=Math.sqrt(a*a+c*c);return l>=i-r&&l<=i+o};class Bt{constructor(t=0,e=0,n=0,i=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r}getBounds(t){return t||(t=new j),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Bt(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let i=t-(this.x+n),r=e-(this.y+n);const o=n*n;if(i*i+r*r<=o||(i=t-(this.x+this.width-n),i*i+r*r<=o)||(r=e-(this.y+this.height-n),i*i+r*r<=o)||(i=t-(this.x+n),i*i+r*r<=o))return!0}return!1}strokeContains(t,e,n,i=.5){const{x:r,y:o,width:a,height:c,radius:l}=this,h=n*(1-i),d=n-h,f=r+l,u=o+l,x=a-l*2,y=c-l*2,p=r+a,b=o+c;return(t>=r-h&&t<=r+d||t>=p-d&&t<=p+h)&&e>=u&&e<=u+y||(e>=o-h&&e<=o+d||e>=b-d&&e<=b+h)&&t>=f&&t<=f+x?!0:t<f&&e<u&&Pt(t,e,f,u,l,d,h)||t>p-l&&e<u&&Pt(t,e,p-l,u,l,d,h)||t>p-l&&e>b-l&&Pt(t,e,p-l,b-l,l,d,h)||t<f&&e>b-l&&Pt(t,e,f,b-l,l,d,h)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}function pn(s,t,e,n,i,r,o,a=null){let c=0;e*=t,i*=r;const l=a.a,h=a.b,d=a.c,f=a.d,u=a.tx,x=a.ty;for(;c<o;){const y=s[e],p=s[e+1];n[i]=l*y+d*p+u,n[i+1]=h*y+f*p+x,i+=r,e+=t,c++}}function gn(s,t,e,n){let i=0;for(t*=e;i<n;)s[t]=0,s[t+1]=0,t+=e,i++}function be(s,t,e,n,i){const r=t.a,o=t.b,a=t.c,c=t.d,l=t.tx,h=t.ty;e||(e=0),n||(n=2),i||(i=s.length/n-e);let d=e*n;for(let f=0;f<i;f++){const u=s[d],x=s[d+1];s[d]=r*u+a*x+l,s[d+1]=o*u+c*x+h,d+=n}}const mn=new A;class _e{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,n=this.renderable;return n?Fe(e,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||mn}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher.destroy(),this._batcher=null,this._batch.destroy(),this._batch=null}}const xt={extension:{type:E.ShapeBuilder,name:"circle"},build(s,t){let e,n,i,r,o,a;if(s.type==="circle"){const m=s;if(o=a=m.radius,o<=0)return!1;e=m.x,n=m.y,i=r=0}else if(s.type==="ellipse"){const m=s;if(o=m.halfWidth,a=m.halfHeight,o<=0||a<=0)return!1;e=m.x,n=m.y,i=r=0}else{const m=s,T=m.width/2,P=m.height/2;e=m.x+T,n=m.y+P,o=a=Math.max(0,Math.min(m.radius,Math.min(T,P))),i=T-o,r=P-a}if(i<0||r<0)return!1;const c=Math.ceil(2.3*Math.sqrt(o+a)),l=c*8+(i?4:0)+(r?4:0);if(l===0)return!1;if(c===0)return t[0]=t[6]=e+i,t[1]=t[3]=n+r,t[2]=t[4]=e-i,t[5]=t[7]=n-r,!0;let h=0,d=c*4+(i?2:0)+2,f=d,u=l,x=i+o,y=r,p=e+x,b=e-x,g=n+y;if(t[h++]=p,t[h++]=g,t[--d]=g,t[--d]=b,r){const m=n-y;t[f++]=b,t[f++]=m,t[--u]=m,t[--u]=p}for(let m=1;m<c;m++){const T=Math.PI/2*(m/c),P=i+Math.cos(T)*o,_=r+Math.sin(T)*a,I=e+P,v=e-P,S=n+_,w=n-_;t[h++]=I,t[h++]=S,t[--d]=S,t[--d]=v,t[f++]=v,t[f++]=w,t[--u]=w,t[--u]=I}x=i,y=r+a,p=e+x,b=e-x,g=n+y;const M=n-y;return t[h++]=p,t[h++]=g,t[--u]=M,t[--u]=p,i&&(t[h++]=b,t[h++]=g,t[--u]=M,t[--u]=b),!0},triangulate(s,t,e,n,i,r){if(s.length===0)return;let o=0,a=0;for(let h=0;h<s.length;h+=2)o+=s[h],a+=s[h+1];o/=s.length/2,a/=s.length/2;let c=n;t[c*e]=o,t[c*e+1]=a;const l=c++;for(let h=0;h<s.length;h+=2)t[c*e]=s[h],t[c*e+1]=s[h+1],h>0&&(i[r++]=c,i[r++]=l,i[r++]=c-1),c++;i[r++]=l+1,i[r++]=l,i[r++]=c-1}},bn={...xt,extension:{...xt.extension,name:"ellipse"}},_n={...xt,extension:{...xt.extension,name:"roundedRectangle"}},Pe=1e-4,Jt=1e-4;function Pn(s){const t=s.length;if(t<6)return 1;let e=0;for(let n=0,i=s[t-2],r=s[t-1];n<t;n+=2){const o=s[n],a=s[n+1];e+=(o-i)*(a+r),i=o,r=a}return e<0?-1:1}function te(s,t,e,n,i,r,o,a){const c=s-e*i,l=t-n*i,h=s+e*r,d=t+n*r;let f,u;o?(f=n,u=-e):(f=-n,u=e);const x=c+f,y=l+u,p=h+f,b=d+u;return a.push(x,y),a.push(p,b),2}function U(s,t,e,n,i,r,o,a){const c=e-s,l=n-t;let h=Math.atan2(c,l),d=Math.atan2(i-s,r-t);a&&h<d?h+=Math.PI*2:!a&&h>d&&(d+=Math.PI*2);let f=h;const u=d-h,x=Math.abs(u),y=Math.sqrt(c*c+l*l),p=(15*x*Math.sqrt(y)/Math.PI>>0)+1,b=u/p;if(f+=b,a){o.push(s,t),o.push(e,n);for(let g=1,M=f;g<p;g++,M+=b)o.push(s,t),o.push(s+Math.sin(M)*y,t+Math.cos(M)*y);o.push(s,t),o.push(i,r)}else{o.push(e,n),o.push(s,t);for(let g=1,M=f;g<p;g++,M+=b)o.push(s+Math.sin(M)*y,t+Math.cos(M)*y),o.push(s,t);o.push(i,r),o.push(s,t)}return p*2}function Mn(s,t,e,n,i,r){const o=Pe;if(s.length===0)return;const a=t;let c=a.alignment;if(t.alignment!==.5){let R=Pn(s);e&&(R*=-1),c=(c-.5)*R+.5}const l=new K(s[0],s[1]),h=new K(s[s.length-2],s[s.length-1]),d=n,f=Math.abs(l.x-h.x)<o&&Math.abs(l.y-h.y)<o;if(d){s=s.slice(),f&&(s.pop(),s.pop(),h.set(s[s.length-2],s[s.length-1]));const R=(l.x+h.x)*.5,B=(h.y+l.y)*.5;s.unshift(R,B),s.push(R,B)}const u=i,x=s.length/2;let y=s.length;const p=u.length/2,b=a.width/2,g=b*b,M=a.miterLimit*a.miterLimit;let m=s[0],T=s[1],P=s[2],_=s[3],I=0,v=0,S=-(T-_),w=m-P,H=0,F=0,z=Math.sqrt(S*S+w*w);S/=z,w/=z,S*=b,w*=b;const Q=c,k=(1-Q)*2,C=Q*2;d||(a.cap==="round"?y+=U(m-S*(k-C)*.5,T-w*(k-C)*.5,m-S*k,T-w*k,m+S*C,T+w*C,u,!0)+2:a.cap==="square"&&(y+=te(m,T,S,w,k,C,!0,u))),u.push(m-S*k,T-w*k),u.push(m+S*C,T+w*C);for(let R=1;R<x-1;++R){m=s[(R-1)*2],T=s[(R-1)*2+1],P=s[R*2],_=s[R*2+1],I=s[(R+1)*2],v=s[(R+1)*2+1],S=-(T-_),w=m-P,z=Math.sqrt(S*S+w*w),S/=z,w/=z,S*=b,w*=b,H=-(_-v),F=P-I,z=Math.sqrt(H*H+F*F),H/=z,F/=z,H*=b,F*=b;const B=P-m,tt=T-_,et=P-I,nt=v-_,jt=B*et+tt*nt,pt=tt*et-nt*B,st=pt<0;if(Math.abs(pt)<.001*Math.abs(jt)){u.push(P-S*k,_-w*k),u.push(P+S*C,_+w*C),jt>=0&&(a.join==="round"?y+=U(P,_,P-S*k,_-w*k,P-H*k,_-F*k,u,!1)+4:y+=2,u.push(P-H*C,_-F*C),u.push(P+H*k,_+F*k));continue}const Nt=(-S+m)*(-w+_)-(-S+P)*(-w+T),$t=(-H+I)*(-F+_)-(-H+P)*(-F+v),gt=(B*$t-et*Nt)/pt,mt=(nt*Nt-tt*$t)/pt,Tt=(gt-P)*(gt-P)+(mt-_)*(mt-_),N=P+(gt-P)*k,$=_+(mt-_)*k,Z=P-(gt-P)*C,V=_-(mt-_)*C,ve=Math.min(B*B+tt*tt,et*et+nt*nt),Zt=st?k:C,Ie=ve+Zt*Zt*g;Tt<=Ie?a.join==="bevel"||Tt/g>M?(st?(u.push(N,$),u.push(P+S*C,_+w*C),u.push(N,$),u.push(P+H*C,_+F*C)):(u.push(P-S*k,_-w*k),u.push(Z,V),u.push(P-H*k,_-F*k),u.push(Z,V)),y+=2):a.join==="round"?st?(u.push(N,$),u.push(P+S*C,_+w*C),y+=U(P,_,P+S*C,_+w*C,P+H*C,_+F*C,u,!0)+4,u.push(N,$),u.push(P+H*C,_+F*C)):(u.push(P-S*k,_-w*k),u.push(Z,V),y+=U(P,_,P-S*k,_-w*k,P-H*k,_-F*k,u,!1)+4,u.push(P-H*k,_-F*k),u.push(Z,V)):(u.push(N,$),u.push(Z,V)):(u.push(P-S*k,_-w*k),u.push(P+S*C,_+w*C),a.join==="round"?st?y+=U(P,_,P+S*C,_+w*C,P+H*C,_+F*C,u,!0)+2:y+=U(P,_,P-S*k,_-w*k,P-H*k,_-F*k,u,!1)+2:a.join==="miter"&&Tt/g<=M&&(st?(u.push(Z,V),u.push(Z,V)):(u.push(N,$),u.push(N,$)),y+=2),u.push(P-H*k,_-F*k),u.push(P+H*C,_+F*C),y+=2)}m=s[(x-2)*2],T=s[(x-2)*2+1],P=s[(x-1)*2],_=s[(x-1)*2+1],S=-(T-_),w=m-P,z=Math.sqrt(S*S+w*w),S/=z,w/=z,S*=b,w*=b,u.push(P-S*k,_-w*k),u.push(P+S*C,_+w*C),d||(a.cap==="round"?y+=U(P-S*(k-C)*.5,_-w*(k-C)*.5,P-S*k,_-w*k,P+S*C,_+w*C,u,!1)+2:a.cap==="square"&&(y+=te(P,_,S,w,k,C,!1,u)));const J=Jt*Jt;for(let R=p;R<y+p-2;++R)m=u[R*2],T=u[R*2+1],P=u[(R+1)*2],_=u[(R+1)*2+1],I=u[(R+2)*2],v=u[(R+2)*2+1],!(Math.abs(m*(_-v)+P*(v-T)+I*(T-_))<J)&&r.push(R,R+1,R+2)}function Sn(s,t,e,n){const i=Pe;if(s.length===0)return;const r=s[0],o=s[1],a=s[s.length-2],c=s[s.length-1],l=t||Math.abs(r-a)<i&&Math.abs(o-c)<i,h=e,d=s.length/2,f=h.length/2;for(let u=0;u<d;u++)h.push(s[u*2]),h.push(s[u*2+1]);for(let u=0;u<d-1;u++)n.push(f+u,f+u+1);l&&n.push(f+d-1,f)}function Me(s,t,e,n,i,r,o){const a=nn(s,t,2);if(!a)return;for(let l=0;l<a.length;l+=3)r[o++]=a[l]+i,r[o++]=a[l+1]+i,r[o++]=a[l+2]+i;let c=i*n;for(let l=0;l<s.length;l+=2)e[c]=s[l],e[c+1]=s[l+1],c+=n}const kn=[],wn={extension:{type:E.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,n,i,r){Me(s,kn,t,e,n,i,r)}},Tn={extension:{type:E.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,n=e.x,i=e.y,r=e.width,o=e.height;return r>0&&o>0?(t[0]=n,t[1]=i,t[2]=n+r,t[3]=i,t[4]=n+r,t[5]=i+o,t[6]=n,t[7]=i+o,!0):!1},triangulate(s,t,e,n,i,r){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[6],t[n+o+1]=s[7],o+=e,t[n+o]=s[4],t[n+o+1]=s[5],o+=e;const a=n/e;i[r++]=a,i[r++]=a+1,i[r++]=a+2,i[r++]=a+1,i[r++]=a+3,i[r++]=a+2}},Cn={extension:{type:E.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,n,i,r){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[4],t[n+o+1]=s[5];const a=n/e;i[r++]=a,i[r++]=a+1,i[r++]=a+2}},vn=new A,In=new j;function Rn(s,t,e,n){const i=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const o=e.getBounds(In);t.width&&o.pad(t.width);const{x:a,y:c}=o,l=1/o.width,h=1/o.height,d=-a*l,f=-c*h,u=i.a,x=i.b,y=i.c,p=i.d;i.a*=l,i.b*=l,i.c*=h,i.d*=h,i.tx=d*u+f*y+i.tx,i.ty=d*x+f*p+i.ty}else i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return!(t.fill instanceof yt)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),n&&i.append(vn.copyFrom(n).invert()),i}const wt={};fe.handleByMap(E.ShapeBuilder,wt);fe.add(Tn,wn,Cn,xt,bn,_n);const Hn=new j,Fn=new A;function zn(s,t){const{geometryData:e,batches:n}=t;n.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let i=0;i<s.instructions.length;i++){const r=s.instructions[i];if(r.action==="texture")Dn(r.data,n,e);else if(r.action==="fill"||r.action==="stroke"){const o=r.action==="stroke",a=r.data.path.shapePath,c=r.data.style,l=r.data.hole;o&&l&&ee(l.shapePath,c,!0,n,e),l&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),ee(a,c,o,n,e)}}}function Dn(s,t,e){const n=[],i=wt.rectangle,r=Hn;r.x=s.dx,r.y=s.dy,r.width=s.dw,r.height=s.dh;const o=s.transform;if(!i.build(r,n))return;const{vertices:a,uvs:c,indices:l}=e,h=l.length,d=a.length/2;o&&be(n,o),i.triangulate(n,a,2,d,l,h);const f=s.image,u=f.uvs;c.push(u.x0,u.y0,u.x1,u.y1,u.x3,u.y3,u.x2,u.y2);const x=at.get(_e);x.indexOffset=h,x.indexSize=l.length-h,x.attributeOffset=d,x.attributeSize=a.length/2-d,x.baseColor=s.style,x.alpha=s.alpha,x.texture=f,x.geometryData=e,t.push(x)}function ee(s,t,e,n,i){const{vertices:r,uvs:o,indices:a}=i;s.shapePrimitives.forEach(({shape:c,transform:l,holes:h})=>{const d=[],f=wt[c.type];if(!f.build(c,d))return;const u=a.length,x=r.length/2;let y="triangle-list";if(l&&be(d,l),e){const M=c.closePath??!0,m=t;m.pixelLine?(Sn(d,M,r,a),y="line-list"):Mn(d,m,!1,M,r,a)}else if(h){const M=[],m=d.slice();Gn(h).forEach(P=>{M.push(m.length/2),m.push(...P)}),Me(m,M,r,2,x,a,u)}else f.triangulate(d,r,2,x,a,u);const p=o.length/2,b=t.texture;if(b!==X.WHITE){const M=Rn(Fn,t,c,l);pn(r,2,x,o,p,2,r.length/2-x,M)}else gn(o,p,2,r.length/2-x);const g=at.get(_e);g.indexOffset=u,g.indexSize=a.length-u,g.attributeOffset=x,g.attributeSize=r.length/2-x,g.baseColor=t.color,g.alpha=t.alpha,g.texture=b,g.geometryData=i,g.topology=y,n.push(g)})}function Gn(s){const t=[];for(let e=0;e<s.length;e++){const n=s[e].shape,i=[];wt[n.type].build(n,i)&&t.push(i)}return t}class Ln{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class An{constructor(){this.instructions=new ze}init(t){this.batcher=new Be({maxTextures:t}),this.instructions.reset()}get geometry(){return lt(De,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Et=class zt{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){zt.defaultOptions.bezierSmoothness=t?.bezierSmoothness??zt.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),zn(t,e);const n=t.batchMode;t.customShader||n==="no-batch"?e.isBatchable=!1:n==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=at.get(An,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:n,geometryData:i}=this._gpuContextHash[t.uid],r=i.vertices.length,o=i.indices.length;for(let h=0;h<n.length;h++)n[h].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(r),a.ensureIndexBuffer(o),a.begin();for(let h=0;h<n.length;h++){const d=n[h];a.add(d)}a.finish(e.instructions);const c=a.geometry;c.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),c.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const l=a.batches;for(let h=0;h<l.length;h++){const d=l[h];d.bindGroup=qe(d.textures.textures,d.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Ln;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(at.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(n=>{at.return(n)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Et.extension={type:[E.WebGLSystem,E.WebGPUSystem,E.CanvasSystem],name:"graphicsContext"};Et.defaultOptions={bezierSmoothness:.5};let Se=Et;const qn=8,Mt=11920929e-14,Bn=1;function ke(s,t,e,n,i,r,o,a,c,l){const d=Math.min(.99,Math.max(0,l??Se.defaultOptions.bezierSmoothness));let f=(Bn-d)/1;return f*=f,En(t,e,n,i,r,o,a,c,s,f),s}function En(s,t,e,n,i,r,o,a,c,l){Dt(s,t,e,n,i,r,o,a,c,l,0),c.push(o,a)}function Dt(s,t,e,n,i,r,o,a,c,l,h){if(h>qn)return;const d=(s+e)/2,f=(t+n)/2,u=(e+i)/2,x=(n+r)/2,y=(i+o)/2,p=(r+a)/2,b=(d+u)/2,g=(f+x)/2,M=(u+y)/2,m=(x+p)/2,T=(b+M)/2,P=(g+m)/2;if(h>0){let _=o-s,I=a-t;const v=Math.abs((e-o)*I-(n-a)*_),S=Math.abs((i-o)*I-(r-a)*_);if(v>Mt&&S>Mt){if((v+S)*(v+S)<=l*(_*_+I*I)){c.push(T,P);return}}else if(v>Mt){if(v*v<=l*(_*_+I*I)){c.push(T,P);return}}else if(S>Mt){if(S*S<=l*(_*_+I*I)){c.push(T,P);return}}else if(_=T-(s+o)/2,I=P-(t+a)/2,_*_+I*I<=l){c.push(T,P);return}}Dt(s,t,d,f,b,g,T,P,c,l,h+1),Dt(T,P,M,m,y,p,o,a,c,l,h+1)}const Wn=8,jn=11920929e-14,Nn=1;function $n(s,t,e,n,i,r,o,a){const l=Math.min(.99,Math.max(0,a??Se.defaultOptions.bezierSmoothness));let h=(Nn-l)/1;return h*=h,Zn(t,e,n,i,r,o,s,h),s}function Zn(s,t,e,n,i,r,o,a){Gt(o,s,t,e,n,i,r,a,0),o.push(i,r)}function Gt(s,t,e,n,i,r,o,a,c){if(c>Wn)return;const l=(t+n)/2,h=(e+i)/2,d=(n+r)/2,f=(i+o)/2,u=(l+d)/2,x=(h+f)/2;let y=r-t,p=o-e;const b=Math.abs((n-r)*p-(i-o)*y);if(b>jn){if(b*b<=a*(y*y+p*p)){s.push(u,x);return}}else if(y=u-(t+r)/2,p=x-(e+o)/2,y*y+p*p<=a){s.push(u,x);return}Gt(s,t,e,l,h,u,x,a,c+1),Gt(s,u,x,d,f,r,o,a,c+1)}function we(s,t,e,n,i,r,o,a){let c=Math.abs(i-r);(!o&&i>r||o&&r>i)&&(c=2*Math.PI-c),a||(a=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(c/Math.PI)))),a=Math.max(a,3);let l=c/a,h=i;l*=o?-1:1;for(let d=0;d<a+1;d++){const f=Math.cos(h),u=Math.sin(h),x=t+f*n,y=e+u*n;s.push(x,y),h+=l}}function Vn(s,t,e,n,i,r){const o=s[s.length-2],c=s[s.length-1]-e,l=o-t,h=i-e,d=n-t,f=Math.abs(c*d-l*h);if(f<1e-8||r===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const u=c*c+l*l,x=h*h+d*d,y=c*h+l*d,p=r*Math.sqrt(u)/f,b=r*Math.sqrt(x)/f,g=p*y/u,M=b*y/x,m=p*d+b*l,T=p*h+b*c,P=l*(b+g),_=c*(b+g),I=d*(p+M),v=h*(p+M),S=Math.atan2(_-T,P-m),w=Math.atan2(v-T,I-m);we(s,m+t,T+e,r,S,w,l*h>d*c)}const ct=Math.PI*2,vt={centerX:0,centerY:0,ang1:0,ang2:0},It=({x:s,y:t},e,n,i,r,o,a,c)=>{s*=e,t*=n;const l=i*s-r*t,h=r*s+i*t;return c.x=l+o,c.y=h+a,c};function Un(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=t===1.5707963267948966?.551915024494:e,i=Math.cos(s),r=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:i-r*n,y:r+i*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]}const ne=(s,t,e,n)=>{const i=s*n-t*e<0?-1:1;let r=s*e+t*n;return r>1&&(r=1),r<-1&&(r=-1),i*Math.acos(r)},Xn=(s,t,e,n,i,r,o,a,c,l,h,d,f)=>{const u=Math.pow(i,2),x=Math.pow(r,2),y=Math.pow(h,2),p=Math.pow(d,2);let b=u*x-u*p-x*y;b<0&&(b=0),b/=u*p+x*y,b=Math.sqrt(b)*(o===a?-1:1);const g=b*i/r*d,M=b*-r/i*h,m=l*g-c*M+(s+e)/2,T=c*g+l*M+(t+n)/2,P=(h-g)/i,_=(d-M)/r,I=(-h-g)/i,v=(-d-M)/r,S=ne(1,0,P,_);let w=ne(P,_,I,v);a===0&&w>0&&(w-=ct),a===1&&w<0&&(w+=ct),f.centerX=m,f.centerY=T,f.ang1=S,f.ang2=w};function Yn(s,t,e,n,i,r,o,a=0,c=0,l=0){if(r===0||o===0)return;const h=Math.sin(a*ct/360),d=Math.cos(a*ct/360),f=d*(t-n)/2+h*(e-i)/2,u=-h*(t-n)/2+d*(e-i)/2;if(f===0&&u===0)return;r=Math.abs(r),o=Math.abs(o);const x=Math.pow(f,2)/Math.pow(r,2)+Math.pow(u,2)/Math.pow(o,2);x>1&&(r*=Math.sqrt(x),o*=Math.sqrt(x)),Xn(t,e,n,i,r,o,c,l,h,d,f,u,vt);let{ang1:y,ang2:p}=vt;const{centerX:b,centerY:g}=vt;let M=Math.abs(p)/(ct/4);Math.abs(1-M)<1e-7&&(M=1);const m=Math.max(Math.ceil(M),1);p/=m;let T=s[s.length-2],P=s[s.length-1];const _={x:0,y:0};for(let I=0;I<m;I++){const v=Un(y,p),{x:S,y:w}=It(v[0],r,o,d,h,b,g,_),{x:H,y:F}=It(v[1],r,o,d,h,b,g,_),{x:z,y:Q}=It(v[2],r,o,d,h,b,g,_);ke(s,T,P,S,w,H,F,z,Q),T=z,P=Q,y+=p}}function Qn(s,t,e){const n=(o,a)=>{const c=a.x-o.x,l=a.y-o.y,h=Math.sqrt(c*c+l*l),d=c/h,f=l/h;return{len:h,nx:d,ny:f}},i=(o,a)=>{o===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)};let r=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],c=a.radius??e;if(c<=0){i(o,a),r=a;continue}const l=t[(o+1)%t.length],h=n(a,r),d=n(a,l);if(h.len<1e-4||d.len<1e-4){i(o,a),r=a;continue}let f=Math.asin(h.nx*d.ny-h.ny*d.nx),u=1,x=!1;h.nx*d.nx-h.ny*-d.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,u=-1,x=!0):f>0&&(u=-1,x=!0);const y=f/2;let p,b=Math.abs(Math.cos(y)*c/Math.sin(y));b>Math.min(h.len/2,d.len/2)?(b=Math.min(h.len/2,d.len/2),p=Math.abs(b*Math.sin(y)/Math.cos(y))):p=c;const g=a.x+d.nx*b+-d.ny*p*u,M=a.y+d.ny*b+d.nx*p*u,m=Math.atan2(h.ny,h.nx)+Math.PI/2*u,T=Math.atan2(d.ny,d.nx)-Math.PI/2*u;o===0&&s.moveTo(g+Math.cos(m)*p,M+Math.sin(m)*p),s.arc(g,M,p,m,T,x),r=a}}function Kn(s,t,e,n){const i=(a,c)=>Math.sqrt((a.x-c.x)**2+(a.y-c.y)**2),r=(a,c,l)=>({x:a.x+(c.x-a.x)*l,y:a.y+(c.y-a.y)*l}),o=t.length;for(let a=0;a<o;a++){const c=t[(a+1)%o],l=c.radius??e;if(l<=0){a===0?s.moveTo(c.x,c.y):s.lineTo(c.x,c.y);continue}const h=t[a],d=t[(a+2)%o],f=i(h,c);let u;if(f<1e-4)u=c;else{const p=Math.min(f/2,l);u=r(c,h,p/f)}const x=i(d,c);let y;if(x<1e-4)y=c;else{const p=Math.min(x/2,l);y=r(c,d,p/x)}a===0?s.moveTo(u.x,u.y):s.lineTo(u.x,u.y),s.quadraticCurveTo(c.x,c.y,y.x,y.y,n)}}const On=new j;class Jn{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new xe,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const n=this._currentPoly.points,i=n[n.length-2],r=n[n.length-1];return(i!==t||r!==e)&&n.push(t,e),this}arc(t,e,n,i,r,o){this._ensurePoly(!1);const a=this._currentPoly.points;return we(a,t,e,n,i,r,o),this}arcTo(t,e,n,i,r){this._ensurePoly();const o=this._currentPoly.points;return Vn(o,t,e,n,i,r),this}arcToSvg(t,e,n,i,r,o,a){const c=this._currentPoly.points;return Yn(c,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,n,i,r),this}bezierCurveTo(t,e,n,i,r,o,a){this._ensurePoly();const c=this._currentPoly;return ke(this._currentPoly.points,c.lastX,c.lastY,t,e,n,i,r,o,a),this}quadraticCurveTo(t,e,n,i,r){this._ensurePoly();const o=this._currentPoly;return $n(this._currentPoly.points,o.lastX,o.lastY,t,e,n,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const n=this.shapePrimitives,i=n.length;for(let r=0;r<t.instructions.length;r++){const o=t.instructions[r];this[o.action](...o.data)}if(t.checkForHoles&&n.length-i>1){let r=null;for(let o=i;o<n.length;o++){const a=n[o];if(a.shape.type==="polygon"){const c=a.shape,l=r?.shape;l&&l.containsPolygon(c)?(r.holes||(r.holes=[]),r.holes.push(a),n.copyWithin(o,o+1),n.length--,o--):r=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,n,i,r){return this.drawShape(new j(t,e,n,i),r),this}circle(t,e,n,i){return this.drawShape(new At(t,e,n),i),this}poly(t,e,n){const i=new ht(t);return i.closePath=e,this.drawShape(i,n),this}regularPoly(t,e,n,i,r=0,o){i=Math.max(i|0,3);const a=-1*Math.PI/2+r,c=Math.PI*2/i,l=[];for(let h=0;h<i;h++){const d=a-h*c;l.push(t+n*Math.cos(d),e+n*Math.sin(d))}return this.poly(l,!0,o),this}roundPoly(t,e,n,i,r,o=0,a){if(i=Math.max(i|0,3),r<=0)return this.regularPoly(t,e,n,i,o);const c=n*Math.sin(Math.PI/i)-.001;r=Math.min(r,c);const l=-1*Math.PI/2+o,h=Math.PI*2/i,d=(i-2)*Math.PI/i/2;for(let f=0;f<i;f++){const u=f*h+l,x=t+n*Math.cos(u),y=e+n*Math.sin(u),p=u+Math.PI+d,b=u-Math.PI-d,g=x+r*Math.cos(p),M=y+r*Math.sin(p),m=x+r*Math.cos(b),T=y+r*Math.sin(b);f===0?this.moveTo(g,M):this.lineTo(g,M),this.quadraticCurveTo(x,y,m,T,a)}return this.closePath()}roundShape(t,e,n=!1,i){return t.length<3?this:(n?Kn(this,t,e,i):Qn(this,t,e),this.closePath())}filletRect(t,e,n,i,r){if(r===0)return this.rect(t,e,n,i);const o=Math.min(n,i)/2,a=Math.min(o,Math.max(-o,r)),c=t+n,l=e+i,h=a<0?-a:0,d=Math.abs(a);return this.moveTo(t,e+d).arcTo(t+h,e+h,t+d,e,d).lineTo(c-d,e).arcTo(c-h,e+h,c,e+d,d).lineTo(c,l-d).arcTo(c-h,l-h,t+n-d,l,d).lineTo(t+d,l).arcTo(t+h,l-h,t,l-d,d).closePath()}chamferRect(t,e,n,i,r,o){if(r<=0)return this.rect(t,e,n,i);const a=Math.min(r,Math.min(n,i)/2),c=t+n,l=e+i,h=[t+a,e,c-a,e,c,e+a,c,l-a,c-a,l,t+a,l,t,l-a,t,e+a];for(let d=h.length-1;d>=2;d-=2)h[d]===h[d-2]&&h[d-1]===h[d-3]&&h.splice(d-1,2);return this.poly(h,!0,o)}ellipse(t,e,n,i,r){return this.drawShape(new qt(t,e,n,i),r),this}roundRect(t,e,n,i,r,o){return this.drawShape(new Bt(t,e,n,i,r),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let n=this._currentPoly;return n&&this.endPoly(),n=new ht,n.points.push(t,e),this._currentPoly=n,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new ht,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let n=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,o=n;n=r.a*n+r.c*i+r.tx,i=r.b*o+r.d*i+r.ty}this._currentPoly.points.push(n,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const n=t.instructions[e];this[n.action](...n.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let n=0;n<e.length;n++){const i=e[n],r=i.shape.getBounds(On);i.transform?t.addRect(r,i.transform):t.addRect(r)}return t}}class q{constructor(t,e=!1){this.instructions=[],this.uid=St("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?dn(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new Jn(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,n,i,r){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(K.shared);let c=0,l=0;if(!o||o.action!=="bezierCurveTo")c=a.x,l=a.y;else{c=o.data[2],l=o.data[3];const h=a.x,d=a.y;c=h+(h-c),l=d+(d-l)}return this.instructions.push({action:"bezierCurveTo",data:[c,l,t,e,n,i,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,n){const i=this.instructions[this.instructions.length-1],r=this.getLastPoint(K.shared);let o=0,a=0;if(!i||i.action!=="quadraticCurveTo")o=r.x,a=r.y;else{o=i.data[0],a=i.data[1];const c=r.x,l=r.y;o=c+(c-o),a=l+(l-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,n]}),this._dirty=!0,this}rect(t,e,n,i,r){return this.instructions.push({action:"rect",data:[t,e,n,i,r]}),this._dirty=!0,this}circle(t,e,n,i){return this.instructions.push({action:"circle",data:[t,e,n,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,n,i,r,o,a){r||(r=i/2);const c=-1*Math.PI/2+o,l=n*2,h=Math.PI*2/l,d=[];for(let f=0;f<l;f++){const u=f%2?r:i,x=f*h+c;d.push(t+u*Math.cos(x),e+u*Math.sin(x))}return this.poly(d,!0,a),this}clone(t=!1){const e=new q;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const i=this.instructions[n];e.instructions.push({action:i.action,data:i.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,n=t.b,i=t.c,r=t.d,o=t.tx,a=t.ty;let c=0,l=0,h=0,d=0,f=0,u=0,x=0,y=0;for(let p=0;p<this.instructions.length;p++){const b=this.instructions[p],g=b.data;switch(b.action){case"moveTo":case"lineTo":c=g[0],l=g[1],g[0]=e*c+i*l+o,g[1]=n*c+r*l+a;break;case"bezierCurveTo":h=g[0],d=g[1],f=g[2],u=g[3],c=g[4],l=g[5],g[0]=e*h+i*d+o,g[1]=n*h+r*d+a,g[2]=e*f+i*u+o,g[3]=n*f+r*u+a,g[4]=e*c+i*l+o,g[5]=n*c+r*l+a;break;case"quadraticCurveTo":h=g[0],d=g[1],c=g[2],l=g[3],g[0]=e*h+i*d+o,g[1]=n*h+r*d+a,g[2]=e*c+i*l+o,g[3]=n*c+r*l+a;break;case"arcToSvg":c=g[5],l=g[6],x=g[0],y=g[1],g[0]=e*x+i*y,g[1]=n*x+r*y,g[5]=e*c+i*l+o,g[6]=n*c+r*l+a;break;case"circle":g[4]=it(g[3],t);break;case"rect":g[4]=it(g[4],t);break;case"ellipse":g[8]=it(g[8],t);break;case"roundRect":g[5]=it(g[5],t);break;case"addPath":g[0].transform(t);break;case"poly":g[2]=it(g[2],t);break;default:kt("unknown transform action",b.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,n=this.instructions[e];if(!n)return t.x=0,t.y=0,t;for(;n.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;n=this.instructions[e]}switch(n.action){case"moveTo":case"lineTo":t.x=n.data[0],t.y=n.data[1];break;case"quadraticCurveTo":t.x=n.data[2],t.y=n.data[3];break;case"bezierCurveTo":t.x=n.data[4],t.y=n.data[5];break;case"arc":case"arcToSvg":t.x=n.data[5],t.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(t);break}return t}}function it(s,t){return s?s.prepend(t):t.clone()}function G(s,t,e){const n=s.getAttribute(t);return n?Number(n):e}function ts(s,t){const e=s.querySelectorAll("defs");for(let n=0;n<e.length;n++){const i=e[n];for(let r=0;r<i.children.length;r++){const o=i.children[r];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=es(o);break;case"radialgradient":t.defs[o.id]=ns();break}}}}function es(s){const t=G(s,"x1",0),e=G(s,"y1",0),n=G(s,"x2",1),i=G(s,"y2",0),r=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new yt(t,e,n,i,r==="objectBoundingBox"?"local":"global");for(let a=0;a<s.children.length;a++){const c=s.children[a],l=G(c,"offset",0),h=W.shared.setValue(c.getAttribute("stop-color")).toNumber();o.addColorStop(l,h)}return o}function ns(s){return kt("[SVG Parser] Radial gradients are not yet supported"),new yt(0,0,1,0)}function se(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const ie={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Te(s,t){const e=s.getAttribute("style"),n={},i={},r={strokeStyle:n,fillStyle:i,useFill:!1,useStroke:!1};for(const o in ie){const a=s.getAttribute(o);a&&re(t,r,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const c=o[a].trim(),[l,h]=c.split(":");ie[l]&&re(t,r,l,h.trim())}}return{strokeStyle:r.useStroke?n:null,fillStyle:r.useFill?i:null,useFill:r.useFill,useStroke:r.useStroke}}function re(s,t,e,n){switch(e){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const i=se(n);t.strokeStyle.fill=s.defs[i]}else t.strokeStyle.color=W.shared.setValue(n).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const i=se(n);t.fillStyle.fill=s.defs[i]}else t.fillStyle.color=W.shared.setValue(n).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(n);break;case"stroke-opacity":t.strokeStyle.alpha=Number(n);break;case"opacity":t.fillStyle.alpha=Number(n),t.strokeStyle.alpha=Number(n);break}}function ss(s){if(s.length<=2)return!0;const t=s.map(a=>a.area).sort((a,c)=>c-a),[e,n]=t,i=t[t.length-1],r=e/n,o=n/i;return!(r>3&&o<2)}function is(s){return s.split(/(?=[Mm])/).filter(n=>n.trim().length>0)}function rs(s){const t=s.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const e=t.map(Number),n=[],i=[];for(let h=0;h<e.length;h+=2)h+1<e.length&&(n.push(e[h]),i.push(e[h+1]));if(n.length===0||i.length===0)return 0;const r=Math.min(...n),o=Math.max(...n),a=Math.min(...i),c=Math.max(...i);return(o-r)*(c-a)}function oe(s,t){const e=new q(s,!1);for(const n of e.instructions)t.instructions.push(n)}function os(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new q};ts(s,e);const n=s.children,{fillStyle:i,strokeStyle:r}=Te(s,e);for(let o=0;o<n.length;o++){const a=n[o];a.nodeName.toLowerCase()!=="defs"&&Ce(a,e,i,r)}return t}function Ce(s,t,e,n){const i=s.children,{fillStyle:r,strokeStyle:o}=Te(s,t);r&&e?e={...e,...r}:r&&(e=r),o&&n?n={...n,...o}:o&&(n=o);const a=!e&&!n;a&&(e={color:0});let c,l,h,d,f,u,x,y,p,b,g,M,m,T,P,_,I;switch(s.nodeName.toLowerCase()){case"path":{T=s.getAttribute("d");const v=s.getAttribute("fill-rule"),S=is(T),w=v==="evenodd",H=S.length>1;if(w&&H){const z=S.map(k=>({path:k,area:rs(k)}));if(z.sort((k,C)=>C.area-k.area),S.length>3||!ss(z))for(let k=0;k<z.length;k++){const C=z[k],J=k===0;t.context.beginPath();const R=new q(void 0,!0);oe(C.path,R),t.context.path(R),J?(e&&t.context.fill(e),n&&t.context.stroke(n)):t.context.cut()}else for(let k=0;k<z.length;k++){const C=z[k],J=k%2===1;t.context.beginPath();const R=new q(void 0,!0);oe(C.path,R),t.context.path(R),J?t.context.cut():(e&&t.context.fill(e),n&&t.context.stroke(n))}}else{const z=v?v==="evenodd":!0;P=new q(T,z),t.context.path(P),e&&t.context.fill(e),n&&t.context.stroke(n)}break}case"circle":x=G(s,"cx",0),y=G(s,"cy",0),p=G(s,"r",0),t.context.ellipse(x,y,p,p),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"rect":c=G(s,"x",0),l=G(s,"y",0),_=G(s,"width",0),I=G(s,"height",0),b=G(s,"rx",0),g=G(s,"ry",0),b||g?t.context.roundRect(c,l,_,I,b||g):t.context.rect(c,l,_,I),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"ellipse":x=G(s,"cx",0),y=G(s,"cy",0),b=G(s,"rx",0),g=G(s,"ry",0),t.context.beginPath(),t.context.ellipse(x,y,b,g),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"line":h=G(s,"x1",0),d=G(s,"y1",0),f=G(s,"x2",0),u=G(s,"y2",0),t.context.beginPath(),t.context.moveTo(h,d),t.context.lineTo(f,u),n&&t.context.stroke(n);break;case"polygon":m=s.getAttribute("points"),M=m.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(M,!0),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"polyline":m=s.getAttribute("points"),M=m.match(/\d+/g).map(v=>parseInt(v,10)),t.context.poly(M,!1),n&&t.context.stroke(n);break;case"g":case"svg":break;default:{kt(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}a&&(e=null);for(let v=0;v<i.length;v++)Ce(i[v],t,e,n)}function as(s){return W.isColorLike(s)}function ae(s){return s instanceof rn}function he(s){return s instanceof yt}function hs(s){return s instanceof X}function cs(s,t,e){const n=W.shared.setValue(t??0);return s.color=n.toNumber(),s.alpha=n.alpha===1?e.alpha:n.alpha,s.texture=X.WHITE,{...e,...s}}function ls(s,t,e){return s.texture=t,{...e,...s}}function ce(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function le(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function us(s,t){const e={...t,...s},n=W.shared.setValue(e.color);return e.alpha*=n.alpha,e.color=n.toNumber(),e}function ot(s,t){if(s==null)return null;const e={},n=s;return as(s)?cs(e,s,t):hs(s)?ls(e,s,t):ae(s)?ce(e,s,t):he(s)?le(e,s,t):n.fill&&ae(n.fill)?ce(n,n.fill,t):n.fill&&he(n.fill)?le(n,n.fill,t):us(n,t)}function ue(s,t){const{width:e,alignment:n,miterLimit:i,cap:r,join:o,pixelLine:a,...c}=t,l=ot(s,c);return l?{width:e,alignment:n,miterLimit:i,cap:r,join:o,pixelLine:a,...l}:null}const ds=new K,de=new A,Wt=class L extends Ge{constructor(){super(...arguments),this.uid=St("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new q,this._transform=new A,this._fillStyle={...L.defaultFillStyle},this._strokeStyle={...L.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new xe,this._boundsDirty=!0}clone(){const t=new L;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=ot(t,L.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=ue(t,L.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=ot(t,L.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=ot(t,L.defaultStrokeStyle),this}texture(t,e,n,i,r,o){return this.instructions.push({action:"texture",data:{image:t,dx:n||0,dy:i||0,dw:r||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?W.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new q,this}fill(t,e){let n;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i&&i.action==="stroke"?n=i.data.path:n=this._activePath.clone(),n?(t!=null&&(e!==void 0&&typeof t=="number"&&(lt(Le,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=ot(t,L.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(K.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n&&n.action==="fill"?e=n.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=ue(t,L.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],n=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(n);else{e.data.hole=n;break}}return this._initNextPathLocation(),this}arc(t,e,n,i,r,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,n,i,r,o),this}arcTo(t,e,n,i,r){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,r),this}arcToSvg(t,e,n,i,r,o,a){this._tick++;const c=this._transform;return this._activePath.arcToSvg(t,e,n,i,r,c.a*o+c.c*a+c.tx,c.b*o+c.d*a+c.ty),this}bezierCurveTo(t,e,n,i,r,o,a){this._tick++;const c=this._transform;return this._activePath.bezierCurveTo(c.a*t+c.c*e+c.tx,c.b*t+c.d*e+c.ty,c.a*n+c.c*i+c.tx,c.b*n+c.d*i+c.ty,c.a*r+c.c*o+c.tx,c.b*r+c.d*o+c.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,n,i){return this._tick++,this._activePath.ellipse(t,e,n,i,this._transform.clone()),this}circle(t,e,n){return this._tick++,this._activePath.circle(t,e,n,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty),this}moveTo(t,e){this._tick++;const n=this._transform,i=this._activePath.instructions,r=n.a*t+n.c*e+n.tx,o=n.b*t+n.d*e+n.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=r,i[0].data[1]=o,this):(this._activePath.moveTo(r,o),this)}quadraticCurveTo(t,e,n,i,r){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,r),this}rect(t,e,n,i){return this._tick++,this._activePath.rect(t,e,n,i,this._transform.clone()),this}roundRect(t,e,n,i,r){return this._tick++,this._activePath.roundRect(t,e,n,i,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,n,i,r=0,o){return this._tick++,this._activePath.regularPoly(t,e,n,i,r,o),this}roundPoly(t,e,n,i,r,o){return this._tick++,this._activePath.roundPoly(t,e,n,i,r,o),this}roundShape(t,e,n,i){return this._tick++,this._activePath.roundShape(t,e,n,i),this}filletRect(t,e,n,i,r){return this._tick++,this._activePath.filletRect(t,e,n,i,r),this}chamferRect(t,e,n,i,r,o){return this._tick++,this._activePath.chamferRect(t,e,n,i,r,o),this}star(t,e,n,i,r=0,o=0){return this._tick++,this._activePath.star(t,e,n,i,r,o,this._transform.clone()),this}svg(t){return this._tick++,os(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,n,i,r,o){return t instanceof A?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,n,i,r,o),this)}transform(t,e,n,i,r,o){return t instanceof A?(this._transform.append(t),this):(de.set(t,e,n,i,r,o),this._transform.append(de),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const n=this.instructions[e],i=n.action;if(i==="fill"){const r=n.data;t.addBounds(r.path.bounds)}else if(i==="texture"){const r=n.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(i==="stroke"){const r=n.data,o=r.style.alignment,a=r.style.width*(1-o),c=r.path.bounds;t.addFrame(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let n=!1;for(let i=0;i<e.length;i++){const r=e[i],o=r.data,a=o.path;if(!r.action||!a)continue;const c=o.style,l=a.shapePath.shapePrimitives;for(let h=0;h<l.length;h++){const d=l[h].shape;if(!c||!d)continue;const f=l[h].transform,u=f?f.applyInverse(t,ds):t;if(r.action==="fill")n=d.contains(u.x,u.y);else{const y=c;n=d.strokeContains(u.x,u.y,y.width,y.alignment)}const x=o.hole;if(x){const y=x.shapePath?.shapePrimitives;if(y)for(let p=0;p<y.length;p++)y[p].shape.contains(u.x,u.y)&&(n=!1)}if(n)return!0}}return n}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const n=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(n)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(n))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Wt.defaultFillStyle={color:16777215,alpha:1,texture:X.WHITE,matrix:null,fill:null,textureSpace:"local"};Wt.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:X.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let ms=Wt;export{_e as B,yt as F,ms as G,ue as a,rn as b,Se as c,ot as t};
