var fe=Object.defineProperty;var ve=(n,e,t)=>e in n?fe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var H=(n,e,t)=>(ve(n,typeof e!="symbol"?e+"":e,t),t);import{a as ne,h as pe}from"../chunks/store.11ce8278.js";import{a as B,n as U,o as N,e as K,r as ie,c as ae,d as re,v as oe,w as ce,x as de,y as ue}from"../chunks/scheduler.fce5cbda.js";import{S as j,i as F,s as C,k as P,f as L,g as x,d as m,e as g,c as b,a as D,m as M,q as u,h,z as W,v as z,w as O,l as $,x as q,p as V,n as A,o as he,y as R,r as _e}from"../chunks/index.f66cbd13.js";import{A as me}from"../chunks/index.422b0410.js";const ge={hud:!1,devMenu:!1,logConsole:!1,useLegacyBgSim:!1,forceMode:"auto"};function be(){return{}}function we(n){return{}}function ke(n){return{...n.defaults,...n.env,...n.query}}function ye(n){const e={env:be(),query:we(),defaults:ge};return ke(e)}const Ce=({url:n})=>{const e=ye();return ne.set(e),{}},Ze=Object.freeze(Object.defineProperty({__proto__:null,load:Ce},Symbol.toStringTag,{value:"Module"}));function Le(n=globalThis.devicePixelRatio||1,e=1,t=2){return Math.max(e,Math.min(t,n))}const Ie={start(n,e){const t=setInterval(e,n);return()=>clearInterval(t)}},xe=()=>document.visibilityState==="visible",Me=500;let S=null,G=performance.now();function Te(n=Ie){return{start(){S||(G=performance.now(),S=n.start(Me,()=>{if(!xe())return;const e=performance.now(),t=e-G;G=e,queueMicrotask(()=>{window.dispatchEvent(new CustomEvent("bg-tick",{detail:{dt:t}}))})}))},stop(){S&&(S(),S=null)},isRunning(){return S!==null}}}async function De(n){const e=Le(),t=new me({view:n,antialias:!1,resolution:e,autoDensity:!0,backgroundAlpha:0});await t.init({resizeTo:n.parentElement??window});const l=Te(2),s=()=>{document.hidden?(t.ticker.stopped||t.ticker.stop(),l.start()):(l.stop(),t.ticker.stopped&&t.ticker.start())};return document.addEventListener("visibilitychange",s),s(),{app:t,resize:()=>t.renderer.resize(n.clientWidth,n.clientHeight),destroy:()=>{document.removeEventListener("visibilitychange",s),l.stop(),t.destroy(!0,{children:!0})}}}class Ee{constructor(){H(this,"registration",null);H(this,"updateAvailable",!1);H(this,"installing",!1);H(this,"installed",!1);H(this,"updateCallbacks",[]);this.initializeServiceWorker()}async initializeServiceWorker(){if(typeof window>"u"||!("serviceWorker"in navigator)){console.warn("Service Worker not supported");return}try{this.registration=await navigator.serviceWorker.register("/sw.js"),console.log("Service Worker: Registered successfully"),this.registration.addEventListener("updatefound",()=>{const e=this.registration?.installing;e&&e.addEventListener("statechange",()=>{e.state==="installed"&&navigator.serviceWorker.controller&&(console.log("Service Worker: Update available"),this.updateAvailable=!0,this.notifyCallbacks())})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("Service Worker: Now controlling"),this.installed=!0,this.installing=!1,this.notifyCallbacks()})}catch(e){console.error("Service Worker registration failed:",e)}}async checkForUpdates(){if(!this.registration)return!1;try{return await this.registration.update(),this.updateAvailable}catch(e){return console.error("Failed to check for updates:",e),!1}}async applyUpdate(){if(!(!this.registration||!this.updateAvailable))try{this.installing=!0,this.notifyCallbacks(),this.registration.waiting&&this.registration.waiting.postMessage({type:"SKIP_WAITING"})}catch(e){console.error("Failed to apply update:",e),this.installing=!1,this.notifyCallbacks()}}onUpdate(e){return this.updateCallbacks.push(e),()=>{const t=this.updateCallbacks.indexOf(e);t>-1&&this.updateCallbacks.splice(t,1)}}getUpdateInfo(){return{isUpdateAvailable:this.updateAvailable,isInstalling:this.installing,isInstalled:this.installed}}canInstall(){return"serviceWorker"in navigator&&"PushManager"in window}async install(){if(!this.canInstall())return!1;try{return this.registration!==null}catch(e){return console.error("Failed to install PWA:",e),!1}}notifyCallbacks(){const e=this.getUpdateInfo();this.updateCallbacks.forEach(t=>t(e))}}let Z=null;function Q(){return Z||(Z=new Ee),Z}function J(n){let e,t,l,s='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"></path></svg>',i,o,c='<div class="update-toast__title svelte-1xi6sk9">Update Available</div> <div class="update-toast__message svelte-1xi6sk9">A new version of Draconia Chronicles is ready to install.</div>',f,a,d,y="Update",v,_,w="Later",r,p;return{c(){e=g("div"),t=g("div"),l=g("div"),l.innerHTML=s,i=C(),o=g("div"),o.innerHTML=c,f=C(),a=g("div"),d=g("button"),d.textContent=y,v=C(),_=g("button"),_.textContent=w,this.h()},l(k){e=b(k,"DIV",{class:!0,role:!0,"aria-live":!0});var I=D(e);t=b(I,"DIV",{class:!0});var T=D(t);l=b(T,"DIV",{class:!0,"data-svelte-h":!0}),M(l)!=="svelte-d4jb62"&&(l.innerHTML=s),i=L(T),o=b(T,"DIV",{class:!0,"data-svelte-h":!0}),M(o)!=="svelte-1ppd44y"&&(o.innerHTML=c),f=L(T),a=b(T,"DIV",{class:!0});var E=D(a);d=b(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),M(d)!=="svelte-rdfpo6"&&(d.textContent=y),v=L(E),_=b(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),M(_)!=="svelte-xp60fw"&&(_.textContent=w),E.forEach(m),T.forEach(m),I.forEach(m),this.h()},h(){u(l,"class","update-toast__icon svelte-1xi6sk9"),u(o,"class","update-toast__text svelte-1xi6sk9"),u(d,"class","update-toast__button update-toast__button--primary svelte-1xi6sk9"),u(d,"aria-label","Install update"),u(_,"class","update-toast__button update-toast__button--secondary svelte-1xi6sk9"),u(_,"aria-label","Dismiss update notification"),u(a,"class","update-toast__actions svelte-1xi6sk9"),u(t,"class","update-toast__content svelte-1xi6sk9"),u(e,"class","update-toast svelte-1xi6sk9"),u(e,"role","alert"),u(e,"aria-live","polite")},m(k,I){x(k,e,I),h(e,t),h(t,l),h(t,i),h(t,o),h(t,f),h(t,a),h(a,d),h(a,v),h(a,_),r||(p=[W(d,"click",n[2]),W(_,"click",n[3])],r=!0)},p:U,d(k){k&&m(e),r=!1,ie(p)}}}function X(n){let e,t='<div class="update-toast__content svelte-1xi6sk9"><div class="update-toast__icon svelte-1xi6sk9"><div class="update-toast__spinner svelte-1xi6sk9"></div></div> <div class="update-toast__text svelte-1xi6sk9"><div class="update-toast__title svelte-1xi6sk9">Installing Update</div> <div class="update-toast__message svelte-1xi6sk9">Please wait while we install the latest version...</div></div></div>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(l){e=b(l,"DIV",{class:!0,role:!0,"aria-live":!0,"data-svelte-h":!0}),M(e)!=="svelte-b76ve3"&&(e.innerHTML=t),this.h()},h(){u(e,"class","update-toast update-toast--installing svelte-1xi6sk9"),u(e,"role","status"),u(e,"aria-live","polite")},m(l,s){x(l,e,s)},d(l){l&&m(e)}}}function Ue(n){let e,t,l=n[1]&&J(n),s=n[0].isInstalling&&X();return{c(){l&&l.c(),e=C(),s&&s.c(),t=P()},l(i){l&&l.l(i),e=L(i),s&&s.l(i),t=P()},m(i,o){l&&l.m(i,o),x(i,e,o),s&&s.m(i,o),x(i,t,o)},p(i,[o]){i[1]?l?l.p(i,o):(l=J(i),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),i[0].isInstalling?s||(s=X(),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null)},i:U,o:U,d(i){i&&(m(e),m(t)),l&&l.d(i),s&&s.d(i)}}}function Ve(n,e,t){let l={isUpdateAvailable:!1,isInstalling:!1,isInstalled:!1},s=!1,i=null;N(()=>{if(typeof window>"u")return;const f=Q();i=f.onUpdate(a=>{t(0,l=a),t(1,s=a.isUpdateAvailable&&!a.isInstalling)}),f.checkForUpdates()}),K(()=>{i&&i()});async function o(){await Q().applyUpdate()}function c(){t(1,s=!1)}return[l,s,o,c]}class Ae extends j{constructor(e){super(),F(this,e,Ve,Ue,B,{})}}function Y(n){let e,t,l,s='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"></path></svg>',i,o,c='<div id="install-title" class="install-prompt__title svelte-16t91j5">Install Draconia Chronicles</div> <div id="install-description" class="install-prompt__message svelte-16t91j5">Install this app on your device for a better gaming experience with offline play.</div>',f,a,d,y="Install",v,_,w="Not now",r,p;return{c(){e=g("div"),t=g("div"),l=g("div"),l.innerHTML=s,i=C(),o=g("div"),o.innerHTML=c,f=C(),a=g("div"),d=g("button"),d.textContent=y,v=C(),_=g("button"),_.textContent=w,this.h()},l(k){e=b(k,"DIV",{class:!0,role:!0,"aria-labelledby":!0,"aria-describedby":!0});var I=D(e);t=b(I,"DIV",{class:!0});var T=D(t);l=b(T,"DIV",{class:!0,"data-svelte-h":!0}),M(l)!=="svelte-19xnkk1"&&(l.innerHTML=s),i=L(T),o=b(T,"DIV",{class:!0,"data-svelte-h":!0}),M(o)!=="svelte-13founr"&&(o.innerHTML=c),f=L(T),a=b(T,"DIV",{class:!0});var E=D(a);d=b(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),M(d)!=="svelte-1bgr1yg"&&(d.textContent=y),v=L(E),_=b(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),M(_)!=="svelte-4fzknk"&&(_.textContent=w),E.forEach(m),T.forEach(m),I.forEach(m),this.h()},h(){u(l,"class","install-prompt__icon svelte-16t91j5"),u(o,"class","install-prompt__text svelte-16t91j5"),u(d,"class","install-prompt__button install-prompt__button--primary svelte-16t91j5"),u(d,"aria-label","Install Draconia Chronicles"),u(_,"class","install-prompt__button install-prompt__button--secondary svelte-16t91j5"),u(_,"aria-label","Dismiss install prompt"),u(a,"class","install-prompt__actions svelte-16t91j5"),u(t,"class","install-prompt__content svelte-16t91j5"),u(e,"class","install-prompt svelte-16t91j5"),u(e,"role","dialog"),u(e,"aria-labelledby","install-title"),u(e,"aria-describedby","install-description")},m(k,I){x(k,e,I),h(e,t),h(t,l),h(t,i),h(t,o),h(t,f),h(t,a),h(a,d),h(a,v),h(a,_),r||(p=[W(d,"click",n[2]),W(_,"click",n[3])],r=!0)},p:U,d(k){k&&m(e),r=!1,ie(p)}}}function He(n){let e,t=n[0]&&!n[1]&&Y(n);return{c(){t&&t.c(),e=P()},l(l){t&&t.l(l),e=P()},m(l,s){t&&t.m(l,s),x(l,e,s)},p(l,[s]){l[0]&&!l[1]?t?t.p(l,s):(t=Y(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:U,o:U,d(l){l&&m(e),t&&t.d(l)}}}function $e(n,e,t){let l=null,s=!1,i=!1;N(()=>{typeof window>"u"||(window.addEventListener("beforeinstallprompt",o),window.addEventListener("appinstalled",c),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)&&t(1,i=!0))}),K(()=>{typeof window>"u"||(window.removeEventListener("beforeinstallprompt",o),window.removeEventListener("appinstalled",c))});function o(d){d.preventDefault(),l=d,t(0,s=!0)}function c(){console.log("PWA was installed"),t(1,i=!0),t(0,s=!1),l=null}async function f(){if(!l)return;l.prompt();const{outcome:d}=await l.userChoice;console.log(d==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),l=null,t(0,s=!1)}function a(){t(0,s=!1)}return[s,i,f,a]}class Se extends j{constructor(e){super(),F(this,e,$e,He,B,{})}}function ee(n){let e,t,l='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m11-7h-6m-6 0H1"></path></svg>',s,i,o,c=n[0]&&te(n);return{c(){e=g("div"),t=g("button"),t.innerHTML=l,s=C(),c&&c.c(),this.h()},l(f){e=b(f,"DIV",{class:!0});var a=D(e);t=b(a,"BUTTON",{class:!0,"aria-label":!0,title:!0,"data-svelte-h":!0}),M(t)!=="svelte-1l0x6fz"&&(t.innerHTML=l),s=L(a),c&&c.l(a),a.forEach(m),this.h()},h(){u(t,"class","dev-menu-toggle svelte-wtvn00"),u(t,"aria-label","Toggle Developer Menu"),u(t,"title","Developer Menu (dev flag enabled)"),u(e,"class","dev-menu-container svelte-wtvn00")},m(f,a){x(f,e,a),h(e,t),h(e,s),c&&c.m(e,null),i||(o=W(t,"click",n[3]),i=!0)},p(f,a){f[0]?c?c.p(f,a):(c=te(f),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&m(e),c&&c.d(),i=!1,o()}}}function te(n){let e,t,l,s="Developer Tools",i,o,c='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',f,a,d=`<a href="/dev/pool" class="dev-menu-link svelte-wtvn00"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="M21 15.5c0-1.5-1.5-3-3-3s-3 1.5-3 3"></path></svg>
            Pool Inspector</a> <a href="/dev/sim" class="dev-menu-link svelte-wtvn00"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polygon points="10,8 16,12 10,16 10,8"></polygon></svg>
            Simulation</a> <a href="/dev/logs" class="dev-menu-link svelte-wtvn00"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14,2 14,8 20,8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10,9 9,9 8,9"></polyline></svg>
            Logs Viewer</a>`,y,v,_='<small class="svelte-wtvn00">Dev mode enabled</small>',w,r;return{c(){e=g("div"),t=g("div"),l=g("h3"),l.textContent=s,i=C(),o=g("button"),o.innerHTML=c,f=C(),a=g("nav"),a.innerHTML=d,y=C(),v=g("div"),v.innerHTML=_,this.h()},l(p){e=b(p,"DIV",{class:!0});var k=D(e);t=b(k,"DIV",{class:!0});var I=D(t);l=b(I,"H3",{class:!0,"data-svelte-h":!0}),M(l)!=="svelte-14r9oc9"&&(l.textContent=s),i=L(I),o=b(I,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),M(o)!=="svelte-s24re1"&&(o.innerHTML=c),I.forEach(m),f=L(k),a=b(k,"NAV",{class:!0,"data-svelte-h":!0}),M(a)!=="svelte-nql3cc"&&(a.innerHTML=d),y=L(k),v=b(k,"DIV",{class:!0,"data-svelte-h":!0}),M(v)!=="svelte-z841cw"&&(v.innerHTML=_),k.forEach(m),this.h()},h(){u(l,"class","svelte-wtvn00"),u(o,"class","dev-menu-close svelte-wtvn00"),u(o,"aria-label","Close menu"),u(t,"class","dev-menu-header svelte-wtvn00"),u(a,"class","dev-menu-nav svelte-wtvn00"),u(v,"class","dev-menu-footer svelte-wtvn00"),u(e,"class","dev-menu-panel svelte-wtvn00")},m(p,k){x(p,e,k),h(e,t),h(t,l),h(t,i),h(t,o),h(e,f),h(e,a),h(e,y),h(e,v),n[5](e),w||(r=W(o,"click",n[4]),w=!0)},p:U,d(p){p&&m(e),n[5](null),w=!1,r()}}}function Pe(n){let e,t=n[2].devMenu&&ee(n);return{c(){t&&t.c(),e=P()},l(l){t&&t.l(l),e=P()},m(l,s){t&&t.m(l,s),x(l,e,s)},p(l,[s]){l[2].devMenu?t?t.p(l,s):(t=ee(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:U,o:U,d(l){l&&m(e),t&&t.d(l)}}}function We(n,e,t){let l;ae(n,ne,d=>t(2,l=d));let s=!1,i;function o(){t(0,s=!s)}function c(d){i&&!i.contains(d.target)&&t(0,s=!1)}N(()=>(document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}));const f=()=>t(0,s=!1);function a(d){re[d?"unshift":"push"](()=>{i=d,t(1,i)})}return[s,i,l,o,f,a]}class Be extends j{constructor(e){super(),F(this,e,We,Pe,B,{})}}const Ne=n=>({}),le=n=>({});function se(n){let e;const t=n[3].hud,l=oe(t,n,n[2],le);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,i){l&&l.m(s,i),e=!0},p(s,i){l&&l.p&&(!e||i&4)&&ce(l,t,s,s[2],e?ue(t,s[2],i,Ne):de(s[2]),le)},i(s){e||(V(l,s),e=!0)},o(s){A(l,s),e=!1},d(s){l&&l.d(s)}}}function je(n){let e,t,l,s,i,o,c,f,a,d,y,v=n[1]&&se(n);i=new Ae({}),c=new Se({}),a=new Be({});const _=n[3].default,w=oe(_,n,n[2],null);return{c(){e=g("div"),t=g("canvas"),l=C(),v&&v.c(),s=C(),z(i.$$.fragment),o=C(),z(c.$$.fragment),f=C(),z(a.$$.fragment),d=C(),w&&w.c(),this.h()},l(r){e=b(r,"DIV",{style:!0});var p=D(e);t=b(p,"CANVAS",{style:!0}),D(t).forEach(m),l=L(p),v&&v.l(p),p.forEach(m),s=L(r),O(i.$$.fragment,r),o=L(r),O(c.$$.fragment,r),f=L(r),O(a.$$.fragment,r),d=L(r),w&&w.l(r),this.h()},h(){$(t,"width","100%"),$(t,"height","100%"),$(t,"display","block"),$(e,"position","fixed"),$(e,"inset","0"),$(e,"overflow","hidden")},m(r,p){x(r,e,p),h(e,t),n[4](t),h(e,l),v&&v.m(e,null),x(r,s,p),q(i,r,p),x(r,o,p),q(c,r,p),x(r,f,p),q(a,r,p),x(r,d,p),w&&w.m(r,p),y=!0},p(r,[p]){r[1]?v?(v.p(r,p),p&2&&V(v,1)):(v=se(r),v.c(),V(v,1),v.m(e,null)):v&&(_e(),A(v,1,1,()=>{v=null}),he()),w&&w.p&&(!y||p&4)&&ce(w,_,r,r[2],y?ue(_,r[2],p,null):de(r[2]),null)},i(r){y||(V(v),V(i.$$.fragment,r),V(c.$$.fragment,r),V(a.$$.fragment,r),V(w,r),y=!0)},o(r){A(v),A(i.$$.fragment,r),A(c.$$.fragment,r),A(a.$$.fragment,r),A(w,r),y=!1},d(r){r&&(m(e),m(s),m(o),m(f),m(d)),n[4](null),v&&v.d(),R(i,r),R(c,r),R(a,r),w&&w.d(r)}}}function Fe(n,e,t){let l;ae(n,pe,a=>t(1,l=a));let{$$slots:s={},$$scope:i}=e,o,c=null;N(async()=>{c=await De(o)}),K(()=>c?.destroy());function f(a){re[a?"unshift":"push"](()=>{o=a,t(0,o)})}return n.$$set=a=>{"$$scope"in a&&t(2,i=a.$$scope)},[o,l,i,s,f]}class Ke extends j{constructor(e){super(),F(this,e,Fe,je,B,{})}}export{Ke as component,Ze as universal};
