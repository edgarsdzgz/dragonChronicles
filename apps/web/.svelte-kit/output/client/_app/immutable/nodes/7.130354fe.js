import{s as le,n as $,r as re,o as ne,b as ie}from"../chunks/scheduler.86f77edc.js";import{S as ae,i as de,b as h,s as V,t as w,f,g as y,m as W,c as I,d as x,h as T,j as e,a as se,k as l,n as ee,l as M}from"../chunks/index.e78d2784.js";import{T as pe,S as ue}from"../chunks/index.29d1603d.js";import{A as te}from"../chunks/Assets.eee396a8.js";function oe(c){let s,t,n=c[1].width+"",r,p,u=c[1].height+"",i;return{c(){s=h("div"),t=w("Texture size: "),r=w(n),p=w("x"),i=w(u),this.h()},l(g){s=f(g,"DIV",{style:!0});var o=y(s);t=T(o,"Texture size: "),r=T(o,n),p=T(o,"x"),i=T(o,u),o.forEach(x),this.h()},h(){e(s,"font-size","10px"),e(s,"color","#888")},m(g,o){se(g,s,o),l(s,t),l(s,r),l(s,p),l(s,i)},p(g,o){o&2&&n!==(n=g[1].width+"")&&M(r,n),o&2&&u!==(u=g[1].height+"")&&M(i,u)},d(g){g&&x(s)}}}function ge(c){let s,t,n,r="Final Dragon Test",p,u,i,g="Spawn Dragon",o,m,_,G="Recycle All",N,d,S,j,z,B,A,P=c[2]?"Texture loaded ✓":"Loading texture...",F,H,L,D,J,K="Not found",O,U,Q,a=c[1]&&oe(c);return{c(){s=h("div"),t=h("div"),n=h("h3"),n.textContent=r,p=V(),u=h("div"),i=h("button"),i.textContent=g,o=V(),m=h("div"),_=h("button"),_.textContent=G,N=V(),d=h("div"),S=h("div"),j=w("Spawned: "),z=w(c[0]),B=V(),A=h("div"),F=w(P),H=V(),a&&a.c(),L=V(),D=h("div"),J=w("App: "),O=w(K),this.h()},l(v){s=f(v,"DIV",{style:!0});var C=y(s);t=f(C,"DIV",{style:!0});var k=y(t);n=f(k,"H3",{style:!0,"data-svelte-h":!0}),W(n)!=="svelte-1j4fuxx"&&(n.textContent=r),p=I(k),u=f(k,"DIV",{style:!0});var X=y(u);i=f(X,"BUTTON",{style:!0,"data-svelte-h":!0}),W(i)!=="svelte-a1h3bn"&&(i.textContent=g),X.forEach(x),o=I(k),m=f(k,"DIV",{style:!0});var Y=y(m);_=f(Y,"BUTTON",{style:!0,"data-svelte-h":!0}),W(_)!=="svelte-dfc7i4"&&(_.textContent=G),Y.forEach(x),N=I(k),d=f(k,"DIV",{style:!0});var E=y(d);S=f(E,"DIV",{});var q=y(S);j=T(q,"Spawned: "),z=T(q,c[0]),q.forEach(x),B=I(E),A=f(E,"DIV",{style:!0});var Z=y(A);F=T(Z,P),Z.forEach(x),H=I(E),a&&a.l(E),L=I(E),D=f(E,"DIV",{style:!0});var R=y(D);J=T(R,"App: "),O=T(R,K),R.forEach(x),E.forEach(x),k.forEach(x),C.forEach(x),this.h()},h(){e(n,"margin","0 0 8px 0"),e(n,"font-size","14px"),e(i,"margin","2px"),e(i,"padding","6px 12px"),e(i,"background","#4CAF50"),e(u,"margin-bottom","8px"),e(_,"margin","2px"),e(_,"padding","6px 12px"),e(_,"background","#f44336"),e(m,"margin-bottom","8px"),e(A,"font-size","10px"),e(A,"color","#888"),e(D,"font-size","10px"),e(D,"color","#888"),e(d,"border-top","1px solid #444"),e(d,"padding-top","8px"),e(d,"margin-top","8px"),e(t,"position","fixed"),e(t,"right","8px"),e(t,"top","8px"),e(t,"background","rgba(0,0,0,.8)"),e(t,"color","#fff"),e(t,"padding","12px"),e(t,"border-radius","8px"),e(t,"font","12px system-ui"),e(t,"min-width","200px"),e(t,"pointer-events","auto"),e(s,"position","absolute"),e(s,"top","0"),e(s,"left","0"),e(s,"z-index","1000"),e(s,"pointer-events","none")},m(v,C){se(v,s,C),l(s,t),l(t,n),l(t,p),l(t,u),l(u,i),l(t,o),l(t,m),l(m,_),l(t,N),l(t,d),l(d,S),l(S,j),l(S,z),l(d,B),l(d,A),l(A,F),l(d,H),a&&a.m(d,null),l(d,L),l(d,D),l(D,J),l(D,O),U||(Q=[ee(i,"click",c[3]),ee(_,"click",c[4])],U=!0)},p(v,[C]){C&1&&M(z,v[0]),C&4&&P!==(P=v[2]?"Texture loaded ✓":"Loading texture...")&&M(F,P),v[1]?a?a.p(v,C):(a=oe(v),a.c(),a.m(d,L)):a&&(a.d(1),a=null)},i:$,o:$,d(v){v&&x(s),a&&a.d(),U=!1,re(Q)}}}let b=null;function ce(c,s,t){let n=0,r=null,p=!1;async function u(){try{console.log("Starting texture load with Assets system..."),te.add({alias:"dragon-sheet",src:"/sprites/dragon_fly_128_sheet.svg"}),t(1,r=await te.load("dragon-sheet")),r?(t(2,p=!0),console.log("Dragon texture loaded successfully via Assets:",{width:r.width,height:r.height})):console.error("Texture loaded but null:",r)}catch(o){console.error("Failed to load dragon texture via Assets:",o);try{console.log("Trying fallback Texture.from..."),t(1,r=pe.from("/sprites/dragon_fly_128_sheet.svg")),await new Promise(m=>setTimeout(m,2e3)),r?(t(2,p=!0),console.log("Fallback Texture.from loaded:",{width:r.width,height:r.height})):console.error("Fallback texture still null:",r)}catch(m){console.error("Fallback texture loading also failed:",m)}}}function i(){if(console.log("Spawn dragon called:",{loaded:p,dragonTexture:!!r}),!p||!r||!b){console.log("Cannot spawn dragon - not ready:",{loaded:p,textureExists:!!r,appExists:!!b});return}const o=new ue(r);o.visible=!0,o.position.set(Math.random()*(b.renderer.width-128),Math.random()*(b.renderer.height-128)),o.scale.set(.5),o.anchor.set(.5),console.log("Adding sprite to stage:",{sprite:o,position:o.position,visible:o.visible,stageChildren:b.stage.children.length,stage:b.stage}),b.stage.addChild(o),t(0,n++,n),console.log("Dragon spawned successfully, total:",n,{stageChildren:b.stage.children.length,spritePosition:o.position,spriteVisible:o.visible,rendererWidth:b.renderer.width,rendererHeight:b.renderer.height})}function g(){}return ne(async()=>{console.log("Page mounted, waiting for existing PixiJS app..."),await new Promise(o=>setTimeout(o,1e3)),console.log("Looking for existing PixiJS app..."),await u()}),ie(()=>{console.log("Page destroyed")}),[n,r,p,i,g]}class me extends ae{constructor(s){super(),de(this,s,ce,ge,le,{})}}export{me as component};
