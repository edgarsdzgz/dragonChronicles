import{s as we,n as fe,r as ye,o as Ce,b as ke,d as Ae}from"../chunks/scheduler.86f77edc.js";import{S as Te,i as Se,b as p,s as E,t as y,f,g as D,d as w,c as F,m as L,h as C,j as n,a as ce,k as o,n as Q,l as U}from"../chunks/index.e78d2784.js";import{T as me,R as De,S as ve}from"../chunks/index.29d1603d.js";import{A as Ee}from"../chunks/Application.778f7409.js";import{A as xe}from"../chunks/Assets.eee396a8.js";function be(c){let r,s,h=c[2].width+"",e,g,l=c[2].height+"",d;return{c(){r=p("div"),s=y("Texture size: "),e=y(h),g=y("x"),d=y(l),this.h()},l(a){r=f(a,"DIV",{style:!0});var i=D(r);s=C(i,"Texture size: "),e=C(i,h),g=C(i,"x"),d=C(i,l),i.forEach(w),this.h()},h(){n(r,"font-size","10px"),n(r,"color","#888")},m(a,i){ce(a,r,i),o(r,s),o(r,e),o(r,g),o(r,d)},p(a,i){i&4&&h!==(h=a[2].width+"")&&U(e,h),i&4&&l!==(l=a[2].height+"")&&U(d,l)},d(a){a&&w(r)}}}function _e(c){let r,s,h=c[3].length+"",e,g,l=c[6]+1+"",d;return{c(){r=p("div"),s=y("Frames: "),e=y(h),g=y(" | Current: "),d=y(l),this.h()},l(a){r=f(a,"DIV",{style:!0});var i=D(r);s=C(i,"Frames: "),e=C(i,h),g=C(i," | Current: "),d=C(i,l),i.forEach(w),this.h()},h(){n(r,"font-size","10px"),n(r,"color","#888")},m(a,i){ce(a,r,i),o(r,s),o(r,e),o(r,g),o(r,d)},p(a,i){i&8&&h!==(h=a[3].length+"")&&U(e,h),i&64&&l!==(l=a[6]+1+"")&&U(d,l)},d(a){a&&w(r)}}}function Fe(c){let r,s,h,e,g,l="Working Dragon Test",d,a,i,B="Spawn Dragon",I,m,X="Spawn Animated",H,V,k,J="Start Animation",q,A,Y="Stop Animation",t,b,T,Z="Recycle All",M,u,N,W,j,ae,O,G=c[4]?"Texture loaded ✓":"Loading texture...",$,ie,ee,te,R,le,K=c[5]?"Running":"Stopped",ne,se,ue,v=c[2]&&be(c),x=c[3].length>0&&_e(c);return{c(){r=p("div"),s=p("canvas"),h=E(),e=p("div"),g=p("h3"),g.textContent=l,d=E(),a=p("div"),i=p("button"),i.textContent=B,I=E(),m=p("button"),m.textContent=X,H=E(),V=p("div"),k=p("button"),k.textContent=J,q=E(),A=p("button"),A.textContent=Y,t=E(),b=p("div"),T=p("button"),T.textContent=Z,M=E(),u=p("div"),N=p("div"),W=y("Spawned: "),j=y(c[1]),ae=E(),O=p("div"),$=y(G),ie=E(),v&&v.c(),ee=E(),x&&x.c(),te=E(),R=p("div"),le=y("Animation: "),ne=y(K),this.h()},l(_){r=f(_,"DIV",{style:!0});var S=D(r);s=f(S,"CANVAS",{style:!0}),D(s).forEach(w),h=F(S),e=f(S,"DIV",{style:!0});var z=D(e);g=f(z,"H3",{style:!0,"data-svelte-h":!0}),L(g)!=="svelte-12jjc0g"&&(g.textContent=l),d=F(z),a=f(z,"DIV",{style:!0});var oe=D(a);i=f(oe,"BUTTON",{style:!0,"data-svelte-h":!0}),L(i)!=="svelte-a1h3bn"&&(i.textContent=B),I=F(oe),m=f(oe,"BUTTON",{style:!0,"data-svelte-h":!0}),L(m)!=="svelte-1s5x1mu"&&(m.textContent=X),oe.forEach(w),H=F(z),V=f(z,"DIV",{style:!0});var re=D(V);k=f(re,"BUTTON",{style:!0,"data-svelte-h":!0}),L(k)!=="svelte-190mbmn"&&(k.textContent=J),q=F(re),A=f(re,"BUTTON",{style:!0,"data-svelte-h":!0}),L(A)!=="svelte-1a6xzun"&&(A.textContent=Y),re.forEach(w),t=F(z),b=f(z,"DIV",{style:!0});var he=D(b);T=f(he,"BUTTON",{style:!0,"data-svelte-h":!0}),L(T)!=="svelte-dfc7i4"&&(T.textContent=Z),he.forEach(w),M=F(z),u=f(z,"DIV",{style:!0});var P=D(u);N=f(P,"DIV",{});var de=D(N);W=C(de,"Spawned: "),j=C(de,c[1]),de.forEach(w),ae=F(P),O=f(P,"DIV",{style:!0});var pe=D(O);$=C(pe,G),pe.forEach(w),ie=F(P),v&&v.l(P),ee=F(P),x&&x.l(P),te=F(P),R=f(P,"DIV",{style:!0});var ge=D(R);le=C(ge,"Animation: "),ne=C(ge,K),ge.forEach(w),P.forEach(w),z.forEach(w),S.forEach(w),this.h()},h(){n(s,"width","100%"),n(s,"height","100%"),n(s,"display","block"),n(g,"margin","0 0 8px 0"),n(g,"font-size","14px"),n(i,"margin","2px"),n(i,"padding","6px 12px"),n(i,"background","#4CAF50"),n(m,"margin","2px"),n(m,"padding","6px 12px"),n(m,"background","#2196F3"),n(a,"margin-bottom","8px"),n(k,"margin","2px"),n(k,"padding","6px 12px"),n(k,"background","#FF9800"),n(A,"margin","2px"),n(A,"padding","6px 12px"),n(A,"background","#9C27B0"),n(V,"margin-bottom","8px"),n(T,"margin","2px"),n(T,"padding","6px 12px"),n(T,"background","#f44336"),n(b,"margin-bottom","8px"),n(O,"font-size","10px"),n(O,"color","#888"),n(R,"font-size","10px"),n(R,"color","#888"),n(u,"border-top","1px solid #444"),n(u,"padding-top","8px"),n(u,"margin-top","8px"),n(e,"position","absolute"),n(e,"right","8px"),n(e,"top","8px"),n(e,"background","rgba(0,0,0,.8)"),n(e,"color","#fff"),n(e,"padding","12px"),n(e,"border-radius","8px"),n(e,"font","12px system-ui"),n(e,"min-width","200px"),n(r,"position","fixed"),n(r,"inset","0"),n(r,"background","#1a1a2e")},m(_,S){ce(_,r,S),o(r,s),c[12](s),o(r,h),o(r,e),o(e,g),o(e,d),o(e,a),o(a,i),o(a,I),o(a,m),o(e,H),o(e,V),o(V,k),o(V,q),o(V,A),o(e,t),o(e,b),o(b,T),o(e,M),o(e,u),o(u,N),o(N,W),o(N,j),o(u,ae),o(u,O),o(O,$),o(u,ie),v&&v.m(u,null),o(u,ee),x&&x.m(u,null),o(u,te),o(u,R),o(R,le),o(R,ne),se||(ue=[Q(i,"click",c[10]),Q(m,"click",c[7]),Q(k,"click",c[8]),Q(A,"click",c[9]),Q(T,"click",c[11])],se=!0)},p(_,[S]){S&2&&U(j,_[1]),S&16&&G!==(G=_[4]?"Texture loaded ✓":"Loading texture...")&&U($,G),_[2]?v?v.p(_,S):(v=be(_),v.c(),v.m(u,ee)):v&&(v.d(1),v=null),_[3].length>0?x?x.p(_,S):(x=_e(_),x.c(),x.m(u,te)):x&&(x.d(1),x=null),S&32&&K!==(K=_[5]?"Running":"Stopped")&&U(ne,K)},i:fe,o:fe,d(_){_&&w(r),c[12](null),v&&v.d(),x&&x.d(),se=!1,ye(ue)}}}function Ie(c,r,s){let h,e,g=0,l=null,d=[],a=!1,i=[],B=[],I=null,m=0;async function X(){try{console.log("Starting texture load with Assets system..."),xe.add({alias:"dragon-sheet",src:"/sprites/dragon_fly_128_sheet.svg"}),s(2,l=await xe.load("dragon-sheet")),l?(console.log("Dragon texture loaded successfully via Assets:",{width:l.width,height:l.height}),await H(),s(4,a=!0)):console.error("Texture loaded but null:",l)}catch(t){console.error("Failed to load dragon texture via Assets:",t);try{console.log("Trying fallback Texture.from..."),s(2,l=me.from("/sprites/dragon_fly_128_sheet.svg")),await new Promise(b=>setTimeout(b,2e3)),l?(console.log("Fallback Texture.from loaded:",{width:l.width,height:l.height}),await H(),s(4,a=!0)):console.error("Fallback texture still null:",l)}catch(b){console.error("Fallback texture loading also failed:",b)}}}async function H(){if(!l)return;console.log("Creating dragon frame textures...");const t=128,b=128,T=2,Z=2;s(3,d=[]);for(let M=0;M<Z;M++)for(let u=0;u<T;u++){const N=u*t,W=M*b,j=new me({source:l.source,frame:new De(N,W,t,b)});d.push(j),console.log(`Created frame ${d.length}: ${M},${u} at ${N},${W}`)}console.log(`Created ${d.length} dragon frames`)}function V(){if(console.log("Spawn animated dragon called:",{loaded:a,frames:d.length}),!a||d.length===0||!e){console.log("Cannot spawn animated dragon - not ready:",{loaded:a,framesCount:d.length,appExists:!!e});return}const t=new ve(d[0]);t.visible=!0,t.position.set(Math.random()*(e.renderer.width-128),Math.random()*(e.renderer.height-128)),t.scale.set(.5),t.anchor.set(.5),console.log("Adding animated sprite to stage:",{sprite:t,position:t.position,visible:t.visible,stageChildren:e.stage.children.length}),e.stage.addChild(t),B.push(t),s(1,g++,g),e.renderer.render(e.stage),console.log("Animated dragon spawned successfully, total:",g,{stageChildren:e.stage.children.length,animatedSprites:B.length})}function k(){if(I){console.log("Animation already running");return}if(d.length===0){console.log("No frames available for animation");return}console.log("Starting dragon animation at 2 FPS..."),s(5,I=setInterval(()=>{s(6,m=(m+1)%d.length);const t=d[m];if(t)for(const b of B)b.texture=t;e&&e.renderer.render(e.stage),console.log(`Animation frame: ${m+1}/${d.length}`)},500))}function J(){I&&(clearInterval(I),s(5,I=null),console.log("Animation stopped"))}function q(){if(console.log("Spawn dragon called:",{loaded:a,dragonTexture:!!l}),!a||!l){console.log("Cannot spawn dragon - texture not ready:",{loaded:a,textureExists:!!l});return}const t=new ve(l);t.visible=!0,t.position.set(Math.random()*(e.renderer.width-128),Math.random()*(e.renderer.height-128)),t.scale.set(.5),t.anchor.set(.5),console.log("Adding sprite to stage:",{sprite:t,position:t.position,visible:t.visible,stageChildren:e.stage.children.length,stage:e.stage}),e.stage.addChild(t),i.push(t),s(1,g++,g),e.renderer.render(e.stage),console.log("Dragon spawned successfully, total:",g,{stageChildren:e.stage.children.length,spritePosition:t.position,spriteVisible:t.visible,rendererWidth:e.renderer.width,rendererHeight:e.renderer.height})}function A(){J();for(const t of i)e.stage.removeChild(t),t.destroy();i=[];for(const t of B)e.stage.removeChild(t),t.destroy();B=[],s(1,g=0),s(6,m=0),console.log("All dragons recycled")}Ce(async()=>{console.log("Mounting PixiJS app..."),await new Promise(t=>setTimeout(t,1e3));try{e=new Ee,await e.init({view:h,backgroundAlpha:0,antialias:!1,resolution:1,autoDensity:!0}),e.ticker&&e.ticker.stop(),e.renderer.resize(h.clientWidth,h.clientHeight),console.log("PixiJS app initialized:",{width:e.renderer.width,height:e.renderer.height,stage:e.stage,tickerRunning:e.ticker?.started}),await X()}catch(t){console.error("Failed to initialize PixiJS app:",t)}}),ke(()=>{console.log("Destroying PixiJS app..."),J(),e?.destroy(!0,{children:!0})});function Y(t){Ae[t?"unshift":"push"](()=>{h=t,s(0,h)})}return[h,g,l,d,a,I,m,V,k,J,q,A,Y]}class Me extends Te{constructor(r){super(),Se(this,r,Ie,Fe,we,{})}}export{Me as component};
