import{r as te,s as ne,n as H,o as ie,b as ae,d as se}from"../chunks/scheduler.86f77edc.js";import{r as oe,S as le,i as re,b as A,s as $,t as Y,f as D,g as V,d as k,c as R,m as N,h as Z,j as e,a as q,k as m,l as ee}from"../chunks/index.e78d2784.js";import{T as de}from"../chunks/index.29d1603d.js";import{g as W,c as ce}from"../chunks/dragon-sprites.24d3ff80.js";import{A as fe}from"../chunks/Application.778f7409.js";import{A as he}from"../chunks/Assets.eee396a8.js";function B(s){return s?.length!==void 0?s:Array.from(s)}function ue(s,t){s.d(1),t.delete(s.key)}function ge(s,t,i,a,n,l,g,r,S,E,c,L){let d=s.length,y=l.length,_=d;const I={};for(;_--;)I[s[_].key]=_;const o=[],x=new Map,z=new Map,U=[];for(_=y;_--;){const f=L(n,l,_),u=i(f);let b=g.get(u);b?a&&U.push(()=>b.p(f,t)):(b=E(u,f),b.c()),x.set(u,o[_]=b),u in I&&z.set(u,Math.abs(_-I[u]))}const C=new Set,P=new Set;function F(f){oe(f,1),f.m(r,c),g.set(f.key,f),c=f.first,y--}for(;d&&y;){const f=o[y-1],u=s[d-1],b=f.key,T=u.key;f===u?(c=f.first,d--,y--):x.has(T)?!g.has(b)||C.has(b)?F(f):P.has(T)?d--:z.get(b)>z.get(T)?(P.add(b),F(f)):(C.add(T),d--):(S(u,g),d--)}for(;d--;){const f=s[d];x.has(f.key)||S(f,g)}for(;y;)F(o[y-1]);return te(U),o}function J(s,t,i){const a=s.slice();return a[7]=t[i],a[9]=i,a}function K(s,t){let i,a=t[7]+"",n;return{key:s,first:null,c(){i=A("div"),n=Y(a),this.h()},l(l){i=D(l,"DIV",{style:!0});var g=V(i);n=Z(g,a),g.forEach(k),this.h()},h(){e(i,"margin","2px 0"),e(i,"color",t[7].includes("ERROR")?"#f44336":t[7].includes("SUCCESS")?"#4CAF50":"#ccc"),this.first=i},m(l,g){q(l,i,g),m(i,n)},p(l,g){t=l,g&2&&a!==(a=t[7]+"")&&ee(n,a),g&2&&e(i,"color",t[7].includes("ERROR")?"#f44336":t[7].includes("SUCCESS")?"#4CAF50":"#ccc")},d(l){l&&k(i)}}}function Q(s){let t,i="Waiting for debug info...";return{c(){t=A("div"),t.textContent=i,this.h()},l(a){t=D(a,"DIV",{style:!0,"data-svelte-h":!0}),N(t)!=="svelte-fpyjqs"&&(t.textContent=i),this.h()},h(){e(t,"color","#666"),e(t,"font-style","italic")},m(a,n){q(a,t,n)},d(a){a&&k(t)}}}function pe(s){let t,i,a,n,l,g="🐛 Dragon Loading Debug",r,S,E,c="Status:",L,d,y=s[2]?"Ready":"Loading...",_,I,o,x,z="Debug Log:",U,C=[],P=new Map,F,f,u,b="This page tests dragon texture loading step-by-step to identify issues.",T=B(s[1]);const X=h=>h[7];for(let h=0;h<T.length;h+=1){let p=J(s,T,h),v=X(p);P.set(v,C[h]=K(v,p))}let w=s[1].length===0&&Q();return{c(){t=A("div"),i=A("canvas"),a=$(),n=A("div"),l=A("h3"),l.textContent=g,r=$(),S=A("div"),E=A("strong"),E.textContent=c,L=$(),d=A("span"),_=Y(y),I=$(),o=A("div"),x=A("div"),x.textContent=z,U=$();for(let h=0;h<C.length;h+=1)C[h].c();F=$(),w&&w.c(),f=$(),u=A("div"),u.textContent=b,this.h()},l(h){t=D(h,"DIV",{style:!0});var p=V(t);i=D(p,"CANVAS",{style:!0}),V(i).forEach(k),a=R(p),n=D(p,"DIV",{style:!0});var v=V(n);l=D(v,"H3",{style:!0,"data-svelte-h":!0}),N(l)!=="svelte-1ononop"&&(l.textContent=g),r=R(v),S=D(v,"DIV",{style:!0});var O=V(S);E=D(O,"STRONG",{"data-svelte-h":!0}),N(E)!=="svelte-1ftu2mm"&&(E.textContent=c),L=R(O),d=D(O,"SPAN",{style:!0});var G=V(d);_=Z(G,y),G.forEach(k),O.forEach(k),I=R(v),o=D(v,"DIV",{style:!0});var M=V(o);x=D(M,"DIV",{style:!0,"data-svelte-h":!0}),N(x)!=="svelte-60a1h0"&&(x.textContent=z),U=R(M);for(let j=0;j<C.length;j+=1)C[j].l(M);F=R(M),w&&w.l(M),M.forEach(k),f=R(v),u=D(v,"DIV",{style:!0,"data-svelte-h":!0}),N(u)!=="svelte-1o2hfrm"&&(u.textContent=b),v.forEach(k),p.forEach(k),this.h()},h(){e(i,"width","100%"),e(i,"height","100%"),e(i,"display","block"),e(l,"margin","0 0 12px 0"),e(l,"font-size","14px"),e(l,"color","#4CAF50"),e(d,"color",s[2]?"#4CAF50":"#f44336"),e(S,"margin-bottom","12px"),e(x,"font-size","10px"),e(x,"color","#888"),e(x,"margin-bottom","6px"),e(o,"border","1px solid #333"),e(o,"padding","8px"),e(o,"background","#111"),e(o,"border-radius","4px"),e(o,"max-height","400px"),e(o,"overflow-y","auto"),e(u,"margin-top","12px"),e(u,"font-size","10px"),e(u,"color","#666"),e(n,"position","absolute"),e(n,"left","8px"),e(n,"top","8px"),e(n,"background","rgba(0,0,0,.95)"),e(n,"color","#fff"),e(n,"padding","16px"),e(n,"border-radius","8px"),e(n,"font","11px 'Courier New', monospace"),e(n,"max-width","500px"),e(n,"max-height","80vh"),e(n,"overflow-y","auto"),e(t,"position","fixed"),e(t,"inset","0"),e(t,"background","#0a0a0a")},m(h,p){q(h,t,p),m(t,i),s[3](i),m(t,a),m(t,n),m(n,l),m(n,r),m(n,S),m(S,E),m(S,L),m(S,d),m(d,_),m(n,I),m(n,o),m(o,x),m(o,U);for(let v=0;v<C.length;v+=1)C[v]&&C[v].m(o,null);m(o,F),w&&w.m(o,null),m(n,f),m(n,u)},p(h,[p]){p&4&&y!==(y=h[2]?"Ready":"Loading...")&&ee(_,y),p&4&&e(d,"color",h[2]?"#4CAF50":"#f44336"),p&2&&(T=B(h[1]),C=ge(C,p,X,1,h,T,P,o,ue,K,F,J)),h[1].length===0?w||(w=Q(),w.c(),w.m(o,null)):w&&(w.d(1),w=null)},i:H,o:H,d(h){h&&k(t),s[3](null);for(let p=0;p<C.length;p+=1)C[p].d();w&&w.d()}}}function me(s,t,i){let a,n,l=[],g=!1;function r(c){console.log(c),i(1,l=[...l,`${new Date().toLocaleTimeString()}: ${c}`])}async function S(){r("Starting texture loading test...");try{r("Test 1: Loading texture using Assets API...");const c=await he.load("/sprites/dragon_fly_128_sheet.svg");r(`Assets texture loaded: ${c?"SUCCESS":"FAILED"}`),c&&r(`Texture dimensions: ${c.width}x${c.height}`),r("Test 1b: Loading texture directly (legacy)...");const L=de.from("/sprites/dragon_fly_128_sheet.svg");r(`Direct texture created: ${L?"SUCCESS":"FAILED"}`),r("Test 2: Testing atlas frame loading...");const d=await W("idle");r(`Dragon frame loaded: ${d?"SUCCESS":"FAILED"}`),d&&r(`Frame details: ${d.width}x${d.height} at (${d.x}, ${d.y})`),r("Test 3: Loading all dragon frames...");const y=["idle","fly_1","fly_2","fly_3"];for(const o of y){const x=await W(o);r(`Frame ${o}: ${x?"SUCCESS":"FAILED"}`)}r("Test 4: Creating animated dragon sprite...");const{sprite:_,animator:I}=await ce();r("Animated sprite created: SUCCESS"),_.position.set(n.renderer.width/2,n.renderer.height/2),_.scale.set(1),n.stage.addChild(_),await I.start(),r("Animation started successfully!")}catch(c){r(`ERROR: ${c.message}`),console.error("Texture loading test failed:",c)}}ie(async()=>{try{r("Initializing PIXI application..."),n=new fe({view:a,backgroundAlpha:0}),await n.init({resizeTo:a.parentElement??window}),r("PIXI application initialized"),i(2,g=!0),await S()}catch(c){r(`Failed to initialize: ${c.message}`),console.error("Failed to initialize app:",c)}}),ae(()=>{n?.destroy(!0,{children:!0})});function E(c){se[c?"unshift":"push"](()=>{a=c,i(0,a)})}return[a,l,g,E]}class Se extends le{constructor(t){super(),re(this,t,me,pe,ne,{})}}export{Se as component};
