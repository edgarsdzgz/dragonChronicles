var pu=Object.defineProperty;var mu=(e,t,i)=>t in e?pu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var qt=(e,t,i)=>(mu(e,typeof t!="symbol"?t+"":t,i),i);import{a as vu,n as Bo,r as yu,e as gu}from"../chunks/scheduler.fce5cbda.js";import{S as bu,i as _u,e as Ce,s as Kn,t as Ue,c as De,a as ln,m as Fo,f as Bn,b as Le,d as Qe,q as Fn,l as Mt,g as wu,h as te,A as Ut,z as ft,B as Gt,j as Kr}from"../chunks/index.f66cbd13.js";import{c as qo,g as ku}from"../chunks/_commonjsHelpers.725317a4.js";function Jt(e){if(e==null)return 4;switch(typeof e){case"string":return 2+e.length;case"number":return 8;case"boolean":return 4;case"object":return Array.isArray(e)?2+e.reduce((a,l)=>a+Jt(l),0):2+Object.keys(e).reduce((a,l)=>{const m=e[l];return a+l.length+3+Jt(m)},0);default:return 8}}function xu(e){return e.map(t=>JSON.stringify(t)).join(`
`)+`
`}function zu(){return{log(e){const t=`[${e.src}${e.mode?`/${e.mode}`:""}]`;(console[e.lvl]??console.log)(t,e.msg,e.data??"")}}}const Eu=new Set(["fps","draws","enemies","proj","arcana","gold","dragonName","profileId","land","ward"]);function Ou(e){const t={t:e.t,lvl:e.lvl,src:e.src,msg:e.msg};if(e.mode!==void 0&&(t.mode=e.mode),e.profileId!==void 0&&(t.profileId=e.profileId),e.data&&typeof e.data=="object"){const i={};for(const[a,l]of Object.entries(e.data))Eu.has(a)&&(typeof l=="string"&&a!=="dragonName"||(i[a]=l));t.data=i}return t}class Pu{constructor(t){this.buffer=[],this.head=0,this.tail=0,this.size=0,this.capacity=t,this.buffer=new Array(t)}push(t){this.size===this.capacity?(this.buffer[this.head]=t,this.head=(this.head+1)%this.capacity,this.tail=(this.tail+1)%this.capacity):(this.buffer[this.tail]=t,this.tail=(this.tail+1)%this.capacity,this.size++)}shift(){if(this.size===0)return;const t=this.buffer[this.head];return this.head=(this.head+1)%this.capacity,this.size--,t}get length(){return this.size}get isEmpty(){return this.size===0}get isFull(){return this.size===this.capacity}toArray(){if(this.size===0)return[];const t=[];let i=this.head;for(let a=0;a<this.size;a++){const l=this.buffer[i];l!==void 0&&t.push(l),i=(i+1)%this.capacity}return t}clear(){this.head=0,this.tail=0,this.size=0}toArrayLimited(t){if(this.size===0||t<=0)return[];const i=[];let a=this.head;const l=Math.min(t,this.size);for(let m=0;m<l;m++){const d=this.buffer[a];d!==void 0&&i.push(d),a=(a+1)%this.capacity}return i}forEach(t){if(this.size===0)return;let i=this.head;for(let a=0;a<this.size;a++){const l=this.buffer[i];l!==void 0&&t(l,a),i=(i+1)%this.capacity}}map(t){if(this.size===0)return[];const i=[];let a=this.head;for(let l=0;l<this.size;l++){const m=this.buffer[a];m!==void 0&&i.push(t(m,l)),a=(a+1)%this.capacity}return i}}function Su(e={}){const t=e.maxBytes??2097152,i=e.maxEntries??1e4,a=new Pu(i);let l=0;const m=zu(),d=e.dexie??null;function E(){for(;l>t&&a.length>0;){const J=a.shift();J&&(l-=Jt(J))}}function A(J){const Y=Ou(J),ae=Jt(Y);a.push(Y),l+=ae,E(),C&&m.log(Y),d?.enqueue(Y)}let C=!!e.devConsole;async function M(){const J=a.toArray(),Y=xu(J);return new Blob([Y],{type:"application/x-ndjson"})}async function U(){a.clear(),l=0,await d?.clear()}function W(J){C=J}return{log:A,exportNDJSON:M,clear:U,enableConsole:W}}var fi={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(qo,function(){var i=function(n,r){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,u){o.__proto__=u}||function(o,u){for(var s in u)Object.prototype.hasOwnProperty.call(u,s)&&(o[s]=u[s])})(n,r)},a=function(){return(a=Object.assign||function(n){for(var r,o=1,u=arguments.length;o<u;o++)for(var s in r=arguments[o])Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s]);return n}).apply(this,arguments)};function l(n,r,o){if(o||arguments.length===2)for(var u,s=0,c=r.length;s<c;s++)!u&&s in r||((u=u||Array.prototype.slice.call(r,0,s))[s]=r[s]);return n.concat(u||Array.prototype.slice.call(r))}var m=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:qo,d=Object.keys,E=Array.isArray;function A(n,r){return typeof r!="object"||d(r).forEach(function(o){n[o]=r[o]}),n}typeof Promise>"u"||m.Promise||(m.Promise=Promise);var C=Object.getPrototypeOf,M={}.hasOwnProperty;function U(n,r){return M.call(n,r)}function W(n,r){typeof r=="function"&&(r=r(C(n))),(typeof Reflect>"u"?d:Reflect.ownKeys)(r).forEach(function(o){Y(n,o,r[o])})}var J=Object.defineProperty;function Y(n,r,o,u){J(n,r,A(o&&U(o,"get")&&typeof o.get=="function"?{get:o.get,set:o.set,configurable:!0}:{value:o,configurable:!0,writable:!0},u))}function ae(n){return{from:function(r){return n.prototype=Object.create(r.prototype),Y(n.prototype,"constructor",n),{extend:W.bind(null,n.prototype)}}}}var Ee=Object.getOwnPropertyDescriptor,mn=[].slice;function Oe(n,r,o){return mn.call(n,r,o)}function _e(n,r){return r(n)}function pe(n){if(!n)throw new Error("Assertion Failed")}function Ze(n){m.setImmediate?setImmediate(n):setTimeout(n,0)}function be(n,r){if(typeof r=="string"&&U(n,r))return n[r];if(!r)return n;if(typeof r!="string"){for(var o=[],u=0,s=r.length;u<s;++u){var c=be(n,r[u]);o.push(c)}return o}var f=r.indexOf(".");if(f!==-1){var h=n[r.substr(0,f)];return h==null?void 0:be(h,r.substr(f+1))}}function we(n,r,o){if(n&&r!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof r!="string"&&"length"in r){pe(typeof o!="string"&&"length"in o);for(var u=0,s=r.length;u<s;++u)we(n,r[u],o[u])}else{var c,f,h=r.indexOf(".");h!==-1?(c=r.substr(0,h),(f=r.substr(h+1))===""?o===void 0?E(n)&&!isNaN(parseInt(c))?n.splice(c,1):delete n[c]:n[c]=o:we(h=!(h=n[c])||!U(n,c)?n[c]={}:h,f,o)):o===void 0?E(n)&&!isNaN(parseInt(r))?n.splice(r,1):delete n[r]:n[r]=o}}function In(n){var r,o={};for(r in n)U(n,r)&&(o[r]=n[r]);return o}var Te=[].concat;function An(n){return Te.apply([],n)}var bn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(An([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(r){return r+n+"Array"})}))).filter(function(n){return m[n]}),vn=new Set(bn.map(function(n){return m[n]})),We=null;function $e(n){return We=new WeakMap,n=function r(o){if(!o||typeof o!="object")return o;var u=We.get(o);if(u)return u;if(E(o)){u=[],We.set(o,u);for(var s=0,c=o.length;s<c;++s)u.push(r(o[s]))}else if(vn.has(o.constructor))u=o;else{var f,h=C(o);for(f in u=h===Object.prototype?{}:Object.create(h),We.set(o,u),o)U(o,f)&&(u[f]=r(o[f]))}return u}(n),We=null,n}var Yn={}.toString;function Ye(n){return Yn.call(n).slice(8,-1)}var en=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Gn=typeof en=="symbol"?function(n){var r;return n!=null&&(r=n[en])&&r.apply(n)}:function(){return null};function Ke(n,r){return r=n.indexOf(r),0<=r&&n.splice(r,1),0<=r}var fe={};function ee(n){var r,o,u,s;if(arguments.length===1){if(E(n))return n.slice();if(this===fe&&typeof n=="string")return[n];if(s=Gn(n)){for(o=[];!(u=s.next()).done;)o.push(u.value);return o}if(n==null)return[n];if(typeof(r=n.length)!="number")return[n];for(o=new Array(r);r--;)o[r]=n[r];return o}for(r=arguments.length,o=new Array(r);r--;)o[r]=arguments[r];return o}var nn=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Qn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],je=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Qn),Jn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Be(n,r){this.name=n,this.message=r}function Ge(n,r){return n+". Errors: "+Object.keys(r).map(function(o){return r[o].toString()}).filter(function(o,u,s){return s.indexOf(o)===u}).join(`
`)}function yn(n,r,o,u){this.failures=r,this.failedKeys=u,this.successCount=o,this.message=Ge(n,r)}function Je(n,r){this.name="BulkError",this.failures=Object.keys(r).map(function(o){return r[o]}),this.failuresByPos=r,this.message=Ge(n,this.failures)}ae(Be).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ae(yn).from(Be),ae(Je).from(Be);var Ne=je.reduce(function(n,r){return n[r]=r+"Error",n},{}),Ri=Be,q=je.reduce(function(n,r){var o=r+"Error";function u(s,c){this.name=o,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=Jn[r]||o,this.inner=null)}return ae(u).from(Ri),n[r]=u,n},{});q.Syntax=SyntaxError,q.Type=TypeError,q.Range=RangeError;var oo=Qn.reduce(function(n,r){return n[r+"Error"]=q[r],n},{}),mt=je.reduce(function(n,r){return["Syntax","Type","Range"].indexOf(r)===-1&&(n[r+"Error"]=q[r]),n},{});function ne(){}function Xn(n){return n}function Ni(n,r){return n==null||n===Xn?r:function(o){return r(n(o))}}function gn(n,r){return function(){n.apply(this,arguments),r.apply(this,arguments)}}function Ki(n,r){return n===ne?r:function(){var o=n.apply(this,arguments);o!==void 0&&(arguments[0]=o);var u=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var c=r.apply(this,arguments);return u&&(this.onsuccess=this.onsuccess?gn(u,this.onsuccess):u),s&&(this.onerror=this.onerror?gn(s,this.onerror):s),c!==void 0?c:o}}function Bi(n,r){return n===ne?r:function(){n.apply(this,arguments);var o=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,r.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?gn(o,this.onsuccess):o),u&&(this.onerror=this.onerror?gn(u,this.onerror):u)}}function Fi(n,r){return n===ne?r:function(o){var u=n.apply(this,arguments);A(o,u);var s=this.onsuccess,c=this.onerror;return this.onsuccess=null,this.onerror=null,o=r.apply(this,arguments),s&&(this.onsuccess=this.onsuccess?gn(s,this.onsuccess):s),c&&(this.onerror=this.onerror?gn(c,this.onerror):c),u===void 0?o===void 0?void 0:o:A(u,o)}}function qi(n,r){return n===ne?r:function(){return r.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function or(n,r){return n===ne?r:function(){var o=n.apply(this,arguments);if(o&&typeof o.then=="function"){for(var u=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return o.then(function(){return r.apply(u,c)})}return r.apply(this,arguments)}}mt.ModifyError=yn,mt.DexieError=Be,mt.BulkError=Je;var Fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function io(n){Fe=n}var Hn={},uo=100,bn=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,C(n),n];var r=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[r,C(r),n]}(),Qn=bn[0],je=bn[1],bn=bn[2],je=je&&je.then,_n=Qn&&Qn.constructor,ir=!!bn,et=function(n,r){nt.push([n,r]),vt&&(queueMicrotask(Ui),vt=!1)},ur=!0,vt=!0,wn=[],yt=[],ar=Xn,tn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ne,pgp:!1,env:{},finalize:ne},B=tn,nt=[],kn=0,gt=[];function N(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var r=this._PSD=B;if(typeof n!="function"){if(n!==Hn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&cr(this,this._value))}this._state=null,this._value=null,++r.ref,function o(u,s){try{s(function(c){if(u._state===null){if(c===u)throw new TypeError("A promise cannot be resolved with itself.");var f=u._lib&&Zn();c&&typeof c.then=="function"?o(u,function(h,v){c instanceof N?c._then(h,v):c.then(h,v)}):(u._state=!0,u._value=c,so(u)),f&&Tn()}},cr.bind(null,u))}catch(c){cr(u,c)}}(this,n)}var sr={get:function(){var n=B,r=kt;function o(u,s){var c=this,f=!n.global&&(n!==B||r!==kt),h=f&&!on(),v=new N(function(g,_){lr(c,new ao(lo(u,n,f,h),lo(s,n,f,h),g,_,n))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return o.prototype=Hn,o},set:function(n){Y(this,"then",n&&n.prototype===Hn?sr:{get:function(){return n},set:sr.set})}};function ao(n,r,o,u,s){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof r=="function"?r:null,this.resolve=o,this.reject=u,this.psd=s}function cr(n,r){var o,u;yt.push(r),n._state===null&&(o=n._lib&&Zn(),r=ar(r),n._state=!1,n._value=r,u=n,wn.some(function(s){return s._value===u._value})||wn.push(u),so(n),o&&Tn())}function so(n){var r=n._listeners;n._listeners=[];for(var o=0,u=r.length;o<u;++o)lr(n,r[o]);var s=n._PSD;--s.ref||s.finalize(),kn===0&&(++kn,et(function(){--kn==0&&fr()},[]))}function lr(n,r){if(n._state!==null){var o=n._state?r.onFulfilled:r.onRejected;if(o===null)return(n._state?r.resolve:r.reject)(n._value);++r.psd.ref,++kn,et(Mi,[o,n,r])}else n._listeners.push(r)}function Mi(n,r,o){try{var u,s=r._value;!r._state&&yt.length&&(yt=[]),u=Fe&&r._consoleTask?r._consoleTask.run(function(){return n(s)}):n(s),r._state||yt.indexOf(s)!==-1||function(c){for(var f=wn.length;f;)if(wn[--f]._value===c._value)return wn.splice(f,1)}(r),o.resolve(u)}catch(c){o.reject(c)}finally{--kn==0&&fr(),--o.psd.ref||o.psd.finalize()}}function Ui(){xn(tn,function(){Zn()&&Tn()})}function Zn(){var n=ur;return vt=ur=!1,n}function Tn(){var n,r,o;do for(;0<nt.length;)for(n=nt,nt=[],o=n.length,r=0;r<o;++r){var u=n[r];u[0].apply(null,u[1])}while(0<nt.length);vt=ur=!0}function fr(){var n=wn;wn=[],n.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)});for(var r=gt.slice(0),o=r.length;o;)r[--o]()}function bt(n){return new N(Hn,!1,n)}function ie(n,r){var o=B;return function(){var u=Zn(),s=B;try{return un(o,!0),n.apply(this,arguments)}catch(c){r&&r(c)}finally{un(s,!1),u&&Tn()}}}W(N.prototype,{then:sr,_then:function(n,r){lr(this,new ao(null,null,n,r,B))},catch:function(n){if(arguments.length===1)return this.then(null,n);var r=n,o=arguments[1];return typeof r=="function"?this.then(null,function(u){return(u instanceof r?o:bt)(u)}):this.then(null,function(u){return(u&&u.name===r?o:bt)(u)})},finally:function(n){return this.then(function(r){return N.resolve(n()).then(function(){return r})},function(r){return N.resolve(n()).then(function(){return bt(r)})})},timeout:function(n,r){var o=this;return n<1/0?new N(function(u,s){var c=setTimeout(function(){return s(new q.Timeout(r))},n);o.then(u,s).finally(clearTimeout.bind(null,c))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Y(N.prototype,Symbol.toStringTag,"Dexie.Promise"),tn.env=co(),W(N,{all:function(){var n=ee.apply(null,arguments).map(xt);return new N(function(r,o){n.length===0&&r([]);var u=n.length;n.forEach(function(s,c){return N.resolve(s).then(function(f){n[c]=f,--u||r(n)},o)})})},resolve:function(n){return n instanceof N?n:n&&typeof n.then=="function"?new N(function(r,o){n.then(r,o)}):new N(Hn,!0,n)},reject:bt,race:function(){var n=ee.apply(null,arguments).map(xt);return new N(function(r,o){n.map(function(u){return N.resolve(u).then(r,o)})})},PSD:{get:function(){return B},set:function(n){return B=n}},totalEchoes:{get:function(){return kt}},newPSD:rn,usePSD:xn,scheduler:{get:function(){return et},set:function(n){et=n}},rejectionMapper:{get:function(){return ar},set:function(n){ar=n}},follow:function(n,r){return new N(function(o,u){return rn(function(s,c){var f=B;f.unhandleds=[],f.onunhandled=c,f.finalize=gn(function(){var h,v=this;h=function(){v.unhandleds.length===0?s():c(v.unhandleds[0])},gt.push(function g(){h(),gt.splice(gt.indexOf(g),1)}),++kn,et(function(){--kn==0&&fr()},[])},f.finalize),n()},r,o,u)})}}),_n&&(_n.allSettled&&Y(N,"allSettled",function(){var n=ee.apply(null,arguments).map(xt);return new N(function(r){n.length===0&&r([]);var o=n.length,u=new Array(o);n.forEach(function(s,c){return N.resolve(s).then(function(f){return u[c]={status:"fulfilled",value:f}},function(f){return u[c]={status:"rejected",reason:f}}).then(function(){return--o||r(u)})})})}),_n.any&&typeof AggregateError<"u"&&Y(N,"any",function(){var n=ee.apply(null,arguments).map(xt);return new N(function(r,o){n.length===0&&o(new AggregateError([]));var u=n.length,s=new Array(u);n.forEach(function(c,f){return N.resolve(c).then(function(h){return r(h)},function(h){s[f]=h,--u||o(new AggregateError(s))})})})}),_n.withResolvers&&(N.withResolvers=_n.withResolvers));var ye={awaits:0,echoes:0,id:0},Li=0,_t=[],wt=0,kt=0,Vi=0;function rn(n,r,o,u){var s=B,c=Object.create(s);return c.parent=s,c.ref=0,c.global=!1,c.id=++Vi,tn.env,c.env=ir?{Promise:N,PromiseProp:{value:N,configurable:!0,writable:!0},all:N.all,race:N.race,allSettled:N.allSettled,any:N.any,resolve:N.resolve,reject:N.reject}:{},r&&A(c,r),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()},u=xn(c,n,o,u),c.ref===0&&c.finalize(),u}function $n(){return ye.id||(ye.id=++Li),++ye.awaits,ye.echoes+=uo,ye.id}function on(){return!!ye.awaits&&(--ye.awaits==0&&(ye.id=0),ye.echoes=ye.awaits*uo,!0)}function xt(n){return ye.echoes&&n&&n.constructor===_n?($n(),n.then(function(r){return on(),r},function(r){return on(),me(r)})):n}function Wi(){var n=_t[_t.length-1];_t.pop(),un(n,!1)}function un(n,r){var o,u=B;(r?!ye.echoes||wt++&&n===B:!wt||--wt&&n===B)||queueMicrotask(r?function(s){++kt,ye.echoes&&--ye.echoes!=0||(ye.echoes=ye.awaits=ye.id=0),_t.push(B),un(s,!0)}.bind(null,n):Wi),n!==B&&(B=n,u===tn&&(tn.env=co()),ir&&(o=tn.env.Promise,r=n.env,(u.global||n.global)&&(Object.defineProperty(m,"Promise",r.PromiseProp),o.all=r.all,o.race=r.race,o.resolve=r.resolve,o.reject=r.reject,r.allSettled&&(o.allSettled=r.allSettled),r.any&&(o.any=r.any))))}function co(){var n=m.Promise;return ir?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(m,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function xn(n,r,o,u,s){var c=B;try{return un(n,!0),r(o,u,s)}finally{un(c,!1)}}function lo(n,r,o,u){return typeof n!="function"?n:function(){var s=B;o&&$n(),un(r,!0);try{return n.apply(this,arguments)}finally{un(s,!1),u&&queueMicrotask(on)}}}function hr(n){Promise===_n&&ye.echoes===0?wt===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+je).indexOf("[native code]")===-1&&($n=on=ne);var me=N.reject,zn=String.fromCharCode(65535),Xe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",fo="String expected.",jn=[],zt="__dbnames",dr="readonly",pr="readwrite";function En(n,r){return n?r?function(){return n.apply(this,arguments)&&r.apply(this,arguments)}:n:r}var ho={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Et(n){return typeof n!="string"||/\./.test(n)?function(r){return r}:function(r){return r[n]===void 0&&n in r&&delete(r=$e(r))[n],r}}function po(){throw q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function X(n,r){try{var o=mo(n),u=mo(r);if(o!==u)return o==="Array"?1:u==="Array"?-1:o==="binary"?1:u==="binary"?-1:o==="string"?1:u==="string"?-1:o==="Date"?1:u!=="Date"?NaN:-1;switch(o){case"number":case"Date":case"string":return r<n?1:n<r?-1:0;case"binary":return function(s,c){for(var f=s.length,h=c.length,v=f<h?f:h,g=0;g<v;++g)if(s[g]!==c[g])return s[g]<c[g]?-1:1;return f===h?0:f<h?-1:1}(vo(n),vo(r));case"Array":return function(s,c){for(var f=s.length,h=c.length,v=f<h?f:h,g=0;g<v;++g){var _=X(s[g],c[g]);if(_!==0)return _}return f===h?0:f<h?-1:1}(n,r)}}catch{}return NaN}function mo(n){var r=typeof n;return r!="object"?r:ArrayBuffer.isView(n)?"binary":(n=Ye(n),n==="ArrayBuffer"?"binary":n)}function vo(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}function Ot(n,r,o){var u=n.schema.yProps;return u?(r&&0<o.numFailures&&(r=r.filter(function(s,c){return!o.failures[c]})),Promise.all(u.map(function(s){return s=s.updatesTable,r?n.db.table(s).where("k").anyOf(r).delete():n.db.table(s).clear()})).then(function(){return o})):o}var yo=(oe.prototype._trans=function(n,r,o){var u=this._tx||B.trans,s=this.name,c=Fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function f(g,_,p){if(!p.schema[s])throw new q.NotFound("Table "+s+" not part of transaction");return r(p.idbtrans,p)}var h=Zn();try{var v=u&&u.db._novip===this.db._novip?u===B.trans?u._promise(n,f,o):rn(function(){return u._promise(n,f,o)},{trans:u,transless:B.transless||B}):function g(_,p,x,y){if(_.idbdb&&(_._state.openComplete||B.letThrough||_._vip)){var b=_._createTransaction(p,x,_._dbSchema);try{b.create(),_._state.PR1398_maxLoop=3}catch(k){return k.name===Ne.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return g(_,p,x,y)})):me(k)}return b._promise(p,function(k,w){return rn(function(){return B.trans=b,y(k,w,b)})}).then(function(k){if(p==="readwrite")try{b.idbtrans.commit()}catch{}return p==="readonly"?k:b._completion.then(function(){return k})})}if(_._state.openComplete)return me(new q.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return me(new q.DatabaseClosed);_.open().catch(ne)}return _._state.dbReadyPromise.then(function(){return g(_,p,x,y)})}(this.db,n,[this.name],f);return c&&(v._consoleTask=c,v=v.catch(function(g){return console.trace(g),me(g)})),v}finally{h&&Tn()}},oe.prototype.get=function(n,r){var o=this;return n&&n.constructor===Object?this.where(n).first(r):n==null?me(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return o.core.get({trans:u,key:n}).then(function(s){return o.hook.reading.fire(s)})}).then(r)},oe.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(E(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var r=d(n);if(r.length===1)return this.where(r[0]).equals(n[r[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(h){if(h.compound&&r.every(function(g){return 0<=h.keyPath.indexOf(g)})){for(var v=0;v<r.length;++v)if(r.indexOf(h.keyPath[v])===-1)return!1;return!0}return!1}).sort(function(h,v){return h.keyPath.length-v.keyPath.length})[0];if(o&&this.db._maxKey!==zn){var c=o.keyPath.slice(0,r.length);return this.where(c).equals(c.map(function(v){return n[v]}))}!o&&Fe&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(r.join("+"),"]"));var u=this.schema.idxByName;function s(h,v){return X(h,v)===0}var f=r.reduce(function(p,v){var g=p[0],_=p[1],p=u[v],x=n[v];return[g||p,g||!p?En(_,p&&p.multi?function(y){return y=be(y,v),E(y)&&y.some(function(b){return s(x,b)})}:function(y){return s(x,be(y,v))}):_]},[null,null]),c=f[0],f=f[1];return c?this.where(c.name).equals(n[c.keyPath]).filter(f):o?this.filter(f):this.where(r).equals("")},oe.prototype.filter=function(n){return this.toCollection().and(n)},oe.prototype.count=function(n){return this.toCollection().count(n)},oe.prototype.offset=function(n){return this.toCollection().offset(n)},oe.prototype.limit=function(n){return this.toCollection().limit(n)},oe.prototype.each=function(n){return this.toCollection().each(n)},oe.prototype.toArray=function(n){return this.toCollection().toArray(n)},oe.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},oe.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,E(n)?"[".concat(n.join("+"),"]"):n))},oe.prototype.reverse=function(){return this.toCollection().reverse()},oe.prototype.mapToClass=function(n){var r,o=this.db,u=this.name;function s(){return r!==null&&r.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof po&&(function(v,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function _(){this.constructor=v}i(v,g),v.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}(s,r=n),Object.defineProperty(s.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),s.prototype.table=function(){return u},n=s);for(var c=new Set,f=n.prototype;f;f=C(f))Object.getOwnPropertyNames(f).forEach(function(v){return c.add(v)});function h(v){if(!v)return v;var g,_=Object.create(n.prototype);for(g in v)if(!c.has(g))try{_[g]=v[g]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),n},oe.prototype.defineClass=function(){return this.mapToClass(function(n){A(this,n)})},oe.prototype.add=function(n,r){var o=this,u=this.schema.primKey,s=u.auto,c=u.keyPath,f=n;return c&&s&&(f=Et(c)(n)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"add",keys:r!=null?[r]:null,values:[f]})}).then(function(h){return h.numFailures?N.reject(h.failures[0]):h.lastResult}).then(function(h){if(c)try{we(n,c,h)}catch{}return h})},oe.prototype.update=function(n,r){return typeof n!="object"||E(n)?this.where(":id").equals(n).modify(r):(n=be(n,this.schema.primKey.keyPath),n===void 0?me(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(r))},oe.prototype.put=function(n,r){var o=this,u=this.schema.primKey,s=u.auto,c=u.keyPath,f=n;return c&&s&&(f=Et(c)(n)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"put",values:[f],keys:r!=null?[r]:null})}).then(function(h){return h.numFailures?N.reject(h.failures[0]):h.lastResult}).then(function(h){if(c)try{we(n,c,h)}catch{}return h})},oe.prototype.delete=function(n){var r=this;return this._trans("readwrite",function(o){return r.core.mutate({trans:o,type:"delete",keys:[n]}).then(function(u){return Ot(r,[n],u)}).then(function(u){return u.numFailures?N.reject(u.failures[0]):void 0})})},oe.prototype.clear=function(){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"deleteRange",range:ho}).then(function(o){return Ot(n,null,o)})}).then(function(r){return r.numFailures?N.reject(r.failures[0]):void 0})},oe.prototype.bulkGet=function(n){var r=this;return this._trans("readonly",function(o){return r.core.getMany({keys:n,trans:o}).then(function(u){return u.map(function(s){return r.hook.reading.fire(s)})})})},oe.prototype.bulkAdd=function(n,r,o){var u=this,s=Array.isArray(r)?r:void 0,c=(o=o||(s?void 0:r))?o.allKeys:void 0;return this._trans("readwrite",function(f){var g=u.schema.primKey,h=g.auto,g=g.keyPath;if(g&&s)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=n.length,g=g&&h?n.map(Et(g)):n;return u.core.mutate({trans:f,type:"add",keys:s,values:g,wantResults:c}).then(function(b){var p=b.numFailures,x=b.results,y=b.lastResult,b=b.failures;if(p===0)return c?x:y;throw new Je("".concat(u.name,".bulkAdd(): ").concat(p," of ").concat(v," operations failed"),b)})})},oe.prototype.bulkPut=function(n,r,o){var u=this,s=Array.isArray(r)?r:void 0,c=(o=o||(s?void 0:r))?o.allKeys:void 0;return this._trans("readwrite",function(f){var g=u.schema.primKey,h=g.auto,g=g.keyPath;if(g&&s)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==n.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=n.length,g=g&&h?n.map(Et(g)):n;return u.core.mutate({trans:f,type:"put",keys:s,values:g,wantResults:c}).then(function(b){var p=b.numFailures,x=b.results,y=b.lastResult,b=b.failures;if(p===0)return c?x:y;throw new Je("".concat(u.name,".bulkPut(): ").concat(p," of ").concat(v," operations failed"),b)})})},oe.prototype.bulkUpdate=function(n){var r=this,o=this.core,u=n.map(function(f){return f.key}),s=n.map(function(f){return f.changes}),c=[];return this._trans("readwrite",function(f){return o.getMany({trans:f,keys:u,cache:"clone"}).then(function(h){var v=[],g=[];n.forEach(function(p,x){var y=p.key,b=p.changes,k=h[x];if(k){for(var w=0,z=Object.keys(b);w<z.length;w++){var O=z[w],P=b[O];if(O===r.schema.primKey.keyPath){if(X(P,y)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else we(k,O,P)}c.push(x),v.push(y),g.push(k)}});var _=v.length;return o.mutate({trans:f,type:"put",keys:v,values:g,updates:{keys:u,changeSpecs:s}}).then(function(p){var x=p.numFailures,y=p.failures;if(x===0)return _;for(var b=0,k=Object.keys(y);b<k.length;b++){var w,z=k[b],O=c[Number(z)];O!=null&&(w=y[z],delete y[z],y[O]=w)}throw new Je("".concat(r.name,".bulkUpdate(): ").concat(x," of ").concat(_," operations failed"),y)})})})},oe.prototype.bulkDelete=function(n){var r=this,o=n.length;return this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"delete",keys:n}).then(function(s){return Ot(r,n,s)})}).then(function(f){var s=f.numFailures,c=f.lastResult,f=f.failures;if(s===0)return c;throw new Je("".concat(r.name,".bulkDelete(): ").concat(s," of ").concat(o," operations failed"),f)})},oe);function oe(){}function tt(n){function r(f,h){if(h){for(var v=arguments.length,g=new Array(v-1);--v;)g[v-1]=arguments[v];return o[f].subscribe.apply(null,g),n}if(typeof f=="string")return o[f]}var o={};r.addEventType=c;for(var u=1,s=arguments.length;u<s;++u)c(arguments[u]);return r;function c(f,h,v){if(typeof f!="object"){var g;h=h||qi;var _={subscribers:[],fire:v=v||ne,subscribe:function(p){_.subscribers.indexOf(p)===-1&&(_.subscribers.push(p),_.fire=h(_.fire,p))},unsubscribe:function(p){_.subscribers=_.subscribers.filter(function(x){return x!==p}),_.fire=_.subscribers.reduce(h,v)}};return o[f]=r[f]=_}d(g=f).forEach(function(p){var x=g[p];if(E(x))c(p,g[p][0],g[p][1]);else{if(x!=="asap")throw new q.InvalidArgument("Invalid event config");var y=c(p,Xn,function(){for(var b=arguments.length,k=new Array(b);b--;)k[b]=arguments[b];y.subscribers.forEach(function(w){Ze(function(){w.apply(null,k)})})})}})}}function rt(n,r){return ae(r).from({prototype:n}),r}function Cn(n,r){return!(n.filter||n.algorithm||n.or)&&(r?n.justLimit:!n.replayFilter)}function mr(n,r){n.filter=En(n.filter,r)}function vr(n,r,o){var u=n.replayFilter;n.replayFilter=u?function(){return En(u(),r())}:r,n.justLimit=o&&!u}function Pt(n,r){if(n.isPrimKey)return r.primaryKey;var o=r.getIndexByKeyPath(n.index);if(!o)throw new q.Schema("KeyPath "+n.index+" on object store "+r.name+" is not indexed");return o}function go(n,r,o){var u=Pt(n,r.schema);return r.openCursor({trans:o,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:u,range:n.range}})}function St(n,r,o,u){var s=n.replayFilter?En(n.filter,n.replayFilter()):n.filter;if(n.or){var c={},f=function(h,v,g){var _,p;s&&!s(v,g,function(x){return v.stop(x)},function(x){return v.fail(x)})||((p=""+(_=v.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(_)),U(c,p)||(c[p]=!0,r(h,v,g)))};return Promise.all([n.or._iterate(f,o),bo(go(n,u,o),n.algorithm,f,!n.keysOnly&&n.valueMapper)])}return bo(go(n,u,o),En(n.algorithm,s),r,!n.keysOnly&&n.valueMapper)}function bo(n,r,o,u){var s=ie(u?function(c,f,h){return o(u(c),f,h)}:o);return n.then(function(c){if(c)return c.start(function(){var f=function(){return c.continue()};r&&!r(c,function(h){return f=h},function(h){c.stop(h),f=ne},function(h){c.fail(h),f=ne})||s(c.value,c,function(h){return f=h}),f()})})}var ot=(_o.prototype.execute=function(n){var r=this["@@propmod"];if(r.add!==void 0){var o=r.add;if(E(o))return l(l([],E(n)?n:[],!0),o,!0).sort();if(typeof o=="number")return(Number(n)||0)+o;if(typeof o=="bigint")try{return BigInt(n)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(r.remove!==void 0){var u=r.remove;if(E(u))return E(n)?n.filter(function(s){return!u.includes(s)}).sort():[];if(typeof u=="number")return Number(n)-u;if(typeof u=="bigint")try{return BigInt(n)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return o=(o=r.replacePrefix)===null||o===void 0?void 0:o[0],o&&typeof n=="string"&&n.startsWith(o)?r.replacePrefix[1]+n.substring(o.length):n},_o);function _o(n){this["@@propmod"]=n}var Yi=(Q.prototype._read=function(n,r){var o=this._ctx;return o.error?o.table._trans(null,me.bind(null,o.error)):o.table._trans("readonly",n).then(r)},Q.prototype._write=function(n){var r=this._ctx;return r.error?r.table._trans(null,me.bind(null,r.error)):r.table._trans("readwrite",n,"locked")},Q.prototype._addAlgorithm=function(n){var r=this._ctx;r.algorithm=En(r.algorithm,n)},Q.prototype._iterate=function(n,r){return St(this._ctx,n,r,this._ctx.table.core)},Q.prototype.clone=function(n){var r=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return n&&A(o,n),r._ctx=o,r},Q.prototype.raw=function(){return this._ctx.valueMapper=null,this},Q.prototype.each=function(n){var r=this._ctx;return this._read(function(o){return St(r,n,o,r.table.core)})},Q.prototype.count=function(n){var r=this;return this._read(function(o){var u=r._ctx,s=u.table.core;if(Cn(u,!0))return s.count({trans:o,query:{index:Pt(u,s.schema),range:u.range}}).then(function(f){return Math.min(f,u.limit)});var c=0;return St(u,function(){return++c,!1},o,s).then(function(){return c})}).then(n)},Q.prototype.sortBy=function(n,r){var o=n.split(".").reverse(),u=o[0],s=o.length-1;function c(v,g){return g?c(v[o[g]],g-1):v[u]}var f=this._ctx.dir==="next"?1:-1;function h(v,g){return X(c(v,s),c(g,s))*f}return this.toArray(function(v){return v.sort(h)}).then(r)},Q.prototype.toArray=function(n){var r=this;return this._read(function(o){var u=r._ctx;if(u.dir==="next"&&Cn(u,!0)&&0<u.limit){var s=u.valueMapper,c=Pt(u,u.table.core.schema);return u.table.core.query({trans:o,limit:u.limit,values:!0,query:{index:c,range:u.range}}).then(function(h){return h=h.result,s?h.map(s):h})}var f=[];return St(u,function(h){return f.push(h)},o,u.table.core).then(function(){return f})},n)},Q.prototype.offset=function(n){var r=this._ctx;return n<=0||(r.offset+=n,Cn(r)?vr(r,function(){var o=n;return function(u,s){return o===0||(o===1?--o:s(function(){u.advance(o),o=0}),!1)}}):vr(r,function(){var o=n;return function(){return--o<0}})),this},Q.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),vr(this._ctx,function(){var r=n;return function(o,u,s){return--r<=0&&u(s),0<=r}},!0),this},Q.prototype.until=function(n,r){return mr(this._ctx,function(o,u,s){return!n(o.value)||(u(s),r)}),this},Q.prototype.first=function(n){return this.limit(1).toArray(function(r){return r[0]}).then(n)},Q.prototype.last=function(n){return this.reverse().first(n)},Q.prototype.filter=function(n){var r;return mr(this._ctx,function(o){return n(o.value)}),(r=this._ctx).isMatch=En(r.isMatch,n),this},Q.prototype.and=function(n){return this.filter(n)},Q.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Q.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Q.prototype.desc=function(){return this.reverse()},Q.prototype.eachKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(o,u){n(u.key,u)})},Q.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Q.prototype.eachPrimaryKey=function(n){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(o,u){n(u.primaryKey,u)})},Q.prototype.keys=function(n){var r=this._ctx;r.keysOnly=!r.isMatch;var o=[];return this.each(function(u,s){o.push(s.key)}).then(function(){return o}).then(n)},Q.prototype.primaryKeys=function(n){var r=this._ctx;if(r.dir==="next"&&Cn(r,!0)&&0<r.limit)return this._read(function(u){var s=Pt(r,r.table.core.schema);return r.table.core.query({trans:u,values:!1,limit:r.limit,query:{index:s,range:r.range}})}).then(function(u){return u.result}).then(n);r.keysOnly=!r.isMatch;var o=[];return this.each(function(u,s){o.push(s.primaryKey)}).then(function(){return o}).then(n)},Q.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Q.prototype.firstKey=function(n){return this.limit(1).keys(function(r){return r[0]}).then(n)},Q.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Q.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var r={};return mr(this._ctx,function(s){var u=s.primaryKey.toString(),s=U(r,u);return r[u]=!0,!s}),this},Q.prototype.modify=function(n){var r=this,o=this._ctx;return this._write(function(u){var s,c,f;f=typeof n=="function"?n:(s=d(n),c=s.length,function(z){for(var O=!1,P=0;P<c;++P){var S=s[P],Z=n[S],j=be(z,S);Z instanceof ot?(we(z,S,Z.execute(j)),O=!0):j!==Z&&(we(z,S,Z),O=!0)}return O});var h=o.table.core,p=h.schema.primaryKey,v=p.outbound,g=p.extractKey,_=200,p=r.db._options.modifyChunkSize;p&&(_=typeof p=="object"?p[h.name]||p["*"]||200:p);function x(z,S){var P=S.failures,S=S.numFailures;b+=z-S;for(var Z=0,j=d(P);Z<j.length;Z++){var T=j[Z];y.push(P[T])}}var y=[],b=0,k=[],w=n===wo;return r.clone().primaryKeys().then(function(z){function O(S){var Z=Math.min(_,z.length-S),j=z.slice(S,S+Z);return(w?Promise.resolve([]):h.getMany({trans:u,keys:j,cache:"immutable"})).then(function(T){var $=[],R=[],D=v?[]:null,K=w?j:[];if(!w)for(var G=0;G<Z;++G){var H=T[G],V={value:$e(H),primKey:z[S+G]};f.call(V,V.value,V)!==!1&&(V.value==null?K.push(z[S+G]):v||X(g(H),g(V.value))===0?(R.push(V.value),v&&D.push(z[S+G])):(K.push(z[S+G]),$.push(V.value)))}return Promise.resolve(0<$.length&&h.mutate({trans:u,type:"add",values:$}).then(function(he){for(var L in he.failures)K.splice(parseInt(L),1);x($.length,he)})).then(function(){return(0<R.length||P&&typeof n=="object")&&h.mutate({trans:u,type:"put",keys:D,values:R,criteria:P,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<S}).then(function(he){return x(R.length,he)})}).then(function(){return(0<K.length||P&&w)&&h.mutate({trans:u,type:"delete",keys:K,criteria:P,isAdditionalChunk:0<S}).then(function(he){return Ot(o.table,K,he)}).then(function(he){return x(K.length,he)})}).then(function(){return z.length>S+Z&&O(S+_)})})}var P=Cn(o)&&o.limit===1/0&&(typeof n!="function"||w)&&{index:o.index,range:o.range};return O(0).then(function(){if(0<y.length)throw new yn("Error modifying one or more objects",y,b,k);return z.length})})})},Q.prototype.delete=function(){var n=this._ctx,r=n.range;return!Cn(n)||n.table.schema.yProps||!n.isPrimKey&&r.type!==3?this.modify(wo):this._write(function(o){var u=n.table.core.schema.primaryKey,s=r;return n.table.core.count({trans:o,query:{index:u,range:s}}).then(function(c){return n.table.core.mutate({trans:o,type:"deleteRange",range:s}).then(function(v){var h=v.failures,v=v.numFailures;if(v)throw new yn("Could not delete some values",Object.keys(h).map(function(g){return h[g]}),c-v);return c-v})})})},Q);function Q(){}var wo=function(n,r){return r.value=null};function Gi(n,r){return n<r?-1:n===r?0:1}function Ji(n,r){return r<n?-1:n===r?0:1}function Ae(n,r,o){return n=n instanceof xo?new n.Collection(n):n,n._ctx.error=new(o||TypeError)(r),n}function Dn(n){return new n.Collection(n,function(){return ko("")}).limit(0)}function It(n,r,o,u){var s,c,f,h,v,g,_,p=o.length;if(!o.every(function(b){return typeof b=="string"}))return Ae(n,fo);function x(b){s=b==="next"?function(w){return w.toUpperCase()}:function(w){return w.toLowerCase()},c=b==="next"?function(w){return w.toLowerCase()}:function(w){return w.toUpperCase()},f=b==="next"?Gi:Ji;var k=o.map(function(w){return{lower:c(w),upper:s(w)}}).sort(function(w,z){return f(w.lower,z.lower)});h=k.map(function(w){return w.upper}),v=k.map(function(w){return w.lower}),_=(g=b)==="next"?"":u}x("next"),n=new n.Collection(n,function(){return an(h[0],v[p-1]+u)}),n._ondirectionchange=function(b){x(b)};var y=0;return n._addAlgorithm(function(b,k,w){var z=b.key;if(typeof z!="string")return!1;var O=c(z);if(r(O,v,y))return!0;for(var P=null,S=y;S<p;++S){var Z=function(j,T,$,R,D,K){for(var G=Math.min(j.length,R.length),H=-1,V=0;V<G;++V){var he=T[V];if(he!==R[V])return D(j[V],$[V])<0?j.substr(0,V)+$[V]+$.substr(V+1):D(j[V],R[V])<0?j.substr(0,V)+R[V]+$.substr(V+1):0<=H?j.substr(0,H)+T[H]+$.substr(H+1):null;D(j[V],he)<0&&(H=V)}return G<R.length&&K==="next"?j+$.substr(j.length):G<j.length&&K==="prev"?j.substr(0,$.length):H<0?null:j.substr(0,H)+R[H]+$.substr(H+1)}(z,O,h[S],v[S],f,g);Z===null&&P===null?y=S+1:(P===null||0<f(P,Z))&&(P=Z)}return k(P!==null?function(){b.continue(P+_)}:w),!1}),n}function an(n,r,o,u){return{type:2,lower:n,upper:r,lowerOpen:o,upperOpen:u}}function ko(n){return{type:1,lower:n,upper:n}}var xo=(Object.defineProperty(ge.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ge.prototype.between=function(n,r,o,u){o=o!==!1,u=u===!0;try{return 0<this._cmp(n,r)||this._cmp(n,r)===0&&(o||u)&&(!o||!u)?Dn(this):new this.Collection(this,function(){return an(n,r,!o,!u)})}catch{return Ae(this,Xe)}},ge.prototype.equals=function(n){return n==null?Ae(this,Xe):new this.Collection(this,function(){return ko(n)})},ge.prototype.above=function(n){return n==null?Ae(this,Xe):new this.Collection(this,function(){return an(n,void 0,!0)})},ge.prototype.aboveOrEqual=function(n){return n==null?Ae(this,Xe):new this.Collection(this,function(){return an(n,void 0,!1)})},ge.prototype.below=function(n){return n==null?Ae(this,Xe):new this.Collection(this,function(){return an(void 0,n,!1,!0)})},ge.prototype.belowOrEqual=function(n){return n==null?Ae(this,Xe):new this.Collection(this,function(){return an(void 0,n)})},ge.prototype.startsWith=function(n){return typeof n!="string"?Ae(this,fo):this.between(n,n+zn,!0,!0)},ge.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):It(this,function(r,o){return r.indexOf(o[0])===0},[n],zn)},ge.prototype.equalsIgnoreCase=function(n){return It(this,function(r,o){return r===o[0]},[n],"")},ge.prototype.anyOfIgnoreCase=function(){var n=ee.apply(fe,arguments);return n.length===0?Dn(this):It(this,function(r,o){return o.indexOf(r)!==-1},n,"")},ge.prototype.startsWithAnyOfIgnoreCase=function(){var n=ee.apply(fe,arguments);return n.length===0?Dn(this):It(this,function(r,o){return o.some(function(u){return r.indexOf(u)===0})},n,zn)},ge.prototype.anyOf=function(){var n=this,r=ee.apply(fe,arguments),o=this._cmp;try{r.sort(o)}catch{return Ae(this,Xe)}if(r.length===0)return Dn(this);var u=new this.Collection(this,function(){return an(r[0],r[r.length-1])});u._ondirectionchange=function(c){o=c==="next"?n._ascending:n._descending,r.sort(o)};var s=0;return u._addAlgorithm(function(c,f,h){for(var v=c.key;0<o(v,r[s]);)if(++s===r.length)return f(h),!1;return o(v,r[s])===0||(f(function(){c.continue(r[s])}),!1)}),u},ge.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ge.prototype.noneOf=function(){var n=ee.apply(fe,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return Ae(this,Xe)}var r=n.reduce(function(o,u){return o?o.concat([[o[o.length-1][1],u]]):[[-1/0,u]]},null);return r.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})},ge.prototype.inAnyRange=function(z,r){var o=this,u=this._cmp,s=this._ascending,c=this._descending,f=this._min,h=this._max;if(z.length===0)return Dn(this);if(!z.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&s(O[0],O[1])<=0}))return Ae(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var v=!r||r.includeLowers!==!1,g=r&&r.includeUppers===!0,_,p=s;function x(O,P){return p(O[0],P[0])}try{(_=z.reduce(function(O,P){for(var S=0,Z=O.length;S<Z;++S){var j=O[S];if(u(P[0],j[1])<0&&0<u(P[1],j[0])){j[0]=f(j[0],P[0]),j[1]=h(j[1],P[1]);break}}return S===Z&&O.push(P),O},[])).sort(x)}catch{return Ae(this,Xe)}var y=0,b=g?function(O){return 0<s(O,_[y][1])}:function(O){return 0<=s(O,_[y][1])},k=v?function(O){return 0<c(O,_[y][0])}:function(O){return 0<=c(O,_[y][0])},w=b,z=new this.Collection(this,function(){return an(_[0][0],_[_.length-1][1],!v,!g)});return z._ondirectionchange=function(O){p=O==="next"?(w=b,s):(w=k,c),_.sort(x)},z._addAlgorithm(function(O,P,S){for(var Z,j=O.key;w(j);)if(++y===_.length)return P(S),!1;return!b(Z=j)&&!k(Z)||(o._cmp(j,_[y][1])===0||o._cmp(j,_[y][0])===0||P(function(){p===s?O.continue(_[y][0]):O.continue(_[y][1])}),!1)}),z},ge.prototype.startsWithAnyOf=function(){var n=ee.apply(fe,arguments);return n.every(function(r){return typeof r=="string"})?n.length===0?Dn(this):this.inAnyRange(n.map(function(r){return[r,r+zn]})):Ae(this,"startsWithAnyOf() only works with strings")},ge);function ge(){}function qe(n){return ie(function(r){return it(r),n(r.target.error),!1})}function it(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ut="storagemutated",yr="x-storagemutated-1",sn=tt(null,ut),Xi=(Me.prototype._lock=function(){return pe(!B.global),++this._reculock,this._reculock!==1||B.global||(B.lockOwnerFor=this),this},Me.prototype._unlock=function(){if(pe(!B.global),--this._reculock==0)for(B.global||(B.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{xn(n[1],n[0])}catch{}}return this},Me.prototype._locked=function(){return this._reculock&&B.lockOwnerFor!==this},Me.prototype.create=function(n){var r=this;if(!this.mode)return this;var o=this.db.idbdb,u=this.db._state.dbOpenError;if(pe(!this.idbtrans),!n&&!o)switch(u&&u.name){case"DatabaseClosedError":throw new q.DatabaseClosed(u);case"MissingAPIError":throw new q.MissingAPI(u.message,u);default:throw new q.OpenFailed(u)}if(!this.active)throw new q.TransactionInactive;return pe(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||o).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ie(function(s){it(s),r._reject(n.error)}),n.onabort=ie(function(s){it(s),r.active&&r._reject(new q.Abort(n.error)),r.active=!1,r.on("abort").fire(s)}),n.oncomplete=ie(function(){r.active=!1,r._resolve(),"mutatedParts"in n&&sn.storagemutated.fire(n.mutatedParts)}),this},Me.prototype._promise=function(n,r,o){var u=this;if(n==="readwrite"&&this.mode!=="readwrite")return me(new q.ReadOnly("Transaction is readonly"));if(!this.active)return me(new q.TransactionInactive);if(this._locked())return new N(function(c,f){u._blockedFuncs.push([function(){u._promise(n,r,o).then(c,f)},B])});if(o)return rn(function(){var c=new N(function(f,h){u._lock();var v=r(f,h,u);v&&v.then&&v.then(f,h)});return c.finally(function(){return u._unlock()}),c._lib=!0,c});var s=new N(function(c,f){var h=r(c,f,u);h&&h.then&&h.then(c,f)});return s._lib=!0,s},Me.prototype._root=function(){return this.parent?this.parent._root():this},Me.prototype.waitFor=function(n){var r,o=this._root(),u=N.resolve(n);o._waitingFor?o._waitingFor=o._waitingFor.then(function(){return u}):(o._waitingFor=u,o._waitingQueue=[],r=o.idbtrans.objectStore(o.storeNames[0]),function c(){for(++o._spinCount;o._waitingQueue.length;)o._waitingQueue.shift()();o._waitingFor&&(r.get(-1/0).onsuccess=c)}());var s=o._waitingFor;return new N(function(c,f){u.then(function(h){return o._waitingQueue.push(ie(c.bind(null,h)))},function(h){return o._waitingQueue.push(ie(f.bind(null,h)))}).finally(function(){o._waitingFor===s&&(o._waitingFor=null)})})},Me.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},Me.prototype.table=function(n){var r=this._memoizedTables||(this._memoizedTables={});if(U(r,n))return r[n];var o=this.schema[n];if(!o)throw new q.NotFound("Table "+n+" not part of transaction");return o=new this.db.Table(n,o,this),o.core=this.db.core.table(n),r[n]=o},Me);function Me(){}function gr(n,r,o,u,s,c,f,h){return{name:n,keyPath:r,unique:o,multi:u,auto:s,compound:c,src:(o&&!f?"&":"")+(u?"*":"")+(s?"++":"")+zo(r),type:h}}function zo(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function br(n,r,o){return{name:n,primKey:r,indexes:o,mappedClass:null,idxByName:(u=function(s){return[s.name,s]},o.reduce(function(s,c,f){return f=u(c,f),f&&(s[f[0]]=f[1]),s},{}))};var u}var at=function(n){try{return n.only([[]]),at=function(){return[[]]},[[]]}catch{return at=function(){return zn},zn}};function _r(n){return n==null?function(){}:typeof n=="string"?(r=n).split(".").length===1?function(o){return o[r]}:function(o){return be(o,r)}:function(o){return be(o,n)};var r}function Eo(n){return[].slice.call(n)}var Hi=0;function st(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function Qi(n,r,v){function u(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=w.lower,b=w.upper,k=w.lowerOpen,w=w.upperOpen;return y===void 0?b===void 0?null:r.upperBound(b,!!w):b===void 0?r.lowerBound(y,!!k):r.bound(y,b,!!k,!!w)}function s(x){var y,b=x.name;return{name:b,schema:x,mutate:function(k){var w=k.trans,z=k.type,O=k.keys,P=k.values,S=k.range;return new Promise(function(Z,j){Z=ie(Z);var T=w.objectStore(b),$=T.keyPath==null,R=z==="put"||z==="add";if(!R&&z!=="delete"&&z!=="deleteRange")throw new Error("Invalid operation type: "+z);var D,K=(O||P||{length:1}).length;if(O&&P&&O.length!==P.length)throw new Error("Given keys array must have same length as given values array.");if(K===0)return Z({numFailures:0,failures:{},results:[],lastResult:void 0});function G(Pe){++he,it(Pe)}var H=[],V=[],he=0;if(z==="deleteRange"){if(S.type===4)return Z({numFailures:he,failures:V,results:[],lastResult:void 0});S.type===3?H.push(D=T.clear()):H.push(D=T.delete(u(S)))}else{var $=R?$?[P,O]:[P,null]:[O,null],L=$[0],xe=$[1];if(R)for(var ze=0;ze<K;++ze)H.push(D=xe&&xe[ze]!==void 0?T[z](L[ze],xe[ze]):T[z](L[ze])),D.onerror=G;else for(ze=0;ze<K;++ze)H.push(D=T[z](L[ze])),D.onerror=G}function Ft(Pe){Pe=Pe.target.result,H.forEach(function(Sn,Nr){return Sn.error!=null&&(V[Nr]=Sn.error)}),Z({numFailures:he,failures:V,results:z==="delete"?O:H.map(function(Sn){return Sn.result}),lastResult:Pe})}D.onerror=function(Pe){G(Pe),Ft(Pe)},D.onsuccess=Ft})},getMany:function(k){var w=k.trans,z=k.keys;return new Promise(function(O,P){O=ie(O);for(var S,Z=w.objectStore(b),j=z.length,T=new Array(j),$=0,R=0,D=function(H){H=H.target,T[H._pos]=H.result,++R===$&&O(T)},K=qe(P),G=0;G<j;++G)z[G]!=null&&((S=Z.get(z[G]))._pos=G,S.onsuccess=D,S.onerror=K,++$);$===0&&O(T)})},get:function(k){var w=k.trans,z=k.key;return new Promise(function(O,P){O=ie(O);var S=w.objectStore(b).get(z);S.onsuccess=function(Z){return O(Z.target.result)},S.onerror=qe(P)})},query:(y=g,function(k){return new Promise(function(w,z){w=ie(w);var O,P,S,$=k.trans,Z=k.values,j=k.limit,D=k.query,T=j===1/0?void 0:j,R=D.index,D=D.range,$=$.objectStore(b),R=R.isPrimaryKey?$:$.index(R.name),D=u(D);if(j===0)return w({result:[]});y?((T=Z?R.getAll(D,T):R.getAllKeys(D,T)).onsuccess=function(K){return w({result:K.target.result})},T.onerror=qe(z)):(O=0,P=!Z&&"openKeyCursor"in R?R.openKeyCursor(D):R.openCursor(D),S=[],P.onsuccess=function(K){var G=P.result;return G?(S.push(Z?G.value:G.primaryKey),++O===j?w({result:S}):void G.continue()):w({result:S})},P.onerror=qe(z))})}),openCursor:function(k){var w=k.trans,z=k.values,O=k.query,P=k.reverse,S=k.unique;return new Promise(function(Z,j){Z=ie(Z);var R=O.index,T=O.range,$=w.objectStore(b),$=R.isPrimaryKey?$:$.index(R.name),R=P?S?"prevunique":"prev":S?"nextunique":"next",D=!z&&"openKeyCursor"in $?$.openKeyCursor(u(T),R):$.openCursor(u(T),R);D.onerror=qe(j),D.onsuccess=ie(function(K){var G,H,V,he,L=D.result;L?(L.___id=++Hi,L.done=!1,G=L.continue.bind(L),H=(H=L.continuePrimaryKey)&&H.bind(L),V=L.advance.bind(L),he=function(){throw new Error("Cursor not stopped")},L.trans=w,L.stop=L.continue=L.continuePrimaryKey=L.advance=function(){throw new Error("Cursor not started")},L.fail=ie(j),L.next=function(){var xe=this,ze=1;return this.start(function(){return ze--?xe.continue():xe.stop()}).then(function(){return xe})},L.start=function(xe){function ze(){if(D.result)try{xe()}catch(Pe){L.fail(Pe)}else L.done=!0,L.start=function(){throw new Error("Cursor behind last entry")},L.stop()}var Ft=new Promise(function(Pe,Sn){Pe=ie(Pe),D.onerror=qe(Sn),L.fail=Sn,L.stop=function(Nr){L.stop=L.continue=L.continuePrimaryKey=L.advance=he,Pe(Nr)}});return D.onsuccess=ie(function(Pe){D.onsuccess=ze,ze()}),L.continue=G,L.continuePrimaryKey=H,L.advance=V,ze(),Ft},Z(L)):Z(null)},j)})},count:function(k){var w=k.query,z=k.trans,O=w.index,P=w.range;return new Promise(function(S,Z){var j=z.objectStore(b),T=O.isPrimaryKey?j:j.index(O.name),j=u(P),T=j?T.count(j):T.count();T.onsuccess=ie(function($){return S($.target.result)}),T.onerror=qe(Z)})}}}var c,f,h,_=(f=v,h=Eo((c=n).objectStoreNames),{schema:{name:c.name,tables:h.map(function(x){return f.objectStore(x)}).map(function(x){var y=x.keyPath,w=x.autoIncrement,b=E(y),k={},w={name:x.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:b,keyPath:y,autoIncrement:w,unique:!0,extractKey:_r(y)},indexes:Eo(x.indexNames).map(function(z){return x.index(z)}).map(function(S){var O=S.name,P=S.unique,Z=S.multiEntry,S=S.keyPath,Z={name:O,compound:E(S),keyPath:S,unique:P,multiEntry:Z,extractKey:_r(S)};return k[st(S)]=Z}),getIndexByKeyPath:function(z){return k[st(z)]}};return k[":id"]=w.primaryKey,y!=null&&(k[st(y)]=w.primaryKey),w})},hasGetAll:0<h.length&&"getAll"in f.objectStore(h[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=_.schema,g=_.hasGetAll,_=v.tables.map(s),p={};return _.forEach(function(x){return p[x.name]=x}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(x){if(!p[x])throw new Error("Table '".concat(x,"' not found"));return p[x]},MIN_KEY:-1/0,MAX_KEY:at(r),schema:v}}function eu(n,r,o,u){var s=o.IDBKeyRange;return o.indexedDB,{dbcore:(u=Qi(r,s,u),n.dbcore.reduce(function(c,f){return f=f.create,a(a({},c),f(c))},u))}}function At(n,u){var o=u.db,u=eu(n._middlewares,o,n._deps,u);n.core=u.dbcore,n.tables.forEach(function(s){var c=s.name;n.core.schema.tables.some(function(f){return f.name===c})&&(s.core=n.core.table(c),n[c]instanceof n.Table&&(n[c].core=s.core))})}function Zt(n,r,o,u){o.forEach(function(s){var c=u[s];r.forEach(function(f){var h=function v(g,_){return Ee(g,_)||(g=C(g))&&v(g,_)}(f,s);(!h||"value"in h&&h.value===void 0)&&(f===n.Transaction.prototype||f instanceof n.Transaction?Y(f,s,{get:function(){return this.table(s)},set:function(v){J(this,s,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):f[s]=new n.Table(s,c))})})}function wr(n,r){r.forEach(function(o){for(var u in o)o[u]instanceof n.Table&&delete o[u]})}function nu(n,r){return n._cfg.version-r._cfg.version}function tu(n,r,o,u){var s=n._dbSchema;o.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=br("$meta",Po("")[0],[]),n._storeNames.push("$meta"));var c=n._createTransaction("readwrite",n._storeNames,s);c.create(o),c._completion.catch(u);var f=c._reject.bind(c),h=B.transless||B;rn(function(){return B.trans=c,B.transless=h,r!==0?(At(n,o),g=r,((v=c).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(_){return _??g}):N.resolve(g)).then(function(_){return x=_,y=c,b=o,k=[],_=(p=n)._versions,w=p._dbSchema=$t(0,p.idbdb,b),(_=_.filter(function(z){return z._cfg.version>=x})).length!==0?(_.forEach(function(z){k.push(function(){var O=w,P=z._cfg.dbschema;jt(p,O,b),jt(p,P,b),w=p._dbSchema=P;var S=kr(O,P);S.add.forEach(function(R){xr(b,R[0],R[1].primKey,R[1].indexes)}),S.change.forEach(function(R){if(R.recreate)throw new q.Upgrade("Not yet support for changing primary key");var D=b.objectStore(R.name);R.add.forEach(function(K){return Tt(D,K)}),R.change.forEach(function(K){D.deleteIndex(K.name),Tt(D,K)}),R.del.forEach(function(K){return D.deleteIndex(K)})});var Z=z._cfg.contentUpgrade;if(Z&&z._cfg.version>x){At(p,b),y._memoizedTables={};var j=In(P);S.del.forEach(function(R){j[R]=O[R]}),wr(p,[p.Transaction.prototype]),Zt(p,[p.Transaction.prototype],d(j),j),y.schema=j;var T,$=nn(Z);return $&&$n(),S=N.follow(function(){var R;(T=Z(y))&&$&&(R=on.bind(null,null),T.then(R,R))}),T&&typeof T.then=="function"?N.resolve(T):S.then(function(){return T})}}),k.push(function(O){var P,S,Z=z._cfg.dbschema;P=Z,S=O,[].slice.call(S.db.objectStoreNames).forEach(function(j){return P[j]==null&&S.db.deleteObjectStore(j)}),wr(p,[p.Transaction.prototype]),Zt(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),y.schema=p._dbSchema}),k.push(function(O){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===z._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(P){return P!=="$meta"})):O.objectStore("$meta").put(z._cfg.version,"version"))})}),function z(){return k.length?N.resolve(k.shift()(y.idbtrans)).then(z):N.resolve()}().then(function(){Oo(w,b)})):N.resolve();var p,x,y,b,k,w}).catch(f)):(d(s).forEach(function(_){xr(o,_,s[_].primKey,s[_].indexes)}),At(n,o),void N.follow(function(){return n.on.populate.fire(c)}).catch(f));var v,g})}function ru(n,r){Oo(n._dbSchema,r),r.db.version%10!=0||r.objectStoreNames.contains("$meta")||r.db.createObjectStore("$meta").add(Math.ceil(r.db.version/10-1),"version");var o=$t(0,n.idbdb,r);jt(n,n._dbSchema,r);for(var u=0,s=kr(o,n._dbSchema).change;u<s.length;u++){var c=function(f){if(f.change.length||f.recreate)return console.warn("Unable to patch indexes of table ".concat(f.name," because it has changes on the type of index or primary key.")),{value:void 0};var h=r.objectStore(f.name);f.add.forEach(function(v){Fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(f.name,".").concat(v.src)),Tt(h,v)})}(s[u]);if(typeof c=="object")return c.value}}function kr(n,r){var o,u={del:[],add:[],change:[]};for(o in n)r[o]||u.del.push(o);for(o in r){var s=n[o],c=r[o];if(s){var f={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)f.recreate=!0,u.change.push(f);else{var h=s.idxByName,v=c.idxByName,g=void 0;for(g in h)v[g]||f.del.push(g);for(g in v){var _=h[g],p=v[g];_?_.src!==p.src&&f.change.push(p):f.add.push(p)}(0<f.del.length||0<f.add.length||0<f.change.length)&&u.change.push(f)}}else u.add.push([o,c])}return u}function xr(n,r,o,u){var s=n.db.createObjectStore(r,o.keyPath?{keyPath:o.keyPath,autoIncrement:o.auto}:{autoIncrement:o.auto});return u.forEach(function(c){return Tt(s,c)}),s}function Oo(n,r){d(n).forEach(function(o){r.db.objectStoreNames.contains(o)||(Fe&&console.debug("Dexie: Creating missing table",o),xr(r,o,n[o].primKey,n[o].indexes))})}function Tt(n,r){n.createIndex(r.name,r.keyPath,{unique:r.unique,multiEntry:r.multi})}function $t(n,r,o){var u={};return Oe(r.objectStoreNames,0).forEach(function(s){for(var c=o.objectStore(s),f=gr(zo(g=c.keyPath),g||"",!0,!1,!!c.autoIncrement,g&&typeof g!="string",!0),h=[],v=0;v<c.indexNames.length;++v){var _=c.index(c.indexNames[v]),g=_.keyPath,_=gr(_.name,g,!!_.unique,!!_.multiEntry,!1,g&&typeof g!="string",!1);h.push(_)}u[s]=br(s,f,h)}),u}function jt(n,r,o){for(var u=o.db.objectStoreNames,s=0;s<u.length;++s){var c=u[s],f=o.objectStore(c);n._hasGetAll="getAll"in f;for(var h=0;h<f.indexNames.length;++h){var v=f.indexNames[h],g=f.index(v).keyPath,_=typeof g=="string"?g:"["+Oe(g).join("+")+"]";!r[c]||(g=r[c].idxByName[_])&&(g.name=v,delete r[c].idxByName[_],r[c].idxByName[v]=g)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&m.WorkerGlobalScope&&m instanceof m.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function Po(n){return n.split(",").map(function(r,o){var c=r.split(":"),u=(s=c[1])===null||s===void 0?void 0:s.trim(),s=(r=c[0].trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return gr(s,c||null,/\&/.test(r),/\*/.test(r),/\+\+/.test(r),E(c),o===0,u)})}var ou=(Rn.prototype._createTableSchema=br,Rn.prototype._parseIndexSyntax=Po,Rn.prototype._parseStoresSpec=function(n,r){var o=this;d(n).forEach(function(u){if(n[u]!==null){var s=o._parseIndexSyntax(n[u]),c=s.shift();if(!c)throw new q.Schema("Invalid schema for table "+u+": "+n[u]);if(c.unique=!0,c.multi)throw new q.Schema("Primary key cannot be multiEntry*");s.forEach(function(f){if(f.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!f.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),s=o._createTableSchema(u,c,s),r[u]=s}})},Rn.prototype.stores=function(o){var r=this.db;this._cfg.storesSource=this._cfg.storesSource?A(this._cfg.storesSource,o):o;var o=r._versions,u={},s={};return o.forEach(function(c){A(u,c._cfg.storesSource),s=c._cfg.dbschema={},c._parseStoresSpec(u,s)}),r._dbSchema=s,wr(r,[r._allTables,r,r.Transaction.prototype]),Zt(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],d(s),s),r._storeNames=d(s),this},Rn.prototype.upgrade=function(n){return this._cfg.contentUpgrade=or(this._cfg.contentUpgrade||ne,n),this},Rn);function Rn(){}function zr(n,r){var o=n._dbNamesDB;return o||(o=n._dbNamesDB=new He(zt,{addons:[],indexedDB:n,IDBKeyRange:r})).version(1).stores({dbnames:"name"}),o.table("dbnames")}function Er(n){return n&&typeof n.databases=="function"}function Or(n){return rn(function(){return B.letThrough=!0,n()})}function Pr(n){return!("from"in n)}var ke=function(n,r){if(!this){var o=new ke;return n&&"d"in n&&A(o,n),o}A(this,arguments.length?{d:1,from:n,to:1<arguments.length?r:n}:{d:0})};function ct(n,r,o){var u=X(r,o);if(!isNaN(u)){if(0<u)throw RangeError();if(Pr(n))return A(n,{from:r,to:o,d:1});var s=n.l,u=n.r;if(X(o,n.from)<0)return s?ct(s,r,o):n.l={from:r,to:o,d:1,l:null,r:null},Io(n);if(0<X(r,n.to))return u?ct(u,r,o):n.r={from:r,to:o,d:1,l:null,r:null},Io(n);X(r,n.from)<0&&(n.from=r,n.l=null,n.d=u?u.d+1:1),0<X(o,n.to)&&(n.to=o,n.r=null,n.d=n.l?n.l.d+1:1),o=!n.r,s&&!n.l&&lt(n,s),u&&o&&lt(n,u)}}function lt(n,r){Pr(r)||function o(u,v){var c=v.from,f=v.to,h=v.l,v=v.r;ct(u,c,f),h&&o(u,h),v&&o(u,v)}(n,r)}function So(n,r){var o=Ct(r),u=o.next();if(u.done)return!1;for(var s=u.value,c=Ct(n),f=c.next(s.from),h=f.value;!u.done&&!f.done;){if(X(h.from,s.to)<=0&&0<=X(h.to,s.from))return!0;X(s.from,h.from)<0?s=(u=o.next(h.from)).value:h=(f=c.next(s.from)).value}return!1}function Ct(n){var r=Pr(n)?null:{s:0,n};return{next:function(o){for(var u=0<arguments.length;r;)switch(r.s){case 0:if(r.s=1,u)for(;r.n.l&&X(o,r.n.from)<0;)r={up:r,n:r.n.l,s:1};else for(;r.n.l;)r={up:r,n:r.n.l,s:1};case 1:if(r.s=2,!u||X(o,r.n.to)<=0)return{value:r.n,done:!1};case 2:if(r.n.r){r.s=3,r={up:r,n:r.n.r,s:0};continue}case 3:r=r.up}return{done:!0}}}}function Io(n){var r,o,u=(((r=n.r)===null||r===void 0?void 0:r.d)||0)-(((o=n.l)===null||o===void 0?void 0:o.d)||0),s=1<u?"r":u<-1?"l":"";s&&(r=s=="r"?"l":"r",o=a({},n),u=n[s],n.from=u.from,n.to=u.to,n[s]=u[s],o[s]=u[r],(n[r]=o).d=Ao(o)),n.d=Ao(n)}function Ao(o){var r=o.r,o=o.l;return(r?o?Math.max(r.d,o.d):r.d:o?o.d:0)+1}function Dt(n,r){return d(r).forEach(function(o){n[o]?lt(n[o],r[o]):n[o]=function u(s){var c,f,h={};for(c in s)U(s,c)&&(f=s[c],h[c]=!f||typeof f!="object"||vn.has(f.constructor)?f:u(f));return h}(r[o])}),n}function Sr(n,r){return n.all||r.all||Object.keys(n).some(function(o){return r[o]&&So(r[o],n[o])})}W(ke.prototype,((je={add:function(n){return lt(this,n),this},addKey:function(n){return ct(this,n,n),this},addKeys:function(n){var r=this;return n.forEach(function(o){return ct(r,o,o)}),this},hasKey:function(n){var r=Ct(this).next(n).value;return r&&X(r.from,n)<=0&&0<=X(r.to,n)}})[en]=function(){return Ct(this)},je));var On={},Ir={},Ar=!1;function Rt(n){Dt(Ir,n),Ar||(Ar=!0,setTimeout(function(){Ar=!1,Zr(Ir,!(Ir={}))},0))}function Zr(n,r){r===void 0&&(r=!1);var o=new Set;if(n.all)for(var u=0,s=Object.values(On);u<s.length;u++)Zo(f=s[u],n,o,r);else for(var c in n){var f,h=/^idb\:\/\/(.*)\/(.*)\//.exec(c);h&&(c=h[1],h=h[2],(f=On["idb://".concat(c,"/").concat(h)])&&Zo(f,n,o,r))}o.forEach(function(v){return v()})}function Zo(n,r,o,u){for(var s=[],c=0,f=Object.entries(n.queries.query);c<f.length;c++){for(var h=f[c],v=h[0],g=[],_=0,p=h[1];_<p.length;_++){var x=p[_];Sr(r,x.obsSet)?x.subscribers.forEach(function(w){return o.add(w)}):u&&g.push(x)}u&&s.push([v,g])}if(u)for(var y=0,b=s;y<b.length;y++){var k=b[y],v=k[0],g=k[1];n.queries.query[v]=g}}function iu(n){var r=n._state,o=n._deps.indexedDB;if(r.isBeingOpened||n.idbdb)return r.dbReadyPromise.then(function(){return r.dbOpenError?me(r.dbOpenError):n});r.isBeingOpened=!0,r.dbOpenError=null,r.openComplete=!1;var u=r.openCanceller,s=Math.round(10*n.verno),c=!1;function f(){if(r.openCanceller!==u)throw new q.DatabaseClosed("db.open() was cancelled")}function h(){return new N(function(x,y){if(f(),!o)throw new q.MissingAPI;var b=n.name,k=r.autoSchema||!s?o.open(b):o.open(b,s);if(!k)throw new q.MissingAPI;k.onerror=qe(y),k.onblocked=ie(n._fireOnBlocked),k.onupgradeneeded=ie(function(w){var z;_=k.transaction,r.autoSchema&&!n._options.allowEmptyDB?(k.onerror=it,_.abort(),k.result.close(),(z=o.deleteDatabase(b)).onsuccess=z.onerror=ie(function(){y(new q.NoSuchDatabase("Database ".concat(b," doesnt exist")))})):(_.onerror=qe(y),w=w.oldVersion>Math.pow(2,62)?0:w.oldVersion,p=w<1,n.idbdb=k.result,c&&ru(n,_),tu(n,w/10,_,y))},y),k.onsuccess=ie(function(){_=null;var w,z,O,P,S,Z=n.idbdb=k.result,j=Oe(Z.objectStoreNames);if(0<j.length)try{var T=Z.transaction((P=j).length===1?P[0]:P,"readonly");if(r.autoSchema)z=Z,O=T,(w=n).verno=z.version/10,O=w._dbSchema=$t(0,z,O),w._storeNames=Oe(z.objectStoreNames,0),Zt(w,[w._allTables],d(O),O);else if(jt(n,n._dbSchema,T),((S=kr($t(0,(S=n).idbdb,T),S._dbSchema)).add.length||S.change.some(function($){return $.add.length||$.change.length}))&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Z.close(),s=Z.version+1,c=!0,x(h());At(n,T)}catch{}jn.push(n),Z.onversionchange=ie(function($){r.vcFired=!0,n.on("versionchange").fire($)}),Z.onclose=ie(function($){n.on("close").fire($)}),p&&(S=n._deps,T=b,Z=S.indexedDB,S=S.IDBKeyRange,Er(Z)||T===zt||zr(Z,S).put({name:T}).catch(ne)),x()},y)}).catch(function(x){switch(x?.name){case"UnknownError":if(0<r.PR1398_maxLoop)return r.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),h();break;case"VersionError":if(0<s)return s=0,h()}return N.reject(x)})}var v,g=r.dbReadyResolve,_=null,p=!1;return N.race([u,(typeof navigator>"u"?N.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(x){function y(){return indexedDB.databases().finally(x)}v=setInterval(y,100),y()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(h)]).then(function(){return f(),r.onReadyBeingFired=[],N.resolve(Or(function(){return n.on.ready.fire(n.vip)})).then(function x(){if(0<r.onReadyBeingFired.length){var y=r.onReadyBeingFired.reduce(or,ne);return r.onReadyBeingFired=[],N.resolve(Or(function(){return y(n.vip)})).then(x)}})}).finally(function(){r.openCanceller===u&&(r.onReadyBeingFired=null,r.isBeingOpened=!1)}).catch(function(x){r.dbOpenError=x;try{_&&_.abort()}catch{}return u===r.openCanceller&&n._close(),me(x)}).finally(function(){r.openComplete=!0,g()}).then(function(){var x;return p&&(x={},n.tables.forEach(function(y){y.schema.indexes.forEach(function(b){b.name&&(x["idb://".concat(n.name,"/").concat(y.name,"/").concat(b.name)]=new ke(-1/0,[[[]]]))}),x["idb://".concat(n.name,"/").concat(y.name,"/")]=x["idb://".concat(n.name,"/").concat(y.name,"/:dels")]=new ke(-1/0,[[[]]])}),sn(ut).fire(x),Zr(x,!0)),n})}function Tr(n){function r(c){return n.next(c)}var o=s(r),u=s(function(c){return n.throw(c)});function s(c){return function(v){var h=c(v),v=h.value;return h.done?v:v&&typeof v.then=="function"?v.then(o,u):E(v)?Promise.all(v).then(o,u):o(v)}}return s(r)()}function Nt(n,r,o){for(var u=E(n)?n.slice():[n],s=0;s<o;++s)u.push(r);return u}var uu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return a(a({},n),{table:function(r){var o=n.table(r),u=o.schema,s={},c=[];function f(p,x,y){var b=st(p),k=s[b]=s[b]||[],w=p==null?0:typeof p=="string"?1:p.length,z=0<x,z=a(a({},y),{name:z?"".concat(b,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:z,keyTail:x,keyLength:w,extractKey:_r(p),unique:!z&&y.unique});return k.push(z),z.isPrimaryKey||c.push(z),1<w&&f(w===2?p[0]:p.slice(0,w-1),x+1,y),k.sort(function(O,P){return O.keyTail-P.keyTail}),z}r=f(u.primaryKey.keyPath,0,u.primaryKey),s[":id"]=[r];for(var h=0,v=u.indexes;h<v.length;h++){var g=v[h];f(g.keyPath,0,g)}function _(p){var x,y=p.query.index;return y.isVirtual?a(a({},p),{query:{index:y.lowLevelIndex,range:(x=p.query.range,y=y.keyTail,{type:x.type===1?2:x.type,lower:Nt(x.lower,x.lowerOpen?n.MAX_KEY:n.MIN_KEY,y),lowerOpen:!0,upper:Nt(x.upper,x.upperOpen?n.MIN_KEY:n.MAX_KEY,y),upperOpen:!0})}}):p}return a(a({},o),{schema:a(a({},u),{primaryKey:r,indexes:c,getIndexByKeyPath:function(p){return(p=s[st(p)])&&p[0]}}),count:function(p){return o.count(_(p))},query:function(p){return o.query(_(p))},openCursor:function(p){var x=p.query.index,y=x.keyTail,b=x.isVirtual,k=x.keyLength;return b?o.openCursor(_(p)).then(function(z){return z&&w(z)}):o.openCursor(p);function w(z){return Object.create(z,{continue:{value:function(O){O!=null?z.continue(Nt(O,p.reverse?n.MAX_KEY:n.MIN_KEY,y)):p.unique?z.continue(z.key.slice(0,k).concat(p.reverse?n.MIN_KEY:n.MAX_KEY,y)):z.continue()}},continuePrimaryKey:{value:function(O,P){z.continuePrimaryKey(Nt(O,n.MAX_KEY,y),P)}},primaryKey:{get:function(){return z.primaryKey}},key:{get:function(){var O=z.key;return k===1?O[0]:O.slice(0,k)}},value:{get:function(){return z.value}}})}}})}})}};function $r(n,r,o,u){return o=o||{},u=u||"",d(n).forEach(function(s){var c,f,h;U(r,s)?(c=n[s],f=r[s],typeof c=="object"&&typeof f=="object"&&c&&f?(h=Ye(c))!==Ye(f)?o[u+s]=r[s]:h==="Object"?$r(c,f,o,u+s+"."):c!==f&&(o[u+s]=r[s]):c!==f&&(o[u+s]=r[s])):o[u+s]=void 0}),d(r).forEach(function(s){U(n,s)||(o[u+s]=r[s])}),o}function jr(n,r){return r.type==="delete"?r.keys:r.keys||r.values.map(n.extractKey)}var au={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return a(a({},n),{table:function(r){var o=n.table(r),u=o.schema.primaryKey;return a(a({},o),{mutate:function(s){var c=B.trans,f=c.table(r).hook,h=f.deleting,v=f.creating,g=f.updating;switch(s.type){case"add":if(v.fire===ne)break;return c._promise("readwrite",function(){return _(s)},!0);case"put":if(v.fire===ne&&g.fire===ne)break;return c._promise("readwrite",function(){return _(s)},!0);case"delete":if(h.fire===ne)break;return c._promise("readwrite",function(){return _(s)},!0);case"deleteRange":if(h.fire===ne)break;return c._promise("readwrite",function(){return function p(x,y,b){return o.query({trans:x,values:!1,query:{index:u,range:y},limit:b}).then(function(k){var w=k.result;return _({type:"delete",keys:w,trans:x}).then(function(z){return 0<z.numFailures?Promise.reject(z.failures[0]):w.length<b?{failures:[],numFailures:0,lastResult:void 0}:p(x,a(a({},y),{lower:w[w.length-1],lowerOpen:!0}),b)})})}(s.trans,s.range,1e4)},!0)}return o.mutate(s);function _(p){var x,y,b,k=B.trans,w=p.keys||jr(u,p);if(!w)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?a(a({},p),{keys:w}):a({},p)).type!=="delete"&&(p.values=l([],p.values,!0)),p.keys&&(p.keys=l([],p.keys,!0)),x=o,b=w,((y=p).type==="add"?Promise.resolve([]):x.getMany({trans:y.trans,keys:b,cache:"immutable"})).then(function(z){var O=w.map(function(P,S){var Z,j,T,$=z[S],R={onerror:null,onsuccess:null};return p.type==="delete"?h.fire.call(R,P,$,k):p.type==="add"||$===void 0?(Z=v.fire.call(R,P,p.values[S],k),P==null&&Z!=null&&(p.keys[S]=P=Z,u.outbound||we(p.values[S],u.keyPath,P))):(Z=$r($,p.values[S]),(j=g.fire.call(R,Z,P,$,k))&&(T=p.values[S],Object.keys(j).forEach(function(D){U(T,D)?T[D]=j[D]:we(T,D,j[D])}))),R});return o.mutate(p).then(function(P){for(var S=P.failures,Z=P.results,j=P.numFailures,P=P.lastResult,T=0;T<w.length;++T){var $=(Z||w)[T],R=O[T];$==null?R.onerror&&R.onerror(S[T]):R.onsuccess&&R.onsuccess(p.type==="put"&&z[T]?p.values[T]:$)}return{failures:S,results:Z,numFailures:j,lastResult:P}}).catch(function(P){return O.forEach(function(S){return S.onerror&&S.onerror(P)}),Promise.reject(P)})})}}})}})}};function To(n,r,o){try{if(!r||r.keys.length<n.length)return null;for(var u=[],s=0,c=0;s<r.keys.length&&c<n.length;++s)X(r.keys[s],n[c])===0&&(u.push(o?$e(r.values[s]):r.values[s]),++c);return u.length===n.length?u:null}catch{return null}}var su={stack:"dbcore",level:-1,create:function(n){return{table:function(r){var o=n.table(r);return a(a({},o),{getMany:function(u){if(!u.cache)return o.getMany(u);var s=To(u.keys,u.trans._cache,u.cache==="clone");return s?N.resolve(s):o.getMany(u).then(function(c){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?$e(c):c},c})},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),o.mutate(u)}})}}}};function $o(n,r){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!r.schema.primaryKey.outbound}function jo(n,r){switch(n){case"query":return r.values&&!r.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var cu={stack:"dbcore",level:0,name:"Observability",create:function(n){var r=n.schema.name,o=new ke(n.MIN_KEY,n.MAX_KEY);return a(a({},n),{transaction:function(u,s,c){if(B.subscr&&s!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(B.querier));return n.transaction(u,s,c)},table:function(u){var s=n.table(u),c=s.schema,f=c.primaryKey,p=c.indexes,h=f.extractKey,v=f.outbound,g=f.autoIncrement&&p.filter(function(y){return y.compound&&y.keyPath.includes(f.keyPath)}),_=a(a({},s),{mutate:function(y){function b(D){return D="idb://".concat(r,"/").concat(u,"/").concat(D),P[D]||(P[D]=new ke)}var k,w,z,O=y.trans,P=y.mutatedParts||(y.mutatedParts={}),S=b(""),Z=b(":dels"),j=y.type,R=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[jr(f,y).filter(function(D){return D}),y.values]:[],T=R[0],$=R[1],R=y.trans._cache;return E(T)?(S.addKeys(T),(R=j==="delete"||T.length===$.length?To(T,R):null)||Z.addKeys(T),(R||$)&&(k=b,w=R,z=$,c.indexes.forEach(function(D){var K=k(D.name||"");function G(V){return V!=null?D.extractKey(V):null}function H(V){return D.multiEntry&&E(V)?V.forEach(function(he){return K.addKey(he)}):K.addKey(V)}(w||z).forEach(function(V,xe){var L=w&&G(w[xe]),xe=z&&G(z[xe]);X(L,xe)!==0&&(L!=null&&H(L),xe!=null&&H(xe))})}))):T?($={from:($=T.lower)!==null&&$!==void 0?$:n.MIN_KEY,to:($=T.upper)!==null&&$!==void 0?$:n.MAX_KEY},Z.add($),S.add($)):(S.add(o),Z.add(o),c.indexes.forEach(function(D){return b(D.name).add(o)})),s.mutate(y).then(function(D){return!T||y.type!=="add"&&y.type!=="put"||(S.addKeys(D.results),g&&g.forEach(function(K){for(var G=y.values.map(function(L){return K.extractKey(L)}),H=K.keyPath.findIndex(function(L){return L===f.keyPath}),V=0,he=D.results.length;V<he;++V)G[V][H]=D.results[V];b(K.name).addKeys(G)})),O.mutatedParts=Dt(O.mutatedParts||{},P),D})}}),p=function(b){var k=b.query,b=k.index,k=k.range;return[b,new ke((b=k.lower)!==null&&b!==void 0?b:n.MIN_KEY,(k=k.upper)!==null&&k!==void 0?k:n.MAX_KEY)]},x={get:function(y){return[f,new ke(y.key)]},getMany:function(y){return[f,new ke().addKeys(y.keys)]},count:p,query:p,openCursor:p};return d(x).forEach(function(y){_[y]=function(b){var k=B.subscr,w=!!k,z=$o(B,s)&&jo(y,b)?b.obsSet={}:k;if(w){var O=function($){return $="idb://".concat(r,"/").concat(u,"/").concat($),z[$]||(z[$]=new ke)},P=O(""),S=O(":dels"),k=x[y](b),w=k[0],k=k[1];if((y==="query"&&w.isPrimaryKey&&!b.values?S:O(w.name||"")).add(k),!w.isPrimaryKey){if(y!=="count"){var Z=y==="query"&&v&&b.values&&s.query(a(a({},b),{values:!1}));return s[y].apply(this,arguments).then(function($){if(y==="query"){if(v&&b.values)return Z.then(function(G){return G=G.result,P.addKeys(G),$});var R=b.values?$.result.map(h):$.result;(b.values?P:S).addKeys(R)}else if(y==="openCursor"){var D=$,K=b.values;return D&&Object.create(D,{key:{get:function(){return S.addKey(D.primaryKey),D.key}},primaryKey:{get:function(){var G=D.primaryKey;return S.addKey(G),G}},value:{get:function(){return K&&P.addKey(D.primaryKey),D.value}}})}return $})}S.add(o)}}return s[y].apply(this,arguments)}}),_}})}};function Co(n,r,o){if(o.numFailures===0)return r;if(r.type==="deleteRange")return null;var u=r.keys?r.keys.length:"values"in r&&r.values?r.values.length:1;return o.numFailures===u?null:(r=a({},r),E(r.keys)&&(r.keys=r.keys.filter(function(s,c){return!(c in o.failures)})),"values"in r&&E(r.values)&&(r.values=r.values.filter(function(s,c){return!(c in o.failures)})),r)}function Cr(n,r){return o=n,((u=r).lower===void 0||(u.lowerOpen?0<X(o,u.lower):0<=X(o,u.lower)))&&(n=n,(r=r).upper===void 0||(r.upperOpen?X(n,r.upper)<0:X(n,r.upper)<=0));var o,u}function Do(n,r,x,u,s,c){if(!x||x.length===0)return n;var f=r.query.index,h=f.multiEntry,v=r.query.range,g=u.schema.primaryKey.extractKey,_=f.extractKey,p=(f.lowLevelIndex||f).extractKey,x=x.reduce(function(y,b){var k=y,w=[];if(b.type==="add"||b.type==="put")for(var z=new ke,O=b.values.length-1;0<=O;--O){var P,S=b.values[O],Z=g(S);z.hasKey(Z)||(P=_(S),(h&&E(P)?P.some(function(D){return Cr(D,v)}):Cr(P,v))&&(z.addKey(Z),w.push(S)))}switch(b.type){case"add":var j=new ke().addKeys(r.values?y.map(function(K){return g(K)}):y),k=y.concat(r.values?w.filter(function(K){return K=g(K),!j.hasKey(K)&&(j.addKey(K),!0)}):w.map(function(K){return g(K)}).filter(function(K){return!j.hasKey(K)&&(j.addKey(K),!0)}));break;case"put":var T=new ke().addKeys(b.values.map(function(K){return g(K)}));k=y.filter(function(K){return!T.hasKey(r.values?g(K):K)}).concat(r.values?w:w.map(function(K){return g(K)}));break;case"delete":var $=new ke().addKeys(b.keys);k=y.filter(function(K){return!$.hasKey(r.values?g(K):K)});break;case"deleteRange":var R=b.range;k=y.filter(function(K){return!Cr(g(K),R)})}return k},n);return x===n?n:(x.sort(function(y,b){return X(p(y),p(b))||X(g(y),g(b))}),r.limit&&r.limit<1/0&&(x.length>r.limit?x.length=r.limit:n.length===r.limit&&x.length<r.limit&&(s.dirty=!0)),c?Object.freeze(x):x)}function Ro(n,r){return X(n.lower,r.lower)===0&&X(n.upper,r.upper)===0&&!!n.lowerOpen==!!r.lowerOpen&&!!n.upperOpen==!!r.upperOpen}function lu(n,r){return function(o,u,s,c){if(o===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((u=X(o,u))===0){if(s&&c)return 0;if(s)return 1;if(c)return-1}return u}(n.lower,r.lower,n.lowerOpen,r.lowerOpen)<=0&&0<=function(o,u,s,c){if(o===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((u=X(o,u))===0){if(s&&c)return 0;if(s)return-1;if(c)return 1}return u}(n.upper,r.upper,n.upperOpen,r.upperOpen)}function fu(n,r,o,u){n.subscribers.add(o),u.addEventListener("abort",function(){var s,c;n.subscribers.delete(o),n.subscribers.size===0&&(s=n,c=r,setTimeout(function(){s.subscribers.size===0&&Ke(c,s)},3e3))})}var hu={stack:"dbcore",level:0,name:"Cache",create:function(n){var r=n.schema.name;return a(a({},n),{transaction:function(o,u,s){var c,f,h=n.transaction(o,u,s);return u==="readwrite"&&(f=(c=new AbortController).signal,s=function(v){return function(){if(c.abort(),u==="readwrite"){for(var g=new Set,_=0,p=o;_<p.length;_++){var x=p[_],y=On["idb://".concat(r,"/").concat(x)];if(y){var b=n.table(x),k=y.optimisticOps.filter(function(K){return K.trans===h});if(h._explicit&&v&&h.mutatedParts)for(var w=0,z=Object.values(y.queries.query);w<z.length;w++)for(var O=0,P=(j=z[w]).slice();O<P.length;O++)Sr((T=P[O]).obsSet,h.mutatedParts)&&(Ke(j,T),T.subscribers.forEach(function(K){return g.add(K)}));else if(0<k.length){y.optimisticOps=y.optimisticOps.filter(function(K){return K.trans!==h});for(var S=0,Z=Object.values(y.queries.query);S<Z.length;S++)for(var j,T,$,R=0,D=(j=Z[S]).slice();R<D.length;R++)(T=D[R]).res!=null&&h.mutatedParts&&(v&&!T.dirty?($=Object.isFrozen(T.res),$=Do(T.res,T.req,k,b,T,$),T.dirty?(Ke(j,T),T.subscribers.forEach(function(K){return g.add(K)})):$!==T.res&&(T.res=$,T.promise=N.resolve({result:$}))):(T.dirty&&Ke(j,T),T.subscribers.forEach(function(K){return g.add(K)})))}}}g.forEach(function(K){return K()})}}},h.addEventListener("abort",s(!1),{signal:f}),h.addEventListener("error",s(!1),{signal:f}),h.addEventListener("complete",s(!0),{signal:f})),h},table:function(o){var u=n.table(o),s=u.schema.primaryKey;return a(a({},u),{mutate:function(c){var f=B.trans;if(s.outbound||f.db._options.cache==="disabled"||f.explicit||f.idbtrans.mode!=="readwrite")return u.mutate(c);var h=On["idb://".concat(r,"/").concat(o)];return h?(f=u.mutate(c),c.type!=="add"&&c.type!=="put"||!(50<=c.values.length||jr(s,c).some(function(v){return v==null}))?(h.optimisticOps.push(c),c.mutatedParts&&Rt(c.mutatedParts),f.then(function(v){0<v.numFailures&&(Ke(h.optimisticOps,c),(v=Co(0,c,v))&&h.optimisticOps.push(v),c.mutatedParts&&Rt(c.mutatedParts))}),f.catch(function(){Ke(h.optimisticOps,c),c.mutatedParts&&Rt(c.mutatedParts)})):f.then(function(v){var g=Co(0,a(a({},c),{values:c.values.map(function(_,p){var x;return v.failures[p]?_:(_=(x=s.keyPath)!==null&&x!==void 0&&x.includes(".")?$e(_):a({},_),we(_,s.keyPath,v.results[p]),_)})}),v);h.optimisticOps.push(g),queueMicrotask(function(){return c.mutatedParts&&Rt(c.mutatedParts)})}),f):u.mutate(c)},query:function(c){if(!$o(B,u)||!jo("query",c))return u.query(c);var f=((g=B.trans)===null||g===void 0?void 0:g.db._options.cache)==="immutable",p=B,h=p.requery,v=p.signal,g=function(b,k,w,z){var O=On["idb://".concat(b,"/").concat(k)];if(!O)return[];if(!(k=O.queries[w]))return[null,!1,O,null];var P=k[(z.query?z.query.index.name:null)||""];if(!P)return[null,!1,O,null];switch(w){case"query":var S=P.find(function(Z){return Z.req.limit===z.limit&&Z.req.values===z.values&&Ro(Z.req.query.range,z.query.range)});return S?[S,!0,O,P]:[P.find(function(Z){return("limit"in Z.req?Z.req.limit:1/0)>=z.limit&&(!z.values||Z.req.values)&&lu(Z.req.query.range,z.query.range)}),!1,O,P];case"count":return S=P.find(function(Z){return Ro(Z.req.query.range,z.query.range)}),[S,!!S,O,P]}}(r,o,"query",c),_=g[0],p=g[1],x=g[2],y=g[3];return _&&p?_.obsSet=c.obsSet:(p=u.query(c).then(function(b){var k=b.result;if(_&&(_.res=k),f){for(var w=0,z=k.length;w<z;++w)Object.freeze(k[w]);Object.freeze(k)}else b.result=$e(k);return b}).catch(function(b){return y&&_&&Ke(y,_),Promise.reject(b)}),_={obsSet:c.obsSet,promise:p,subscribers:new Set,type:"query",req:c,dirty:!1},y?y.push(_):(y=[_],(x=x||(On["idb://".concat(r,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[c.query.index.name||""]=y)),fu(_,y,h,v),_.promise.then(function(b){return{result:Do(b.result,c,x?.optimisticOps,u,_,f)}})}})}})}};function Kt(n,r){return new Proxy(n,{get:function(o,u,s){return u==="db"?r:Reflect.get(o,u,s)}})}var He=(ve.prototype.version=function(n){if(isNaN(n)||n<.1)throw new q.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var r=this._versions,o=r.filter(function(u){return u._cfg.version===n})[0];return o||(o=new this.Version(n),r.push(o),r.sort(nu),o.stores({}),this._state.autoSchema=!1,o)},ve.prototype._whenReady=function(n){var r=this;return this.idbdb&&(this._state.openComplete||B.letThrough||this._vip)?n():new N(function(o,u){if(r._state.openComplete)return u(new q.DatabaseClosed(r._state.dbOpenError));if(!r._state.isBeingOpened){if(!r._state.autoOpen)return void u(new q.DatabaseClosed);r.open().catch(ne)}r._state.dbReadyPromise.then(o,u)}).then(n)},ve.prototype.use=function(n){var r=n.stack,o=n.create,u=n.level,s=n.name;return s&&this.unuse({stack:r,name:s}),n=this._middlewares[r]||(this._middlewares[r]=[]),n.push({stack:r,create:o,level:u??10,name:s}),n.sort(function(c,f){return c.level-f.level}),this},ve.prototype.unuse=function(n){var r=n.stack,o=n.name,u=n.create;return r&&this._middlewares[r]&&(this._middlewares[r]=this._middlewares[r].filter(function(s){return u?s.create!==u:!!o&&s.name!==o})),this},ve.prototype.open=function(){var n=this;return xn(tn,function(){return iu(n)})},ve.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var n=this._state,r=jn.indexOf(this);if(0<=r&&jn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new N(function(o){n.dbReadyResolve=o}),n.openCanceller=new N(function(o,u){n.cancelOpen=u}))},ve.prototype.close=function(o){var r=(o===void 0?{disableAutoOpen:!0}:o).disableAutoOpen,o=this._state;r?(o.isBeingOpened&&o.cancelOpen(new q.DatabaseClosed),this._close(),o.autoOpen=!1,o.dbOpenError=new q.DatabaseClosed):(this._close(),o.autoOpen=this._options.autoOpen||o.isBeingOpened,o.openComplete=!1,o.dbOpenError=null)},ve.prototype.delete=function(n){var r=this;n===void 0&&(n={disableAutoOpen:!0});var o=0<arguments.length&&typeof arguments[0]!="object",u=this._state;return new N(function(s,c){function f(){r.close(n);var h=r._deps.indexedDB.deleteDatabase(r.name);h.onsuccess=ie(function(){var v,g,_;v=r._deps,g=r.name,_=v.indexedDB,v=v.IDBKeyRange,Er(_)||g===zt||zr(_,v).delete(g).catch(ne),s()}),h.onerror=qe(c),h.onblocked=r._fireOnBlocked}if(o)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(f):f()})},ve.prototype.backendDB=function(){return this.idbdb},ve.prototype.isOpen=function(){return this.idbdb!==null},ve.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},ve.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ve.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ve.prototype,"tables",{get:function(){var n=this;return d(this._allTables).map(function(r){return n._allTables[r]})},enumerable:!1,configurable:!0}),ve.prototype.transaction=function(){var n=function(r,o,u){var s=arguments.length;if(s<2)throw new q.InvalidArgument("Too few arguments");for(var c=new Array(s-1);--s;)c[s-1]=arguments[s];return u=c.pop(),[r,An(c),u]}.apply(this,arguments);return this._transaction.apply(this,n)},ve.prototype._transaction=function(n,r,o){var u=this,s=B.trans;s&&s.db===this&&n.indexOf("!")===-1||(s=null);var c,f,h=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(f=r.map(function(g){if(g=g instanceof u.Table?g.name:g,typeof g!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return g}),n=="r"||n===dr)c=dr;else{if(n!="rw"&&n!=pr)throw new q.InvalidArgument("Invalid transaction mode: "+n);c=pr}if(s){if(s.mode===dr&&c===pr){if(!h)throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&f.forEach(function(g){if(s&&s.storeNames.indexOf(g)===-1){if(!h)throw new q.SubTransaction("Table "+g+" not included in parent transaction.");s=null}}),h&&s&&!s.active&&(s=null)}}catch(g){return s?s._promise(null,function(_,p){p(g)}):me(g)}var v=function g(_,p,x,y,b){return N.resolve().then(function(){var k=B.transless||B,w=_._createTransaction(p,x,_._dbSchema,y);if(w.explicit=!0,k={trans:w,transless:k},y)w.idbtrans=y.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(P){return P.name===Ne.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return g(_,p,x,null,b)})):me(P)}var z,O=nn(b);return O&&$n(),k=N.follow(function(){var P;(z=b.call(w,w))&&(O?(P=on.bind(null,null),z.then(P,P)):typeof z.next=="function"&&typeof z.throw=="function"&&(z=Tr(z)))},k),(z&&typeof z.then=="function"?N.resolve(z).then(function(P){return w.active?P:me(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):k.then(function(){return z})).then(function(P){return y&&w._resolve(),w._completion.then(function(){return P})}).catch(function(P){return w._reject(P),me(P)})})}.bind(null,this,c,f,s,o);return s?s._promise(c,v,"lock"):B.trans?xn(B.transless,function(){return u._whenReady(v)}):this._whenReady(v)},ve.prototype.table=function(n){if(!U(this._allTables,n))throw new q.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},ve);function ve(n,r){var o=this;this._middlewares={},this.verno=0;var u=ve.dependencies;this._options=r=a({addons:ve.addons,autoOpen:!0,indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange},u=r.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,c,f,h,v,g={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ne,dbReadyPromise:null,cancelOpen:ne,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};g.dbReadyPromise=new N(function(p){g.dbReadyResolve=p}),g.openCanceller=new N(function(p,x){g.cancelOpen=x}),this._state=g,this.name=n,this.on=tt(this,"populate","blocked","versionchange","close",{ready:[or,ne]}),this.once=function(p,x){var y=function(){for(var b=[],k=0;k<arguments.length;k++)b[k]=arguments[k];o.on(p).unsubscribe(y),x.apply(o,b)};return o.on(p,y)},this.on.ready.subscribe=_e(this.on.ready.subscribe,function(p){return function(x,y){ve.vip(function(){var b,k=o._state;k.openComplete?(k.dbOpenError||N.resolve().then(x),y&&p(x)):k.onReadyBeingFired?(k.onReadyBeingFired.push(x),y&&p(x)):(p(x),b=o,y||p(function w(){b.on.ready.unsubscribe(x),b.on.ready.unsubscribe(w)}))})}}),this.Collection=(s=this,rt(Yi.prototype,function(z,w){this.db=s;var y=ho,b=null;if(w)try{y=w()}catch(O){b=O}var k=z._ctx,w=k.table,z=w.hook.reading.fire;this._ctx={table:w,index:k.index,isPrimKey:!k.index||w.schema.primKey.keyPath&&k.index===w.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:b,or:k.or,valueMapper:z!==Xn?z:null}})),this.Table=(c=this,rt(yo.prototype,function(p,x,y){this.db=c,this._tx=y,this.name=p,this.schema=x,this.hook=c._allTables[p]?c._allTables[p].hook:tt(null,{creating:[Ki,ne],reading:[Ni,Xn],updating:[Fi,ne],deleting:[Bi,ne]})})),this.Transaction=(f=this,rt(Xi.prototype,function(p,x,y,b,k){var w=this;p!=="readonly"&&x.forEach(function(z){z=(z=y[z])===null||z===void 0?void 0:z.yProps,z&&(x=x.concat(z.map(function(O){return O.updatesTable})))}),this.db=f,this.mode=p,this.storeNames=x,this.schema=y,this.chromeTransactionDurability=b,this.idbtrans=null,this.on=tt(this,"complete","error","abort"),this.parent=k||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new N(function(z,O){w._resolve=z,w._reject=O}),this._completion.then(function(){w.active=!1,w.on.complete.fire()},function(z){var O=w.active;return w.active=!1,w.on.error.fire(z),w.parent?w.parent._reject(z):O&&w.idbtrans&&w.idbtrans.abort(),me(z)})})),this.Version=(h=this,rt(ou.prototype,function(p){this.db=h,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,rt(xo.prototype,function(p,x,y){if(this.db=v,this._ctx={table:p,index:x===":id"?null:x,or:y},this._cmp=this._ascending=X,this._descending=function(b,k){return X(k,b)},this._max=function(b,k){return 0<X(b,k)?b:k},this._min=function(b,k){return X(b,k)<0?b:k},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=at(r.IDBKeyRange),this._createTransaction=function(p,x,y,b){return new o.Transaction(p,x,y,o._options.chromeTransactionDurability,b)},this._fireOnBlocked=function(p){o.on("blocked").fire(p),jn.filter(function(x){return x.name===o.name&&x!==o&&!x._state.vcFired}).map(function(x){return x.on("versionchange").fire(p)})},this.use(su),this.use(hu),this.use(cu),this.use(uu),this.use(au);var _=new Proxy(this,{get:function(p,x,y){if(x==="_vip")return!0;if(x==="table")return function(k){return Kt(o.table(k),_)};var b=Reflect.get(p,x,y);return b instanceof yo?Kt(b,_):x==="tables"?b.map(function(k){return Kt(k,_)}):x==="_createTransaction"?function(){return Kt(b.apply(this,arguments),_)}:b}});this.vip=_,u.forEach(function(p){return p(o)})}var Bt,je=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",du=(Dr.prototype.subscribe=function(n,r,o){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:r,complete:o})},Dr.prototype[je]=function(){return this},Dr);function Dr(n){this._subscribe=n}try{Bt={indexedDB:m.indexedDB||m.mozIndexedDB||m.webkitIndexedDB||m.msIndexedDB,IDBKeyRange:m.IDBKeyRange||m.webkitIDBKeyRange}}catch{Bt={indexedDB:null,IDBKeyRange:null}}function No(n){var r,o=!1,u=new du(function(s){var c=nn(n),f,h=!1,v={},g={},_={get closed(){return h},unsubscribe:function(){h||(h=!0,f&&f.abort(),p&&sn.storagemutated.unsubscribe(y))}};s.start&&s.start(_);var p=!1,x=function(){return hr(b)},y=function(k){Dt(v,k),Sr(g,v)&&x()},b=function(){var k,w,z;!h&&Bt.indexedDB&&(v={},k={},f&&f.abort(),f=new AbortController,z=function(O){var P=Zn();try{c&&$n();var S=rn(n,O);return S=c?S.finally(on):S}finally{P&&Tn()}}(w={subscr:k,signal:f.signal,requery:x,querier:n,trans:null}),Promise.resolve(z).then(function(O){o=!0,r=O,h||w.signal.aborted||(v={},function(P){for(var S in P)if(U(P,S))return;return 1}(g=k)||p||(sn(ut,y),p=!0),hr(function(){return!h&&s.next&&s.next(O)}))},function(O){o=!1,["DatabaseClosedError","AbortError"].includes(O?.name)||h||hr(function(){h||s.error&&s.error(O)})}))};return setTimeout(x,0),_});return u.hasValue=function(){return o},u.getValue=function(){return r},u}var Pn=He;function Rr(n){var r=cn;try{cn=!0,sn.storagemutated.fire(n),Zr(n,!0)}finally{cn=r}}W(Pn,a(a({},mt),{delete:function(n){return new Pn(n,{addons:[]}).delete()},exists:function(n){return new Pn(n,{addons:[]}).open().then(function(r){return r.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return r=Pn.dependencies,o=r.indexedDB,r=r.IDBKeyRange,(Er(o)?Promise.resolve(o.databases()).then(function(u){return u.map(function(s){return s.name}).filter(function(s){return s!==zt})}):zr(o,r).toCollection().primaryKeys()).then(n)}catch{return me(new q.MissingAPI)}var r,o},defineClass:function(){return function(n){A(this,n)}},ignoreTransaction:function(n){return B.trans?xn(B.transless,n):n()},vip:Or,async:function(n){return function(){try{var r=Tr(n.apply(this,arguments));return r&&typeof r.then=="function"?r:N.resolve(r)}catch(o){return me(o)}}},spawn:function(n,r,o){try{var u=Tr(n.apply(o,r||[]));return u&&typeof u.then=="function"?u:N.resolve(u)}catch(s){return me(s)}},currentTransaction:{get:function(){return B.trans||null}},waitFor:function(n,r){return r=N.resolve(typeof n=="function"?Pn.ignoreTransaction(n):n).timeout(r||6e4),B.trans?B.trans.waitFor(r):r},Promise:N,debug:{get:function(){return Fe},set:function(n){io(n)}},derive:ae,extend:A,props:W,override:_e,Events:tt,on:sn,liveQuery:No,extendObservabilitySet:Dt,getByKeyPath:be,setByKeyPath:we,delByKeyPath:function(n,r){typeof r=="string"?we(n,r,void 0):"length"in r&&[].map.call(r,function(o){we(n,o,void 0)})},shallowClone:In,deepClone:$e,getObjectDiff:$r,cmp:X,asap:Ze,minKey:-1/0,addons:[],connections:jn,errnames:Ne,dependencies:Bt,cache:On,semVer:"4.2.0",version:"4.2.0".split(".").map(function(n){return parseInt(n)}).reduce(function(n,r,o){return n+r/Math.pow(10,2*o)})})),Pn.maxKey=at(Pn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(sn(ut,function(n){cn||(n=new CustomEvent(yr,{detail:n}),cn=!0,dispatchEvent(n),cn=!1)}),addEventListener(yr,function(n){n=n.detail,cn||Rr(n)}));var Nn,cn=!1,Ko=function(){};return typeof BroadcastChannel<"u"&&((Ko=function(){(Nn=new BroadcastChannel(yr)).onmessage=function(n){return n.data&&Rr(n.data)}})(),typeof Nn.unref=="function"&&Nn.unref(),sn(ut,function(n){cn||Nn.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!He.disableBfCache&&n.persisted){Fe&&console.debug("Dexie: handling persisted pagehide"),Nn?.close();for(var r=0,o=jn;r<o.length;r++)o[r].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!He.disableBfCache&&n.persisted&&(Fe&&console.debug("Dexie: handling persisted pageshow"),Ko(),Rr({all:new ke(-1/0,[[]])}))})),N.rejectionMapper=function(n,r){return!n||n instanceof Be||n instanceof TypeError||n instanceof SyntaxError||!n.name||!oo[n.name]?n:(r=new oo[n.name](r||n.message,n),"stack"in n&&Y(r,"stack",{get:function(){return this.inner.stack}}),r)},io(Fe),a(He,Object.freeze({__proto__:null,Dexie:He,liveQuery:No,Entity:po,cmp:X,PropModification:ot,replacePrefix:function(n,r){return new ot({replacePrefix:[n,r]})},add:function(n){return new ot({add:n})},remove:function(n){return new ot({remove:n})},default:He,RangeSet:ke,mergeRanges:lt,rangesOverlap:So}),{default:He}),He})})(fi);var Iu=fi.exports;const qr=ku(Iu),Mo=Symbol.for("Dexie"),Mr=globalThis[Mo]||(globalThis[Mo]=qr);if(qr.semVer!==Mr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${qr.semVer} and ${Mr.semVer}`);class Au extends Mr{constructor(){super("draconia_v1");qt(this,"saves");qt(this,"meta");qt(this,"logs");this.version(1).stores({saves:"++id, profileId, version, createdAt",meta:"key",logs:"++id, timestamp, level, source"})}}const ht=new Au;function I(e,t,i){function a(E,A){var C;Object.defineProperty(E,"_zod",{value:E._zod??{},enumerable:!1}),(C=E._zod).traits??(C.traits=new Set),E._zod.traits.add(e),t(E,A);for(const M in d.prototype)M in E||Object.defineProperty(E,M,{value:d.prototype[M].bind(E)});E._zod.constr=d,E._zod.def=A}const l=i?.Parent??Object;class m extends l{}Object.defineProperty(m,"name",{value:e});function d(E){var A;const C=i?.Parent?new m:this;a(C,E),(A=C._zod).deferred??(A.deferred=[]);for(const M of C._zod.deferred)M();return C}return Object.defineProperty(d,"init",{value:a}),Object.defineProperty(d,Symbol.hasInstance,{value:E=>i?.Parent&&E instanceof i.Parent?!0:E?._zod?.traits?.has(e)}),Object.defineProperty(d,"name",{value:e}),d}class Un extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class hi extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Ur={};function fn(e){return e&&Object.assign(Ur,e),Ur}function Zu(e){const t=Object.values(e).filter(a=>typeof a=="number");return Object.entries(e).filter(([a,l])=>t.indexOf(+a)===-1).map(([a,l])=>l)}function Lr(e,t){return typeof t=="bigint"?t.toString():t}function Jr(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Xr(e){return e==null}function Hr(e){const t=e.startsWith("^")?1:0,i=e.endsWith("$")?e.length-1:e.length;return e.slice(t,i)}function Tu(e,t){const i=(e.toString().split(".")[1]||"").length,a=t.toString();let l=(a.split(".")[1]||"").length;if(l===0&&/\d?e-\d?/.test(a)){const A=a.match(/\d?e-(\d?)/);A?.[1]&&(l=Number.parseInt(A[1]))}const m=i>l?i:l,d=Number.parseInt(e.toFixed(m).replace(".","")),E=Number.parseInt(t.toFixed(m).replace(".",""));return d%E/10**m}const Uo=Symbol("evaluating");function re(e,t,i){let a;Object.defineProperty(e,t,{get(){if(a!==Uo)return a===void 0&&(a=Uo,a=i()),a},set(l){Object.defineProperty(e,t,{value:l})},configurable:!0})}function $u(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function dn(e,t,i){Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!0,configurable:!0})}function Wn(...e){const t={};for(const i of e){const a=Object.getOwnPropertyDescriptors(i);Object.assign(t,a)}return Object.defineProperties({},t)}function Lo(e){return JSON.stringify(e)}const di="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function Xt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const ju=Jr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Ln(e){if(Xt(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const i=t.prototype;return!(Xt(i)===!1||Object.prototype.hasOwnProperty.call(i,"isPrototypeOf")===!1)}function pi(e){return Ln(e)?{...e}:e}const Cu=new Set(["string","number","symbol"]);function Vn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function pn(e,t,i){const a=new e._zod.constr(t??e._zod.def);return(!t||i?.parent)&&(a._zod.parent=e),a}function F(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Du(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Ru={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Nu(e,t){const i=e._zod.def,a=Wn(e._zod.def,{get shape(){const l={};for(const m in t){if(!(m in i.shape))throw new Error(`Unrecognized key: "${m}"`);t[m]&&(l[m]=i.shape[m])}return dn(this,"shape",l),l},checks:[]});return pn(e,a)}function Ku(e,t){const i=e._zod.def,a=Wn(e._zod.def,{get shape(){const l={...e._zod.def.shape};for(const m in t){if(!(m in i.shape))throw new Error(`Unrecognized key: "${m}"`);t[m]&&delete l[m]}return dn(this,"shape",l),l},checks:[]});return pn(e,a)}function Bu(e,t){if(!Ln(t))throw new Error("Invalid input to extend: expected a plain object");const i=e._zod.def.checks;if(i&&i.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const l=Wn(e._zod.def,{get shape(){const m={...e._zod.def.shape,...t};return dn(this,"shape",m),m},checks:[]});return pn(e,l)}function Fu(e,t){if(!Ln(t))throw new Error("Invalid input to safeExtend: expected a plain object");const i={...e._zod.def,get shape(){const a={...e._zod.def.shape,...t};return dn(this,"shape",a),a},checks:e._zod.def.checks};return pn(e,i)}function qu(e,t){const i=Wn(e._zod.def,{get shape(){const a={...e._zod.def.shape,...t._zod.def.shape};return dn(this,"shape",a),a},get catchall(){return t._zod.def.catchall},checks:[]});return pn(e,i)}function Mu(e,t,i){const a=Wn(t._zod.def,{get shape(){const l=t._zod.def.shape,m={...l};if(i)for(const d in i){if(!(d in l))throw new Error(`Unrecognized key: "${d}"`);i[d]&&(m[d]=e?new e({type:"optional",innerType:l[d]}):l[d])}else for(const d in l)m[d]=e?new e({type:"optional",innerType:l[d]}):l[d];return dn(this,"shape",m),m},checks:[]});return pn(t,a)}function Uu(e,t,i){const a=Wn(t._zod.def,{get shape(){const l=t._zod.def.shape,m={...l};if(i)for(const d in i){if(!(d in m))throw new Error(`Unrecognized key: "${d}"`);i[d]&&(m[d]=new e({type:"nonoptional",innerType:l[d]}))}else for(const d in l)m[d]=new e({type:"nonoptional",innerType:l[d]});return dn(this,"shape",m),m},checks:[]});return pn(t,a)}function qn(e,t=0){if(e.aborted===!0)return!0;for(let i=t;i<e.issues.length;i++)if(e.issues[i]?.continue!==!0)return!0;return!1}function Mn(e,t){return t.map(i=>{var a;return(a=i).path??(a.path=[]),i.path.unshift(e),i})}function Lt(e){return typeof e=="string"?e:e?.message}function hn(e,t,i){const a={...e,path:e.path??[]};if(!e.message){const l=Lt(e.inst?._zod.def?.error?.(e))??Lt(t?.error?.(e))??Lt(i.customError?.(e))??Lt(i.localeError?.(e))??"Invalid input";a.message=l}return delete a.inst,delete a.continue,t?.reportInput||delete a.input,a}function Qr(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function dt(...e){const[t,i,a]=e;return typeof t=="string"?{message:t,code:"custom",input:i,inst:a}:{...t}}const mi=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Lr,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},vi=I("$ZodError",mi),yi=I("$ZodError",mi,{Parent:Error});function Lu(e,t=i=>i.message){const i={},a=[];for(const l of e.issues)l.path.length>0?(i[l.path[0]]=i[l.path[0]]||[],i[l.path[0]].push(t(l))):a.push(t(l));return{formErrors:a,fieldErrors:i}}function Vu(e,t){const i=t||function(m){return m.message},a={_errors:[]},l=m=>{for(const d of m.issues)if(d.code==="invalid_union"&&d.errors.length)d.errors.map(E=>l({issues:E}));else if(d.code==="invalid_key")l({issues:d.issues});else if(d.code==="invalid_element")l({issues:d.issues});else if(d.path.length===0)a._errors.push(i(d));else{let E=a,A=0;for(;A<d.path.length;){const C=d.path[A];A===d.path.length-1?(E[C]=E[C]||{_errors:[]},E[C]._errors.push(i(d))):E[C]=E[C]||{_errors:[]},E=E[C],A++}}};return l(e),a}const eo=e=>(t,i,a,l)=>{const m=a?Object.assign(a,{async:!1}):{async:!1},d=t._zod.run({value:i,issues:[]},m);if(d instanceof Promise)throw new Un;if(d.issues.length){const E=new(l?.Err??e)(d.issues.map(A=>hn(A,m,fn())));throw di(E,l?.callee),E}return d.value},no=e=>async(t,i,a,l)=>{const m=a?Object.assign(a,{async:!0}):{async:!0};let d=t._zod.run({value:i,issues:[]},m);if(d instanceof Promise&&(d=await d),d.issues.length){const E=new(l?.Err??e)(d.issues.map(A=>hn(A,m,fn())));throw di(E,l?.callee),E}return d.value},er=e=>(t,i,a)=>{const l=a?{...a,async:!1}:{async:!1},m=t._zod.run({value:i,issues:[]},l);if(m instanceof Promise)throw new Un;return m.issues.length?{success:!1,error:new(e??vi)(m.issues.map(d=>hn(d,l,fn())))}:{success:!0,data:m.value}},Wu=er(yi),nr=e=>async(t,i,a)=>{const l=a?Object.assign(a,{async:!0}):{async:!0};let m=t._zod.run({value:i,issues:[]},l);return m instanceof Promise&&(m=await m),m.issues.length?{success:!1,error:new e(m.issues.map(d=>hn(d,l,fn())))}:{success:!0,data:m.value}},Yu=nr(yi),Gu=e=>(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return eo(e)(t,i,l)},Ju=e=>(t,i,a)=>eo(e)(t,i,a),Xu=e=>async(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return no(e)(t,i,l)},Hu=e=>async(t,i,a)=>no(e)(t,i,a),Qu=e=>(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return er(e)(t,i,l)},ea=e=>(t,i,a)=>er(e)(t,i,a),na=e=>async(t,i,a)=>{const l=a?Object.assign(a,{direction:"backward"}):{direction:"backward"};return nr(e)(t,i,l)},ta=e=>async(t,i,a)=>nr(e)(t,i,a),ra=/^[cC][^\s-]{8,}$/,oa=/^[0-9a-z]+$/,ia=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,ua=/^[0-9a-vA-V]{20}$/,aa=/^[A-Za-z0-9]{27}$/,sa=/^[a-zA-Z0-9_-]{21}$/,ca=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,la=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Vo=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,fa=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,ha="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function da(){return new RegExp(ha,"u")}const pa=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ma=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,va=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ya=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ga=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,gi=/^[A-Za-z0-9_-]*$/,ba=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,_a=/^\+(?:[0-9]){6,14}[0-9]$/,bi="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",wa=new RegExp(`^${bi}$`);function _i(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function ka(e){return new RegExp(`^${_i(e)}$`)}function xa(e){const t=_i({precision:e.precision}),i=["Z"];e.local&&i.push(""),e.offset&&i.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const a=`${t}(?:${i.join("|")})`;return new RegExp(`^${bi}T(?:${a})$`)}const za=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Ea=/^\d+$/,Oa=/^-?\d+(?:\.\d+)?/i,Pa=/true|false/i,Sa=/^[^A-Z]*$/,Ia=/^[^a-z]*$/,Se=I("$ZodCheck",(e,t)=>{var i;e._zod??(e._zod={}),e._zod.def=t,(i=e._zod).onattach??(i.onattach=[])}),wi={number:"number",bigint:"bigint",object:"date"},ki=I("$ZodCheckLessThan",(e,t)=>{Se.init(e,t);const i=wi[typeof t.value];e._zod.onattach.push(a=>{const l=a._zod.bag,m=(t.inclusive?l.maximum:l.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<m&&(t.inclusive?l.maximum=t.value:l.exclusiveMaximum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value<=t.value:a.value<t.value)||a.issues.push({origin:i,code:"too_big",maximum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),xi=I("$ZodCheckGreaterThan",(e,t)=>{Se.init(e,t);const i=wi[typeof t.value];e._zod.onattach.push(a=>{const l=a._zod.bag,m=(t.inclusive?l.minimum:l.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>m&&(t.inclusive?l.minimum=t.value:l.exclusiveMinimum=t.value)}),e._zod.check=a=>{(t.inclusive?a.value>=t.value:a.value>t.value)||a.issues.push({origin:i,code:"too_small",minimum:t.value,input:a.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Aa=I("$ZodCheckMultipleOf",(e,t)=>{Se.init(e,t),e._zod.onattach.push(i=>{var a;(a=i._zod.bag).multipleOf??(a.multipleOf=t.value)}),e._zod.check=i=>{if(typeof i.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof i.value=="bigint"?i.value%t.value===BigInt(0):Tu(i.value,t.value)===0)||i.issues.push({origin:typeof i.value,code:"not_multiple_of",divisor:t.value,input:i.value,inst:e,continue:!t.abort})}}),Za=I("$ZodCheckNumberFormat",(e,t)=>{Se.init(e,t),t.format=t.format||"float64";const i=t.format?.includes("int"),a=i?"int":"number",[l,m]=Ru[t.format];e._zod.onattach.push(d=>{const E=d._zod.bag;E.format=t.format,E.minimum=l,E.maximum=m,i&&(E.pattern=Ea)}),e._zod.check=d=>{const E=d.value;if(i){if(!Number.isInteger(E)){d.issues.push({expected:a,format:t.format,code:"invalid_type",continue:!1,input:E,inst:e});return}if(!Number.isSafeInteger(E)){E>0?d.issues.push({input:E,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort}):d.issues.push({input:E,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:a,continue:!t.abort});return}}E<l&&d.issues.push({origin:"number",input:E,code:"too_small",minimum:l,inclusive:!0,inst:e,continue:!t.abort}),E>m&&d.issues.push({origin:"number",input:E,code:"too_big",maximum:m,inst:e})}}),Ta=I("$ZodCheckMaxLength",(e,t)=>{var i;Se.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Xr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<l&&(a._zod.bag.maximum=t.maximum)}),e._zod.check=a=>{const l=a.value;if(l.length<=t.maximum)return;const d=Qr(l);a.issues.push({origin:d,code:"too_big",maximum:t.maximum,inclusive:!0,input:l,inst:e,continue:!t.abort})}}),$a=I("$ZodCheckMinLength",(e,t)=>{var i;Se.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Xr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>l&&(a._zod.bag.minimum=t.minimum)}),e._zod.check=a=>{const l=a.value;if(l.length>=t.minimum)return;const d=Qr(l);a.issues.push({origin:d,code:"too_small",minimum:t.minimum,inclusive:!0,input:l,inst:e,continue:!t.abort})}}),ja=I("$ZodCheckLengthEquals",(e,t)=>{var i;Se.init(e,t),(i=e._zod.def).when??(i.when=a=>{const l=a.value;return!Xr(l)&&l.length!==void 0}),e._zod.onattach.push(a=>{const l=a._zod.bag;l.minimum=t.length,l.maximum=t.length,l.length=t.length}),e._zod.check=a=>{const l=a.value,m=l.length;if(m===t.length)return;const d=Qr(l),E=m>t.length;a.issues.push({origin:d,...E?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:a.value,inst:e,continue:!t.abort})}}),tr=I("$ZodCheckStringFormat",(e,t)=>{var i,a;Se.init(e,t),e._zod.onattach.push(l=>{const m=l._zod.bag;m.format=t.format,t.pattern&&(m.patterns??(m.patterns=new Set),m.patterns.add(t.pattern))}),t.pattern?(i=e._zod).check??(i.check=l=>{t.pattern.lastIndex=0,!t.pattern.test(l.value)&&l.issues.push({origin:"string",code:"invalid_format",format:t.format,input:l.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(a=e._zod).check??(a.check=()=>{})}),Ca=I("$ZodCheckRegex",(e,t)=>{tr.init(e,t),e._zod.check=i=>{t.pattern.lastIndex=0,!t.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:"regex",input:i.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Da=I("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Sa),tr.init(e,t)}),Ra=I("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=Ia),tr.init(e,t)}),Na=I("$ZodCheckIncludes",(e,t)=>{Se.init(e,t);const i=Vn(t.includes),a=new RegExp(typeof t.position=="number"?`^.{${t.position}}${i}`:i);t.pattern=a,e._zod.onattach.push(l=>{const m=l._zod.bag;m.patterns??(m.patterns=new Set),m.patterns.add(a)}),e._zod.check=l=>{l.value.includes(t.includes,t.position)||l.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:l.value,inst:e,continue:!t.abort})}}),Ka=I("$ZodCheckStartsWith",(e,t)=>{Se.init(e,t);const i=new RegExp(`^${Vn(t.prefix)}.*`);t.pattern??(t.pattern=i),e._zod.onattach.push(a=>{const l=a._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(i)}),e._zod.check=a=>{a.value.startsWith(t.prefix)||a.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:a.value,inst:e,continue:!t.abort})}}),Ba=I("$ZodCheckEndsWith",(e,t)=>{Se.init(e,t);const i=new RegExp(`.*${Vn(t.suffix)}$`);t.pattern??(t.pattern=i),e._zod.onattach.push(a=>{const l=a._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(i)}),e._zod.check=a=>{a.value.endsWith(t.suffix)||a.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:a.value,inst:e,continue:!t.abort})}}),Fa=I("$ZodCheckOverwrite",(e,t)=>{Se.init(e,t),e._zod.check=i=>{i.value=t.tx(i.value)}});class qa{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const a=t.split(`
`).filter(d=>d),l=Math.min(...a.map(d=>d.length-d.trimStart().length)),m=a.map(d=>d.slice(l)).map(d=>" ".repeat(this.indent*2)+d);for(const d of m)this.content.push(d)}compile(){const t=Function,i=this?.args,l=[...(this?.content??[""]).map(m=>`  ${m}`)];return new t(...i,l.join(`
`))}}const Ma={major:4,minor:1,patch:5},ce=I("$ZodType",(e,t)=>{var i;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Ma;const a=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&a.unshift(e);for(const l of a)for(const m of l._zod.onattach)m(e);if(a.length===0)(i=e._zod).deferred??(i.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const l=(d,E,A)=>{let C=qn(d),M;for(const U of E){if(U._zod.def.when){if(!U._zod.def.when(d))continue}else if(C)continue;const W=d.issues.length,J=U._zod.check(d);if(J instanceof Promise&&A?.async===!1)throw new Un;if(M||J instanceof Promise)M=(M??Promise.resolve()).then(async()=>{await J,d.issues.length!==W&&(C||(C=qn(d,W)))});else{if(d.issues.length===W)continue;C||(C=qn(d,W))}}return M?M.then(()=>d):d},m=(d,E,A)=>{if(qn(d))return d.aborted=!0,d;const C=l(E,a,A);if(C instanceof Promise){if(A.async===!1)throw new Un;return C.then(M=>e._zod.parse(M,A))}return e._zod.parse(C,A)};e._zod.run=(d,E)=>{if(E.skipChecks)return e._zod.parse(d,E);if(E.direction==="backward"){const C=e._zod.parse({value:d.value,issues:[]},{...E,skipChecks:!0});return C instanceof Promise?C.then(M=>m(M,d,E)):m(C,d,E)}const A=e._zod.parse(d,E);if(A instanceof Promise){if(E.async===!1)throw new Un;return A.then(C=>l(C,a,E))}return l(A,a,E)}}e["~standard"]={validate:l=>{try{const m=Wu(e,l);return m.success?{value:m.data}:{issues:m.error?.issues}}catch{return Yu(e,l).then(d=>d.success?{value:d.data}:{issues:d.error?.issues})}},vendor:"zod",version:1}}),to=I("$ZodString",(e,t)=>{ce.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??za(e._zod.bag),e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=String(i.value)}catch{}return typeof i.value=="string"||i.issues.push({expected:"string",code:"invalid_type",input:i.value,inst:e}),i}}),ue=I("$ZodStringFormat",(e,t)=>{tr.init(e,t),to.init(e,t)}),Ua=I("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=la),ue.init(e,t)}),La=I("$ZodUUID",(e,t)=>{if(t.version){const a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(a===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Vo(a))}else t.pattern??(t.pattern=Vo());ue.init(e,t)}),Va=I("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=fa),ue.init(e,t)}),Wa=I("$ZodURL",(e,t)=>{ue.init(e,t),e._zod.check=i=>{try{const a=i.value.trim(),l=new URL(a);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(l.hostname)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:ba.source,input:i.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(l.protocol.endsWith(":")?l.protocol.slice(0,-1):l.protocol)||i.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:i.value,inst:e,continue:!t.abort})),t.normalize?i.value=l.href:i.value=a;return}catch{i.issues.push({code:"invalid_format",format:"url",input:i.value,inst:e,continue:!t.abort})}}}),Ya=I("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=da()),ue.init(e,t)}),Ga=I("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=sa),ue.init(e,t)}),Ja=I("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=ra),ue.init(e,t)}),Xa=I("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=oa),ue.init(e,t)}),Ha=I("$ZodULID",(e,t)=>{t.pattern??(t.pattern=ia),ue.init(e,t)}),Qa=I("$ZodXID",(e,t)=>{t.pattern??(t.pattern=ua),ue.init(e,t)}),es=I("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=aa),ue.init(e,t)}),ns=I("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=xa(t)),ue.init(e,t)}),ts=I("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=wa),ue.init(e,t)}),rs=I("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=ka(t)),ue.init(e,t)}),os=I("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=ca),ue.init(e,t)}),is=I("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=pa),ue.init(e,t),e._zod.onattach.push(i=>{const a=i._zod.bag;a.format="ipv4"})}),us=I("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=ma),ue.init(e,t),e._zod.onattach.push(i=>{const a=i._zod.bag;a.format="ipv6"}),e._zod.check=i=>{try{new URL(`http://[${i.value}]`)}catch{i.issues.push({code:"invalid_format",format:"ipv6",input:i.value,inst:e,continue:!t.abort})}}}),as=I("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=va),ue.init(e,t)}),ss=I("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=ya),ue.init(e,t),e._zod.check=i=>{const[a,l]=i.value.split("/");try{if(!l)throw new Error;const m=Number(l);if(`${m}`!==l)throw new Error;if(m<0||m>128)throw new Error;new URL(`http://[${a}]`)}catch{i.issues.push({code:"invalid_format",format:"cidrv6",input:i.value,inst:e,continue:!t.abort})}}});function zi(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const cs=I("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=ga),ue.init(e,t),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64"}),e._zod.check=i=>{zi(i.value)||i.issues.push({code:"invalid_format",format:"base64",input:i.value,inst:e,continue:!t.abort})}});function ls(e){if(!gi.test(e))return!1;const t=e.replace(/[-_]/g,a=>a==="-"?"+":"/"),i=t.padEnd(Math.ceil(t.length/4)*4,"=");return zi(i)}const fs=I("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=gi),ue.init(e,t),e._zod.onattach.push(i=>{i._zod.bag.contentEncoding="base64url"}),e._zod.check=i=>{ls(i.value)||i.issues.push({code:"invalid_format",format:"base64url",input:i.value,inst:e,continue:!t.abort})}}),hs=I("$ZodE164",(e,t)=>{t.pattern??(t.pattern=_a),ue.init(e,t)});function ds(e,t=null){try{const i=e.split(".");if(i.length!==3)return!1;const[a]=i;if(!a)return!1;const l=JSON.parse(atob(a));return!("typ"in l&&l?.typ!=="JWT"||!l.alg||t&&(!("alg"in l)||l.alg!==t))}catch{return!1}}const ps=I("$ZodJWT",(e,t)=>{ue.init(e,t),e._zod.check=i=>{ds(i.value,t.alg)||i.issues.push({code:"invalid_format",format:"jwt",input:i.value,inst:e,continue:!t.abort})}}),Ei=I("$ZodNumber",(e,t)=>{ce.init(e,t),e._zod.pattern=e._zod.bag.pattern??Oa,e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=Number(i.value)}catch{}const l=i.value;if(typeof l=="number"&&!Number.isNaN(l)&&Number.isFinite(l))return i;const m=typeof l=="number"?Number.isNaN(l)?"NaN":Number.isFinite(l)?void 0:"Infinity":void 0;return i.issues.push({expected:"number",code:"invalid_type",input:l,inst:e,...m?{received:m}:{}}),i}}),ms=I("$ZodNumber",(e,t)=>{Za.init(e,t),Ei.init(e,t)}),vs=I("$ZodBoolean",(e,t)=>{ce.init(e,t),e._zod.pattern=Pa,e._zod.parse=(i,a)=>{if(t.coerce)try{i.value=!!i.value}catch{}const l=i.value;return typeof l=="boolean"||i.issues.push({expected:"boolean",code:"invalid_type",input:l,inst:e}),i}}),ys=I("$ZodUnknown",(e,t)=>{ce.init(e,t),e._zod.parse=i=>i}),gs=I("$ZodNever",(e,t)=>{ce.init(e,t),e._zod.parse=(i,a)=>(i.issues.push({expected:"never",code:"invalid_type",input:i.value,inst:e}),i)});function Wo(e,t,i){e.issues.length&&t.issues.push(...Mn(i,e.issues)),t.value[i]=e.value}const bs=I("$ZodArray",(e,t)=>{ce.init(e,t),e._zod.parse=(i,a)=>{const l=i.value;if(!Array.isArray(l))return i.issues.push({expected:"array",code:"invalid_type",input:l,inst:e}),i;i.value=Array(l.length);const m=[];for(let d=0;d<l.length;d++){const E=l[d],A=t.element._zod.run({value:E,issues:[]},a);A instanceof Promise?m.push(A.then(C=>Wo(C,i,d))):Wo(A,i,d)}return m.length?Promise.all(m).then(()=>i):i}});function Ht(e,t,i,a){e.issues.length&&t.issues.push(...Mn(i,e.issues)),e.value===void 0?i in a&&(t.value[i]=void 0):t.value[i]=e.value}function Oi(e){const t=Object.keys(e.shape);for(const a of t)if(!e.shape[a]._zod.traits.has("$ZodType"))throw new Error(`Invalid element at key "${a}": expected a Zod schema`);const i=Du(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(i)}}function Pi(e,t,i,a,l,m){const d=[],E=l.keySet,A=l.catchall._zod,C=A.def.type;for(const M of Object.keys(t)){if(E.has(M))continue;if(C==="never"){d.push(M);continue}const U=A.run({value:t[M],issues:[]},a);U instanceof Promise?e.push(U.then(W=>Ht(W,i,M,t))):Ht(U,i,M,t)}return d.length&&i.issues.push({code:"unrecognized_keys",keys:d,input:t,inst:m}),e.length?Promise.all(e).then(()=>i):i}const _s=I("$ZodObject",(e,t)=>{ce.init(e,t);const i=Jr(()=>Oi(t));re(e._zod,"propValues",()=>{const d=t.shape,E={};for(const A in d){const C=d[A]._zod;if(C.values){E[A]??(E[A]=new Set);for(const M of C.values)E[A].add(M)}}return E});const a=Xt,l=t.catchall;let m;e._zod.parse=(d,E)=>{m??(m=i.value);const A=d.value;if(!a(A))return d.issues.push({expected:"object",code:"invalid_type",input:A,inst:e}),d;d.value={};const C=[],M=m.shape;for(const U of m.keys){const J=M[U]._zod.run({value:A[U],issues:[]},E);J instanceof Promise?C.push(J.then(Y=>Ht(Y,d,U,A))):Ht(J,d,U,A)}return l?Pi(C,A,d,E,i.value,e):C.length?Promise.all(C).then(()=>d):d}}),ws=I("$ZodObjectJIT",(e,t)=>{_s.init(e,t);const i=e._zod.parse,a=Jr(()=>Oi(t)),l=W=>{const J=new qa(["shape","payload","ctx"]),Y=a.value,ae=_e=>{const pe=Lo(_e);return`shape[${pe}]._zod.run({ value: input[${pe}], issues: [] }, ctx)`};J.write("const input = payload.value;");const Ee=Object.create(null);let mn=0;for(const _e of Y.keys)Ee[_e]=`key_${mn++}`;J.write("const newResult = {}");for(const _e of Y.keys){const pe=Ee[_e],Ze=Lo(_e);J.write(`const ${pe} = ${ae(_e)};`),J.write(`
        if (${pe}.issues.length) {
          payload.issues = payload.issues.concat(${pe}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Ze}, ...iss.path] : [${Ze}]
          })));
        }
        
        if (${pe}.value === undefined) {
          if (${Ze} in input) {
            newResult[${Ze}] = undefined;
          }
        } else {
          newResult[${Ze}] = ${pe}.value;
        }
      `)}J.write("payload.value = newResult;"),J.write("return payload;");const Oe=J.compile();return(_e,pe)=>Oe(W,_e,pe)};let m;const d=Xt,E=!Ur.jitless,C=E&&ju.value,M=t.catchall;let U;e._zod.parse=(W,J)=>{U??(U=a.value);const Y=W.value;return d(Y)?E&&C&&J?.async===!1&&J.jitless!==!0?(m||(m=l(t.shape)),W=m(W,J),M?Pi([],Y,W,J,U,e):W):i(W,J):(W.issues.push({expected:"object",code:"invalid_type",input:Y,inst:e}),W)}});function Yo(e,t,i,a){for(const m of e)if(m.issues.length===0)return t.value=m.value,t;const l=e.filter(m=>!qn(m));return l.length===1?(t.value=l[0].value,l[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:i,errors:e.map(m=>m.issues.map(d=>hn(d,a,fn())))}),t)}const ks=I("$ZodUnion",(e,t)=>{ce.init(e,t),re(e._zod,"optin",()=>t.options.some(l=>l._zod.optin==="optional")?"optional":void 0),re(e._zod,"optout",()=>t.options.some(l=>l._zod.optout==="optional")?"optional":void 0),re(e._zod,"values",()=>{if(t.options.every(l=>l._zod.values))return new Set(t.options.flatMap(l=>Array.from(l._zod.values)))}),re(e._zod,"pattern",()=>{if(t.options.every(l=>l._zod.pattern)){const l=t.options.map(m=>m._zod.pattern);return new RegExp(`^(${l.map(m=>Hr(m.source)).join("|")})$`)}});const i=t.options.length===1,a=t.options[0]._zod.run;e._zod.parse=(l,m)=>{if(i)return a(l,m);let d=!1;const E=[];for(const A of t.options){const C=A._zod.run({value:l.value,issues:[]},m);if(C instanceof Promise)E.push(C),d=!0;else{if(C.issues.length===0)return C;E.push(C)}}return d?Promise.all(E).then(A=>Yo(A,l,e,m)):Yo(E,l,e,m)}}),xs=I("$ZodIntersection",(e,t)=>{ce.init(e,t),e._zod.parse=(i,a)=>{const l=i.value,m=t.left._zod.run({value:l,issues:[]},a),d=t.right._zod.run({value:l,issues:[]},a);return m instanceof Promise||d instanceof Promise?Promise.all([m,d]).then(([A,C])=>Go(i,A,C)):Go(i,m,d)}});function Vr(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Ln(e)&&Ln(t)){const i=Object.keys(t),a=Object.keys(e).filter(m=>i.indexOf(m)!==-1),l={...e,...t};for(const m of a){const d=Vr(e[m],t[m]);if(!d.valid)return{valid:!1,mergeErrorPath:[m,...d.mergeErrorPath]};l[m]=d.data}return{valid:!0,data:l}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const i=[];for(let a=0;a<e.length;a++){const l=e[a],m=t[a],d=Vr(l,m);if(!d.valid)return{valid:!1,mergeErrorPath:[a,...d.mergeErrorPath]};i.push(d.data)}return{valid:!0,data:i}}return{valid:!1,mergeErrorPath:[]}}function Go(e,t,i){if(t.issues.length&&e.issues.push(...t.issues),i.issues.length&&e.issues.push(...i.issues),qn(e))return e;const a=Vr(t.value,i.value);if(!a.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}const zs=I("$ZodRecord",(e,t)=>{ce.init(e,t),e._zod.parse=(i,a)=>{const l=i.value;if(!Ln(l))return i.issues.push({expected:"record",code:"invalid_type",input:l,inst:e}),i;const m=[];if(t.keyType._zod.values){const d=t.keyType._zod.values;i.value={};for(const A of d)if(typeof A=="string"||typeof A=="number"||typeof A=="symbol"){const C=t.valueType._zod.run({value:l[A],issues:[]},a);C instanceof Promise?m.push(C.then(M=>{M.issues.length&&i.issues.push(...Mn(A,M.issues)),i.value[A]=M.value})):(C.issues.length&&i.issues.push(...Mn(A,C.issues)),i.value[A]=C.value)}let E;for(const A in l)d.has(A)||(E=E??[],E.push(A));E&&E.length>0&&i.issues.push({code:"unrecognized_keys",input:l,inst:e,keys:E})}else{i.value={};for(const d of Reflect.ownKeys(l)){if(d==="__proto__")continue;const E=t.keyType._zod.run({value:d,issues:[]},a);if(E instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(E.issues.length){i.issues.push({code:"invalid_key",origin:"record",issues:E.issues.map(C=>hn(C,a,fn())),input:d,path:[d],inst:e}),i.value[E.value]=E.value;continue}const A=t.valueType._zod.run({value:l[d],issues:[]},a);A instanceof Promise?m.push(A.then(C=>{C.issues.length&&i.issues.push(...Mn(d,C.issues)),i.value[E.value]=C.value})):(A.issues.length&&i.issues.push(...Mn(d,A.issues)),i.value[E.value]=A.value)}}return m.length?Promise.all(m).then(()=>i):i}}),Es=I("$ZodEnum",(e,t)=>{ce.init(e,t);const i=Zu(t.entries),a=new Set(i);e._zod.values=a,e._zod.pattern=new RegExp(`^(${i.filter(l=>Cu.has(typeof l)).map(l=>typeof l=="string"?Vn(l):l.toString()).join("|")})$`),e._zod.parse=(l,m)=>{const d=l.value;return a.has(d)||l.issues.push({code:"invalid_value",values:i,input:d,inst:e}),l}}),Os=I("$ZodLiteral",(e,t)=>{if(ce.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");e._zod.values=new Set(t.values),e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?Vn(i):i?Vn(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,a)=>{const l=i.value;return e._zod.values.has(l)||i.issues.push({code:"invalid_value",values:t.values,input:l,inst:e}),i}}),Ps=I("$ZodTransform",(e,t)=>{ce.init(e,t),e._zod.parse=(i,a)=>{if(a.direction==="backward")throw new hi(e.constructor.name);const l=t.transform(i.value,i);if(a.async)return(l instanceof Promise?l:Promise.resolve(l)).then(d=>(i.value=d,i));if(l instanceof Promise)throw new Un;return i.value=l,i}});function Jo(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Ss=I("$ZodOptional",(e,t)=>{ce.init(e,t),e._zod.optin="optional",e._zod.optout="optional",re(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),re(e._zod,"pattern",()=>{const i=t.innerType._zod.pattern;return i?new RegExp(`^(${Hr(i.source)})?$`):void 0}),e._zod.parse=(i,a)=>{if(t.innerType._zod.optin==="optional"){const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Jo(m,i.value)):Jo(l,i.value)}return i.value===void 0?i:t.innerType._zod.run(i,a)}}),Is=I("$ZodNullable",(e,t)=>{ce.init(e,t),re(e._zod,"optin",()=>t.innerType._zod.optin),re(e._zod,"optout",()=>t.innerType._zod.optout),re(e._zod,"pattern",()=>{const i=t.innerType._zod.pattern;return i?new RegExp(`^(${Hr(i.source)}|null)$`):void 0}),re(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(i,a)=>i.value===null?i:t.innerType._zod.run(i,a)}),As=I("$ZodDefault",(e,t)=>{ce.init(e,t),e._zod.optin="optional",re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);if(i.value===void 0)return i.value=t.defaultValue,i;const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Xo(m,t)):Xo(l,t)}});function Xo(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const Zs=I("$ZodPrefault",(e,t)=>{ce.init(e,t),e._zod.optin="optional",re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>(a.direction==="backward"||i.value===void 0&&(i.value=t.defaultValue),t.innerType._zod.run(i,a))}),Ts=I("$ZodNonOptional",(e,t)=>{ce.init(e,t),re(e._zod,"values",()=>{const i=t.innerType._zod.values;return i?new Set([...i].filter(a=>a!==void 0)):void 0}),e._zod.parse=(i,a)=>{const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>Ho(m,e)):Ho(l,e)}});function Ho(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const $s=I("$ZodCatch",(e,t)=>{ce.init(e,t),re(e._zod,"optin",()=>t.innerType._zod.optin),re(e._zod,"optout",()=>t.innerType._zod.optout),re(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(m=>(i.value=m.value,m.issues.length&&(i.value=t.catchValue({...i,error:{issues:m.issues.map(d=>hn(d,a,fn()))},input:i.value}),i.issues=[]),i)):(i.value=l.value,l.issues.length&&(i.value=t.catchValue({...i,error:{issues:l.issues.map(m=>hn(m,a,fn()))},input:i.value}),i.issues=[]),i)}}),js=I("$ZodPipe",(e,t)=>{ce.init(e,t),re(e._zod,"values",()=>t.in._zod.values),re(e._zod,"optin",()=>t.in._zod.optin),re(e._zod,"optout",()=>t.out._zod.optout),re(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(i,a)=>{if(a.direction==="backward"){const m=t.out._zod.run(i,a);return m instanceof Promise?m.then(d=>Vt(d,t.in,a)):Vt(m,t.in,a)}const l=t.in._zod.run(i,a);return l instanceof Promise?l.then(m=>Vt(m,t.out,a)):Vt(l,t.out,a)}});function Vt(e,t,i){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},i)}const Cs=I("$ZodReadonly",(e,t)=>{ce.init(e,t),re(e._zod,"propValues",()=>t.innerType._zod.propValues),re(e._zod,"values",()=>t.innerType._zod.values),re(e._zod,"optin",()=>t.innerType._zod.optin),re(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(i,a)=>{if(a.direction==="backward")return t.innerType._zod.run(i,a);const l=t.innerType._zod.run(i,a);return l instanceof Promise?l.then(Qo):Qo(l)}});function Qo(e){return e.value=Object.freeze(e.value),e}const Ds=I("$ZodCustom",(e,t)=>{Se.init(e,t),ce.init(e,t),e._zod.parse=(i,a)=>i,e._zod.check=i=>{const a=i.value,l=t.fn(a);if(l instanceof Promise)return l.then(m=>ei(m,i,a,e));ei(l,i,a,e)}});function ei(e,t,i,a){if(!e){const l={code:"custom",input:i,inst:a,path:[...a._zod.def.path??[]],continue:!a._zod.def.abort};a._zod.def.params&&(l.params=a._zod.def.params),t.issues.push(dt(l))}}class Rs{constructor(){this._map=new Map,this._idmap=new Map}add(t,...i){const a=i[0];if(this._map.set(t,a),a&&typeof a=="object"&&"id"in a){if(this._idmap.has(a.id))throw new Error(`ID ${a.id} already exists in the registry`);this._idmap.set(a.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){const i=this._map.get(t);return i&&typeof i=="object"&&"id"in i&&this._idmap.delete(i.id),this._map.delete(t),this}get(t){const i=t._zod.parent;if(i){const a={...this.get(i)??{}};delete a.id;const l={...a,...this._map.get(t)};return Object.keys(l).length?l:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Ns(){return new Rs}const Wt=Ns();function Ks(e,t){return new e({type:"string",...F(t)})}function Bs(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...F(t)})}function ni(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...F(t)})}function Fs(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...F(t)})}function qs(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...F(t)})}function Ms(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...F(t)})}function Us(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...F(t)})}function Ls(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...F(t)})}function Vs(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...F(t)})}function Ws(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...F(t)})}function Ys(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...F(t)})}function Gs(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...F(t)})}function Js(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...F(t)})}function Xs(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...F(t)})}function Hs(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...F(t)})}function Qs(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...F(t)})}function ec(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...F(t)})}function nc(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...F(t)})}function tc(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...F(t)})}function rc(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...F(t)})}function oc(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...F(t)})}function ic(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...F(t)})}function uc(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...F(t)})}function ac(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...F(t)})}function sc(e,t){return new e({type:"string",format:"date",check:"string_format",...F(t)})}function cc(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...F(t)})}function lc(e,t){return new e({type:"string",format:"duration",check:"string_format",...F(t)})}function fc(e,t){return new e({type:"number",checks:[],...F(t)})}function hc(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...F(t)})}function dc(e,t){return new e({type:"boolean",...F(t)})}function pc(e){return new e({type:"unknown"})}function mc(e,t){return new e({type:"never",...F(t)})}function ti(e,t){return new ki({check:"less_than",...F(t),value:e,inclusive:!1})}function Br(e,t){return new ki({check:"less_than",...F(t),value:e,inclusive:!0})}function ri(e,t){return new xi({check:"greater_than",...F(t),value:e,inclusive:!1})}function Fr(e,t){return new xi({check:"greater_than",...F(t),value:e,inclusive:!0})}function oi(e,t){return new Aa({check:"multiple_of",...F(t),value:e})}function Si(e,t){return new Ta({check:"max_length",...F(t),maximum:e})}function Qt(e,t){return new $a({check:"min_length",...F(t),minimum:e})}function Ii(e,t){return new ja({check:"length_equals",...F(t),length:e})}function vc(e,t){return new Ca({check:"string_format",format:"regex",...F(t),pattern:e})}function yc(e){return new Da({check:"string_format",format:"lowercase",...F(e)})}function gc(e){return new Ra({check:"string_format",format:"uppercase",...F(e)})}function bc(e,t){return new Na({check:"string_format",format:"includes",...F(t),includes:e})}function _c(e,t){return new Ka({check:"string_format",format:"starts_with",...F(t),prefix:e})}function wc(e,t){return new Ba({check:"string_format",format:"ends_with",...F(t),suffix:e})}function pt(e){return new Fa({check:"overwrite",tx:e})}function kc(e){return pt(t=>t.normalize(e))}function xc(){return pt(e=>e.trim())}function zc(){return pt(e=>e.toLowerCase())}function Ec(){return pt(e=>e.toUpperCase())}function Oc(e,t,i){return new e({type:"array",element:t,...F(i)})}function Pc(e,t,i){return new e({type:"custom",check:"custom",fn:t,...F(i)})}function Sc(e){const t=Ic(i=>(i.addIssue=a=>{if(typeof a=="string")i.issues.push(dt(a,i.value,t._zod.def));else{const l=a;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=i.value),l.inst??(l.inst=t),l.continue??(l.continue=!t._zod.def.abort),i.issues.push(dt(l))}},e(i.value,i)));return t}function Ic(e,t){const i=new Se({check:"custom",...F(t)});return i._zod.check=e,i}const Ac=I("ZodISODateTime",(e,t)=>{ns.init(e,t),le.init(e,t)});function Zc(e){return ac(Ac,e)}const Tc=I("ZodISODate",(e,t)=>{ts.init(e,t),le.init(e,t)});function $c(e){return sc(Tc,e)}const jc=I("ZodISOTime",(e,t)=>{rs.init(e,t),le.init(e,t)});function Cc(e){return cc(jc,e)}const Dc=I("ZodISODuration",(e,t)=>{os.init(e,t),le.init(e,t)});function Rc(e){return lc(Dc,e)}const Nc=(e,t)=>{vi.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:i=>Vu(e,i)},flatten:{value:i=>Lu(e,i)},addIssue:{value:i=>{e.issues.push(i),e.message=JSON.stringify(e.issues,Lr,2)}},addIssues:{value:i=>{e.issues.push(...i),e.message=JSON.stringify(e.issues,Lr,2)}},isEmpty:{get(){return e.issues.length===0}}})},Re=I("ZodError",Nc,{Parent:Error}),Kc=eo(Re),Bc=no(Re),Fc=er(Re),qc=nr(Re),Mc=Gu(Re),Uc=Ju(Re),Lc=Xu(Re),Vc=Hu(Re),Wc=Qu(Re),Yc=ea(Re),Gc=na(Re),Jc=ta(Re),de=I("ZodType",(e,t)=>(ce.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...i)=>e.clone({...t,checks:[...t.checks??[],...i.map(a=>typeof a=="function"?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),e.clone=(i,a)=>pn(e,i,a),e.brand=()=>e,e.register=(i,a)=>(i.add(e,a),e),e.parse=(i,a)=>Kc(e,i,a,{callee:e.parse}),e.safeParse=(i,a)=>Fc(e,i,a),e.parseAsync=async(i,a)=>Bc(e,i,a,{callee:e.parseAsync}),e.safeParseAsync=async(i,a)=>qc(e,i,a),e.spa=e.safeParseAsync,e.encode=(i,a)=>Mc(e,i,a),e.decode=(i,a)=>Uc(e,i,a),e.encodeAsync=async(i,a)=>Lc(e,i,a),e.decodeAsync=async(i,a)=>Vc(e,i,a),e.safeEncode=(i,a)=>Wc(e,i,a),e.safeDecode=(i,a)=>Yc(e,i,a),e.safeEncodeAsync=async(i,a)=>Gc(e,i,a),e.safeDecodeAsync=async(i,a)=>Jc(e,i,a),e.refine=(i,a)=>e.check(Ul(i,a)),e.superRefine=i=>e.check(Ll(i)),e.overwrite=i=>e.check(pt(i)),e.optional=()=>ai(e),e.nullable=()=>si(e),e.nullish=()=>ai(si(e)),e.nonoptional=i=>Rl(e,i),e.array=()=>ro(e),e.or=i=>zl([e,i]),e.and=i=>Ol(e,i),e.transform=i=>ci(e,Zl(i)),e.default=i=>jl(e,i),e.prefault=i=>Dl(e,i),e.catch=i=>Kl(e,i),e.pipe=i=>ci(e,i),e.readonly=()=>ql(e),e.describe=i=>{const a=e.clone();return Wt.add(a,{description:i}),a},Object.defineProperty(e,"description",{get(){return Wt.get(e)?.description},configurable:!0}),e.meta=(...i)=>{if(i.length===0)return Wt.get(e);const a=e.clone();return Wt.add(a,i[0]),a},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Ai=I("_ZodString",(e,t)=>{to.init(e,t),de.init(e,t);const i=e._zod.bag;e.format=i.format??null,e.minLength=i.minimum??null,e.maxLength=i.maximum??null,e.regex=(...a)=>e.check(vc(...a)),e.includes=(...a)=>e.check(bc(...a)),e.startsWith=(...a)=>e.check(_c(...a)),e.endsWith=(...a)=>e.check(wc(...a)),e.min=(...a)=>e.check(Qt(...a)),e.max=(...a)=>e.check(Si(...a)),e.length=(...a)=>e.check(Ii(...a)),e.nonempty=(...a)=>e.check(Qt(1,...a)),e.lowercase=a=>e.check(yc(a)),e.uppercase=a=>e.check(gc(a)),e.trim=()=>e.check(xc()),e.normalize=(...a)=>e.check(kc(...a)),e.toLowerCase=()=>e.check(zc()),e.toUpperCase=()=>e.check(Ec())}),Xc=I("ZodString",(e,t)=>{to.init(e,t),Ai.init(e,t),e.email=i=>e.check(Bs(Hc,i)),e.url=i=>e.check(Ls(Qc,i)),e.jwt=i=>e.check(uc(pl,i)),e.emoji=i=>e.check(Vs(el,i)),e.guid=i=>e.check(ni(ii,i)),e.uuid=i=>e.check(Fs(Yt,i)),e.uuidv4=i=>e.check(qs(Yt,i)),e.uuidv6=i=>e.check(Ms(Yt,i)),e.uuidv7=i=>e.check(Us(Yt,i)),e.nanoid=i=>e.check(Ws(nl,i)),e.guid=i=>e.check(ni(ii,i)),e.cuid=i=>e.check(Ys(tl,i)),e.cuid2=i=>e.check(Gs(rl,i)),e.ulid=i=>e.check(Js(ol,i)),e.base64=i=>e.check(rc(fl,i)),e.base64url=i=>e.check(oc(hl,i)),e.xid=i=>e.check(Xs(il,i)),e.ksuid=i=>e.check(Hs(ul,i)),e.ipv4=i=>e.check(Qs(al,i)),e.ipv6=i=>e.check(ec(sl,i)),e.cidrv4=i=>e.check(nc(cl,i)),e.cidrv6=i=>e.check(tc(ll,i)),e.e164=i=>e.check(ic(dl,i)),e.datetime=i=>e.check(Zc(i)),e.date=i=>e.check($c(i)),e.time=i=>e.check(Cc(i)),e.duration=i=>e.check(Rc(i))});function Ve(e){return Ks(Xc,e)}const le=I("ZodStringFormat",(e,t)=>{ue.init(e,t),Ai.init(e,t)}),Hc=I("ZodEmail",(e,t)=>{Va.init(e,t),le.init(e,t)}),ii=I("ZodGUID",(e,t)=>{Ua.init(e,t),le.init(e,t)}),Yt=I("ZodUUID",(e,t)=>{La.init(e,t),le.init(e,t)}),Qc=I("ZodURL",(e,t)=>{Wa.init(e,t),le.init(e,t)}),el=I("ZodEmoji",(e,t)=>{Ya.init(e,t),le.init(e,t)}),nl=I("ZodNanoID",(e,t)=>{Ga.init(e,t),le.init(e,t)}),tl=I("ZodCUID",(e,t)=>{Ja.init(e,t),le.init(e,t)}),rl=I("ZodCUID2",(e,t)=>{Xa.init(e,t),le.init(e,t)}),ol=I("ZodULID",(e,t)=>{Ha.init(e,t),le.init(e,t)}),il=I("ZodXID",(e,t)=>{Qa.init(e,t),le.init(e,t)}),ul=I("ZodKSUID",(e,t)=>{es.init(e,t),le.init(e,t)}),al=I("ZodIPv4",(e,t)=>{is.init(e,t),le.init(e,t)}),sl=I("ZodIPv6",(e,t)=>{us.init(e,t),le.init(e,t)}),cl=I("ZodCIDRv4",(e,t)=>{as.init(e,t),le.init(e,t)}),ll=I("ZodCIDRv6",(e,t)=>{ss.init(e,t),le.init(e,t)}),fl=I("ZodBase64",(e,t)=>{cs.init(e,t),le.init(e,t)}),hl=I("ZodBase64URL",(e,t)=>{fs.init(e,t),le.init(e,t)}),dl=I("ZodE164",(e,t)=>{hs.init(e,t),le.init(e,t)}),pl=I("ZodJWT",(e,t)=>{ps.init(e,t),le.init(e,t)}),Zi=I("ZodNumber",(e,t)=>{Ei.init(e,t),de.init(e,t),e.gt=(a,l)=>e.check(ri(a,l)),e.gte=(a,l)=>e.check(Fr(a,l)),e.min=(a,l)=>e.check(Fr(a,l)),e.lt=(a,l)=>e.check(ti(a,l)),e.lte=(a,l)=>e.check(Br(a,l)),e.max=(a,l)=>e.check(Br(a,l)),e.int=a=>e.check(ui(a)),e.safe=a=>e.check(ui(a)),e.positive=a=>e.check(ri(0,a)),e.nonnegative=a=>e.check(Fr(0,a)),e.negative=a=>e.check(ti(0,a)),e.nonpositive=a=>e.check(Br(0,a)),e.multipleOf=(a,l)=>e.check(oi(a,l)),e.step=(a,l)=>e.check(oi(a,l)),e.finite=()=>e;const i=e._zod.bag;e.minValue=Math.max(i.minimum??Number.NEGATIVE_INFINITY,i.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(i.maximum??Number.POSITIVE_INFINITY,i.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(i.format??"").includes("int")||Number.isSafeInteger(i.multipleOf??.5),e.isFinite=!0,e.format=i.format??null});function se(e){return fc(Zi,e)}const ml=I("ZodNumberFormat",(e,t)=>{ms.init(e,t),Zi.init(e,t)});function ui(e){return hc(ml,e)}const vl=I("ZodBoolean",(e,t)=>{vs.init(e,t),de.init(e,t)});function yl(e){return dc(vl,e)}const gl=I("ZodUnknown",(e,t)=>{ys.init(e,t),de.init(e,t)});function Wr(){return pc(gl)}const bl=I("ZodNever",(e,t)=>{gs.init(e,t),de.init(e,t)});function _l(e){return mc(bl,e)}const wl=I("ZodArray",(e,t)=>{bs.init(e,t),de.init(e,t),e.element=t.element,e.min=(i,a)=>e.check(Qt(i,a)),e.nonempty=i=>e.check(Qt(1,i)),e.max=(i,a)=>e.check(Si(i,a)),e.length=(i,a)=>e.check(Ii(i,a)),e.unwrap=()=>e.element});function ro(e,t){return Oc(wl,e,t)}const kl=I("ZodObject",(e,t)=>{ws.init(e,t),de.init(e,t),re(e,"shape",()=>t.shape),e.keyof=()=>Gr(Object.keys(e._zod.def.shape)),e.catchall=i=>e.clone({...e._zod.def,catchall:i}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Wr()}),e.loose=()=>e.clone({...e._zod.def,catchall:Wr()}),e.strict=()=>e.clone({...e._zod.def,catchall:_l()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=i=>Bu(e,i),e.safeExtend=i=>Fu(e,i),e.merge=i=>qu(e,i),e.pick=i=>Nu(e,i),e.omit=i=>Ku(e,i),e.partial=(...i)=>Mu(Ti,e,i[0]),e.required=(...i)=>Uu($i,e,i[0])});function Ie(e,t){const i={type:"object",get shape(){return dn(this,"shape",e?$u(e):{}),this.shape},...F(t)};return new kl(i)}const xl=I("ZodUnion",(e,t)=>{ks.init(e,t),de.init(e,t),e.options=t.options});function zl(e,t){return new xl({type:"union",options:e,...F(t)})}const El=I("ZodIntersection",(e,t)=>{xs.init(e,t),de.init(e,t)});function Ol(e,t){return new El({type:"intersection",left:e,right:t})}const Pl=I("ZodRecord",(e,t)=>{zs.init(e,t),de.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function Sl(e,t,i){return new Pl({type:"record",keyType:e,valueType:t,...F(i)})}const Yr=I("ZodEnum",(e,t)=>{Es.init(e,t),de.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const i=new Set(Object.keys(t.entries));e.extract=(a,l)=>{const m={};for(const d of a)if(i.has(d))m[d]=t.entries[d];else throw new Error(`Key ${d} not found in enum`);return new Yr({...t,checks:[],...F(l),entries:m})},e.exclude=(a,l)=>{const m={...t.entries};for(const d of a)if(i.has(d))delete m[d];else throw new Error(`Key ${d} not found in enum`);return new Yr({...t,checks:[],...F(l),entries:m})}});function Gr(e,t){const i=Array.isArray(e)?Object.fromEntries(e.map(a=>[a,a])):e;return new Yr({type:"enum",entries:i,...F(t)})}const Il=I("ZodLiteral",(e,t)=>{Os.init(e,t),de.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function rr(e,t){return new Il({type:"literal",values:Array.isArray(e)?e:[e],...F(t)})}const Al=I("ZodTransform",(e,t)=>{Ps.init(e,t),de.init(e,t),e._zod.parse=(i,a)=>{if(a.direction==="backward")throw new hi(e.constructor.name);i.addIssue=m=>{if(typeof m=="string")i.issues.push(dt(m,i.value,t));else{const d=m;d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=i.value),d.inst??(d.inst=e),i.issues.push(dt(d))}};const l=t.transform(i.value,i);return l instanceof Promise?l.then(m=>(i.value=m,i)):(i.value=l,i)}});function Zl(e){return new Al({type:"transform",transform:e})}const Ti=I("ZodOptional",(e,t)=>{Ss.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType});function ai(e){return new Ti({type:"optional",innerType:e})}const Tl=I("ZodNullable",(e,t)=>{Is.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType});function si(e){return new Tl({type:"nullable",innerType:e})}const $l=I("ZodDefault",(e,t)=>{As.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function jl(e,t){return new $l({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():pi(t)}})}const Cl=I("ZodPrefault",(e,t)=>{Zs.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Dl(e,t){return new Cl({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():pi(t)}})}const $i=I("ZodNonOptional",(e,t)=>{Ts.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType});function Rl(e,t){return new $i({type:"nonoptional",innerType:e,...F(t)})}const Nl=I("ZodCatch",(e,t)=>{$s.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function Kl(e,t){return new Nl({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const Bl=I("ZodPipe",(e,t)=>{js.init(e,t),de.init(e,t),e.in=t.in,e.out=t.out});function ci(e,t){return new Bl({type:"pipe",in:e,out:t})}const Fl=I("ZodReadonly",(e,t)=>{Cs.init(e,t),de.init(e,t),e.unwrap=()=>e._zod.def.innerType});function ql(e){return new Fl({type:"readonly",innerType:e})}const Ml=I("ZodCustom",(e,t)=>{Ds.init(e,t),de.init(e,t)});function Ul(e,t={}){return Pc(Ml,e,t)}function Ll(e){return Sc(e)}const Vl=Ie({lastSimWallClock:se().int().min(0),bgCoveredMs:se().int().min(0)}),Wl=Ie({land:se().int().min(0),ward:se().int().min(0),distanceM:se().int().min(0)}),Yl=Ie({arcana:se().int().min(0),gold:se().int().min(0)}),Gl=Ie({firepower:se().int().min(0),scales:se().int().min(0),tier:se().int().min(0)}),Jl=Ie({playtimeS:se().int().min(0),deaths:se().int().min(0),totalDistanceM:se().int().min(0)}),Xl=Ie({highestWard:se().int().min(0),fastestBossS:se().int().min(0)}),ji=Ie({id:Ve().min(1),name:Ve().min(1).max(50),createdAt:se().int().min(0),lastActive:se().int().min(0),progress:Wl,currencies:Yl,enchants:Gl,stats:Jl,leaderboard:Xl,sim:Vl}),Ci=Ie({a11yReducedMotion:yl()}),Di=Ie({version:rr(1),profiles:ro(ji).min(1).max(6),settings:Ci});Ie({version:rr(1),profiles:ro(ji).min(0).max(6),settings:Ci});Ie({id:se().int().positive().optional(),profileId:Ve().min(1),version:rr(1),data:Di,createdAt:se().int().min(0),checksum:Ve().min(1)});Ie({key:Ve().min(1),value:Ve(),updatedAt:se().int().min(0)});Ie({id:se().int().positive().optional(),timestamp:se().int().min(0),level:Gr(["debug","info","warn","error"]),source:Gr(["ui","worker","render","net"]),message:Ve().min(1),data:Sl(Ve(),Wr()).optional(),profileId:Ve().min(1).optional()});Ie({fileVersion:rr(1),exportedAt:se().int().min(0),checksum:Ve().min(1),data:Di});function Hl(e=1e3,t=1e4){let i=[],a=null;const l=async()=>{const A=i;if(i=[],!A.length)return;const C=A.map(U=>({timestamp:U.t,level:U.lvl,source:U.src,message:U.msg,data:U.data,profileId:U.profileId}));await ht.logs.bulkAdd(C);const M=await ht.logs.count();if(M>t){const U=M-t,W=await ht.logs.orderBy("id").limit(U).toArray();await ht.logs.bulkDelete(W.map(J=>J.id))}};function m(){a||(a=setTimeout(async()=>{a=null;try{await l()}catch{}},e))}function d(A){i.push(A),m()}async function E(){i=[],a&&(clearTimeout(a),a=null),await ht.logs.clear()}return typeof window<"u"&&window.addEventListener("beforeunload",()=>{l()},{once:!0}),{enqueue:d,clear:E}}const li=Su({maxBytes:2*1024*1024,maxEntries:1e4,devConsole:!1,dexie:Hl(1e3,1e4)});function Ql(e){let t,i,a="Logging Perf Lab",l,m,d,E,A,C,M,U,W,J,Y,ae,Ee,mn,Oe,_e,pe,Ze,be,we="Export NDJSON",In,Te,An,vn,We,$e,Yn,Ye=e[2]?"yes":"no",en,Gn,Ke;return{c(){t=Ce("div"),i=Ce("h3"),i.textContent=a,l=Kn(),m=Ce("div"),d=Ce("label"),E=Ue("Rate (logs/sec) "),A=Ce("input"),C=Kn(),M=Ce("label"),U=Ue("Duration (s) "),W=Ce("input"),J=Kn(),Y=Ce("div"),ae=Ce("button"),Ee=Ue("Start"),mn=Kn(),Oe=Ce("button"),_e=Ue("Stop"),Ze=Kn(),be=Ce("button"),be.textContent=we,In=Kn(),Te=Ce("div"),An=Ue("Produced: "),vn=Ue(e[3]),We=Ue(" Dropped: "),$e=Ue(e[4]),Yn=Ue(" Running: "),en=Ue(Ye),this.h()},l(fe){t=De(fe,"DIV",{style:!0});var ee=ln(t);i=De(ee,"H3",{"data-svelte-h":!0}),Fo(i)!=="svelte-1uzt7vn"&&(i.textContent=a),l=Bn(ee),m=De(ee,"DIV",{style:!0});var nn=ln(m);d=De(nn,"LABEL",{});var Jn=ln(d);E=Le(Jn,"Rate (logs/sec) "),A=De(Jn,"INPUT",{type:!0,min:!0,max:!0}),Jn.forEach(Qe),C=Bn(nn),M=De(nn,"LABEL",{});var Be=ln(M);U=Le(Be,"Duration (s) "),W=De(Be,"INPUT",{type:!0,min:!0,max:!0}),Be.forEach(Qe),nn.forEach(Qe),J=Bn(ee),Y=De(ee,"DIV",{style:!0});var Ge=ln(Y);ae=De(Ge,"BUTTON",{});var yn=ln(ae);Ee=Le(yn,"Start"),yn.forEach(Qe),mn=Bn(Ge),Oe=De(Ge,"BUTTON",{});var Je=ln(Oe);_e=Le(Je,"Stop"),Je.forEach(Qe),Ze=Bn(Ge),be=De(Ge,"BUTTON",{"data-svelte-h":!0}),Fo(be)!=="svelte-ghayiv"&&(be.textContent=we),Ge.forEach(Qe),In=Bn(ee),Te=De(ee,"DIV",{});var Ne=ln(Te);An=Le(Ne,"Produced: "),vn=Le(Ne,e[3]),We=Le(Ne," Dropped: "),$e=Le(Ne,e[4]),Yn=Le(Ne," Running: "),en=Le(Ne,Ye),Ne.forEach(Qe),ee.forEach(Qe),this.h()},h(){Fn(A,"type","number"),Fn(A,"min","10"),Fn(A,"max","10000"),Fn(W,"type","number"),Fn(W,"min","1"),Fn(W,"max","30"),Mt(m,"margin-bottom","16px"),ae.disabled=e[2],Oe.disabled=pe=!e[2],Mt(Y,"margin-bottom","16px"),Mt(t,"padding","12px"),Mt(t,"font","14px system-ui")},m(fe,ee){wu(fe,t,ee),te(t,i),te(t,l),te(t,m),te(m,d),te(d,E),te(d,A),Ut(A,e[0]),te(m,C),te(m,M),te(M,U),te(M,W),Ut(W,e[1]),te(t,J),te(t,Y),te(Y,ae),te(ae,Ee),te(Y,mn),te(Y,Oe),te(Oe,_e),te(Y,Ze),te(Y,be),te(t,In),te(t,Te),te(Te,An),te(Te,vn),te(Te,We),te(Te,$e),te(Te,Yn),te(Te,en),Gn||(Ke=[ft(A,"input",e[8]),ft(W,"input",e[9]),ft(ae,"click",e[5]),ft(Oe,"click",e[6]),ft(be,"click",e[7])],Gn=!0)},p(fe,[ee]){ee&1&&Gt(A.value)!==fe[0]&&Ut(A,fe[0]),ee&2&&Gt(W.value)!==fe[1]&&Ut(W,fe[1]),ee&4&&(ae.disabled=fe[2]),ee&4&&pe!==(pe=!fe[2])&&(Oe.disabled=pe),ee&8&&Kr(vn,fe[3]),ee&16&&Kr($e,fe[4]),ee&4&&Ye!==(Ye=fe[2]?"yes":"no")&&Kr(en,Ye)},i:Bo,o:Bo,d(fe){fe&&Qe(t),Gn=!1,yu(Ke)}}}function ef(e,t,i){let a=100,l=10,m=!1,d=0,E=0,A;function C(){i(2,m=!0),i(3,d=0),i(4,E=0),performance.now();const Y=1e3/a;A=setInterval(()=>{for(let Ee=0;Ee<1;Ee++){i(3,d++,d);try{li.log({t:Date.now(),lvl:"info",src:"ui",msg:"perf",data:{seq:d}})}catch{i(4,E++,E)}}},Y),setTimeout(M,l*1e3)}function M(){m&&(clearInterval(A),i(2,m=!1))}gu(M);async function U(){const Y=await li.exportNDJSON(),ae=URL.createObjectURL(Y),Ee=document.createElement("a");Ee.href=ae,Ee.download="logs.ndjson",Ee.click(),URL.revokeObjectURL(ae)}function W(){a=Gt(this.value),i(0,a)}function J(){l=Gt(this.value),i(1,l)}return[a,l,m,d,E,C,M,U,W,J]}class uf extends bu{constructor(t){super(),_u(this,t,ef,Ql,vu,{})}}export{uf as component};
