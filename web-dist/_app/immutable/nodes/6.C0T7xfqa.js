import"../chunks/DsnmJJEf.js";import{i as ne}from"../chunks/CP9tZzGG.js";import{b as oe,h as F,a as le,w as T,Q as de,D as fe,H as ue,F as q,G as W,I as U,f as R,R as ve,T as ce,d as P,s as pe,e as ge,V as B,c as he,n as N,W as G,X as j,Y as me,Z as _e,J as ee,p as xe,_ as ye,$ as Ee,a0 as k,a1 as ae,a2 as Te,a3 as we,a4 as be,a5 as Ae,a6 as Se,g as Ce,o as De,A as Ie,i as Y,u as J,k as H,l as $e,r as D,q as I,m as O,t as $,a7 as Fe,v as Q}from"../chunks/DzhVMzrA.js";import{i as Le}from"../chunks/DSEsMLIz.js";import{s as Z,g as K,c as Re}from"../chunks/CxIXe2Zz.js";import{b as Me}from"../chunks/Dh9k4Bes.js";import{T as Ne}from"../chunks/B2cBvE-Z.js";import{A as ze}from"../chunks/Bdegg2L_.js";import{A as Ue}from"../chunks/D5Hk05_A.js";function ke(f,o,e){for(var d=f.items,u=[],v=o.length,a=0;a<v;a++)we(o[a].e,u,!0);var m=v>0&&u.length===0&&e!==null;if(m){var c=e.parentNode;be(c),c.append(e),d.clear(),A(f,o[0].prev,o[v-1].next)}Ae(u,()=>{for(var y=0;y<v;y++){var p=o[y];m||(d.delete(p.k),A(f,p.prev,p.next)),ae(p.e,!m)}})}function He(f,o,e,d,u,v=null){var a=f,m={flags:o,items:new Map,first:null};F&&le();var c=null,y=!1,p=new Map,w=de(()=>{var r=e();return me(r)?r:r==null?[]:j(r)}),t,_;function l(){Oe(_,t,m,p,a,u,o,d,e),v!==null&&(t.length===0?c?ee(c):c=P(()=>v(a)):c!==null&&xe(c,()=>{c=null}))}oe(()=>{_??=Se,t=T(w);var r=t.length;if(y&&r===0)return;y=r===0;let x=!1;if(F){var S=fe(a)===ue;S!==(r===0)&&(a=q(),W(a),U(!1),x=!0)}if(F){for(var i=null,n,s=0;s<r;s++){if(R.nodeType===ve&&R.data===ce){a=R,x=!0,U(!1);break}var g=t[s],h=d(g,s);n=V(R,m,i,null,g,h,s,u,o,e),m.items.set(h,n),i=n}r>0&&W(q())}if(F)r===0&&v&&(c=P(()=>v(a)));else if(pe()){var C=new Set,b=ge;for(s=0;s<r;s+=1){g=t[s],h=d(g,s);var E=m.items.get(h)??p.get(h);E?te(E,g,s):(n=V(null,m,null,null,g,h,s,u,o,e,!0),p.set(h,n)),C.add(h)}for(const[M,L]of m.items)C.has(M)||b.skipped_effects.add(L.e);b.add_callback(l)}else l();x&&U(!0),T(w)}),F&&(a=R)}function Oe(f,o,e,d,u,v,a,m,c){var y=o.length,p=e.items,w=e.first,t=w,_,l=null,r=[],x=[],S,i,n,s;for(s=0;s<y;s+=1){if(S=o[s],i=m(S,s),n=p.get(i),n===void 0){var g=d.get(i);if(g!==void 0){d.delete(i),p.set(i,g);var h=l?l.next:t;A(e,l,g),A(e,g,h),X(g,h,u),l=g}else{var C=t?t.e.nodes_start:u;l=V(C,e,l,l===null?e.first:l.next,S,i,s,v,a,c)}p.set(i,l),r=[],x=[],t=l.next;continue}if(te(n,S,s),(n.e.f&k)!==0&&ee(n.e),n!==t){if(_!==void 0&&_.has(n)){if(r.length<x.length){var b=x[0],E;l=b.prev;var M=r[0],L=r[r.length-1];for(E=0;E<r.length;E+=1)X(r[E],b,u);for(E=0;E<x.length;E+=1)_.delete(x[E]);A(e,M.prev,L.next),A(e,l,M),A(e,L,b),t=b,l=L,s-=1,r=[],x=[]}else _.delete(n),X(n,t,u),A(e,n.prev,n.next),A(e,n,l===null?e.first:l.next),A(e,l,n),l=n;continue}for(r=[],x=[];t!==null&&t.k!==i;)(t.e.f&k)===0&&(_??=new Set).add(t),x.push(t),t=t.next;if(t===null)continue;n=t}r.push(n),l=n,t=n.next}if(t!==null||_!==void 0){for(var z=_===void 0?[]:j(_);t!==null;)(t.e.f&k)===0&&z.push(t),t=t.next;var re=z.length;if(re>0){var ie=null;ke(e,z,ie)}}f.first=e.first&&e.first.e,f.last=l&&l.e;for(var se of d.values())ae(se.e);d.clear()}function te(f,o,e,d){B(f.v,o),B(f.i,e)}function V(f,o,e,d,u,v,a,m,c,y,p){var w=(c&ye)!==0,t=(c&Ee)===0,_=w?t?N(u,!1,!1):G(u):u,l=(c&_e)===0?a:G(a),r={i:l,v:_,k:v,a:null,e:null,prev:e,next:d};try{if(f===null){var x=document.createDocumentFragment();x.append(f=he())}return r.e=P(()=>m(f,_,l,y),F),r.e.prev=e&&e.e,r.e.next=d&&d.e,e===null?p||(o.first=r):(e.next=r,e.e.next=r.e),d!==null&&(d.prev=r,d.e.prev=r.e),r}finally{}}function X(f,o,e){for(var d=f.next?f.next.e.nodes_start:e,u=o?o.e.nodes_start:e,v=f.e.nodes_start;v!==null&&v!==d;){var a=Te(v);u.before(v),v=a}}function A(f,o,e){o===null?f.first=e:(o.next=e,o.e.next=e&&e.e),e!==null&&(e.prev=o,e.e.prev=o&&o.e)}var Xe=Y("<div> </div>"),Pe=Y('<div style="color:#666; font-style:italic;">Waiting for debug info...</div>'),Ve=Y(`<div style="position:fixed; inset:0; background: #0a0a0a;"><canvas style="width:100%; height:100%; display:block;"></canvas> <div style="position:absolute; left:8px; top:8px; background:rgba(0,0,0,.95); color:#fff; padding:16px; border-radius:8px; font:11px 'Courier New', monospace; max-width:500px; max-height:80vh; overflow-y:auto;"><h3 style="margin:0 0 12px 0; font-size:14px; color:#4CAF50;">üêõ Dragon Loading Debug</h3> <div style="margin-bottom:12px;"><strong>Status:</strong> <span> </span></div> <div style="border:1px solid #333; padding:8px; background:#111; border-radius:4px; max-height:400px; overflow-y:auto;"><div style="font-size:10px; color:#888; margin-bottom:6px;">Debug Log:</div> <!> <!></div> <div style="margin-top:12px; font-size:10px; color:#666;">This page tests dragon texture loading step-by-step to identify issues.</div></div></div>`);function je(f,o){Ce(o,!1);let e=N(),d,u=N([]),v=N(!1);function a(i){console.log(i),O(u,[...T(u),`${new Date().toLocaleTimeString()}: ${i}`])}async function m(){a("Starting texture loading test...");try{a("Test 1: Loading texture using Assets API...");const i=await Ue.load("/sprites/dragon_fly_128_sheet.svg");a(`Assets texture loaded: ${i?"SUCCESS":"FAILED"}`),i&&a(`Texture dimensions: ${i.width}x${i.height}`),a("Test 1b: Loading texture directly (legacy)...");const n=Ne.from("/sprites/dragon_fly_128_sheet.svg");a(`Direct texture created: ${n?"SUCCESS":"FAILED"}`),a("Test 2: Testing atlas frame loading...");const s=await K("idle");a(`Dragon frame loaded: ${s?"SUCCESS":"FAILED"}`),s&&a(`Frame details: ${s.width}x${s.height} at (${s.x}, ${s.y})`),a("Test 3: Loading all dragon frames...");const g=["idle","fly_1","fly_2","fly_3"];for(const b of g){const E=await K(b);a(`Frame ${b}: ${E?"SUCCESS":"FAILED"}`)}a("Test 4: Creating animated dragon sprite...");const{sprite:h,animator:C}=await Re();a("Animated sprite created: SUCCESS"),h.position.set(d.renderer.width/2,d.renderer.height/2),h.scale.set(1),d.stage.addChild(h),await C.start(),a("Animation started successfully!")}catch(i){a(`ERROR: ${i.message}`),console.error("Texture loading test failed:",i)}}De(async()=>{try{a("Initializing PIXI application..."),d=new ze({view:T(e),backgroundAlpha:0}),await d.init({resizeTo:T(e).parentElement??window}),a("PIXI application initialized"),O(v,!0),await m()}catch(i){a(`Failed to initialize: ${i.message}`),console.error("Failed to initialize app:",i)}}),Ie(()=>{d?.destroy(!0,{children:!0})}),ne();var c=Ve(),y=D(c);Me(y,i=>O(e,i),()=>T(e));var p=I(y,2),w=I(D(p),2),t=I(D(w),2),_=D(t,!0);$(t),$(w);var l=I(w,2),r=I(D(l),2);He(r,3,()=>T(u),i=>i,(i,n)=>{var s=Xe(),g=D(s,!0);$(s),J(h=>{Z(s,`margin:2px 0; color: ${h??""};`),Q(g,T(n))},[()=>T(n).includes("ERROR")?"#f44336":T(n).includes("SUCCESS")?"#4CAF50":"#ccc"]),H(i,s)});var x=I(r,2);{var S=i=>{var n=Pe();H(i,n)};Le(x,i=>{T(u).length===0&&i(S)})}$(l),Fe(2),$(p),$(c),J(()=>{Z(t,`color: ${T(v)?"#4CAF50":"#f44336"};`),Q(_,T(v)?"Ready":"Loading...")}),H(f,c),$e()}export{je as component};
